---
title: "PQ"
author: "Ali Arabat"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library("scales")
library(ggplot2)
```

```{r}
DATASET_URL = "/Users/aliarabat/Documents/PhD/projects/openstack-evolution/"
dataset <- read.csv(paste(DATASET_URL, "dataset_desc.csv", sep=""))
developers <- read.csv(paste(DATASET_URL, "developers.csv", sep=""))
```

```{r}
plot_single_boxplot<-function(data, x, y, x_lab, y_lab, breaks, labels=NULL){
  p <- data %>%
    ggplot(aes_string(x = factor(0), y = y))
  if(is.null(breaks)==FALSE) {
    p<-p+scale_y_continuous(trans = "log1p", breaks=breaks)
  } else {
    p<-p+
      scale_y_continuous(labels=c('0%', '25%', '50%', '75%', '100%'))
  }
  p<-p+
    geom_boxplot(fatten=0.5) + 
    theme_linedraw() +
    theme(
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank(),
      panel.background = element_blank(),
      legend.position = "top",
      axis.line = element_line(colour = "black"),
      axis.text = element_text(size = 9, color = "grey30"),
      axis.title = element_text(size = 10)
    )+
    labs(x = "", y = y_lab) +
    scale_x_discrete(breaks = NULL)
  
  return(p)
}
```


```{r}
p1<-plot_single_boxplot(
      dataset, 
      x = factor(0), 
      y = "Contributors", 
      x_lab = "", 
      y_lab = "# of contributors", 
      breaks = c(0,1,10, 100, 1000, 10000)
    )
p1
```


```{r}
p2<-plot_single_boxplot(
      dataset, 
      x = factor(0), 
      y = "Changes", 
      x_lab = "", 
      y_lab = "# of changes", 
      breaks = c(0,1,10, 100, 1000, 10000)
    )
p2
```


```{r}

p3<-plot_single_boxplot(
      dataset, 
      x = factor(0), 
      y = "Age", 
      x_lab = "", 
      y_lab = "# of days", 
      breaks = c(0,1,10, 100, 1000, 10000)
)
p3

```

## Plot the distribution of developers
```{r}
# Reshape data using tidyr::gather
data_long <- gather(developers[, c("id", "age")], key = "Variable", value = "Value", -id)

# Create a boxplot using ggplot2
p3<-ggplot(data_long, aes(x = Variable, y = Value), outlier.shape = NA) +
  geom_boxplot(fatten=.2)+
  scale_y_continuous(trans = "log1p", breaks = c(0,1,10, 100, 1000))+
  theme_linedraw() +
  theme(
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.background = element_blank(),
    legend.position = "none",
    axis.line = element_line(colour = "black"),
    axis.text = element_text(size = 9, color = "grey30"),
    axis.title = element_text(size = 10)
  )+
  labs(title = "", x = "", y = "# of changes")
p3
````