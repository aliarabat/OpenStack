id,project,branch,topic,change_id,subject,status,created,updated,submitted,insertions,deletions,total_comment_count,number,current_revision,discussion_messages_count,reviewers_count,revisions_count,files_count,owner_account_id,owner_name,owner_username,commit_message
openstack%2Fopenstack-ansible-os_glance~master~Id06e939f25299d48f4054eec927505ed2ecdb554,openstack/openstack-ansible-os_glance,master,bug/1742718,Id06e939f25299d48f4054eec927505ed2ecdb554,Skip logging for haproxy health checks,MERGED,2018-02-23 14:39:49.000000000,2018-02-25 21:05:03.000000000,2018-02-25 09:06:13.000000000,3,0,0,547443,1302539f1154b2e04e63272bc38dd60f5970b289,8,3,1,1,538,Major Hayden,rackerhacker,"Skip logging for haproxy health checks

The health check requests from haproxy cause uwsgi to write a
lot of useless log lines. This can make it more difficult to find
a problem with a particular service.

This patch adds a route to look for the `osa-haproxy-healthcheck`
user agent string, which haproxy uses when performing health checks.
Any requests with that user agent are not logged.

Closes-Bug: 1742718
Change-Id: Id06e939f25299d48f4054eec927505ed2ecdb554
"
openstack%2Fopenstack-ansible-os_heat~master~I8b1bcd58fc0bea95ee0103901eb8f83b480b50ef,openstack/openstack-ansible-os_heat,master,bug/1742718,I8b1bcd58fc0bea95ee0103901eb8f83b480b50ef,Skip logging for haproxy health checks,MERGED,2018-02-23 14:42:54.000000000,2018-02-25 21:04:55.000000000,2018-02-25 09:09:44.000000000,3,0,0,547446,7500845aa81273ccba3c76e859ef91eb14065c1f,10,5,1,1,538,Major Hayden,rackerhacker,"Skip logging for haproxy health checks

The health check requests from haproxy cause uwsgi to write a
lot of useless log lines. This can make it more difficult to find
a problem with a particular service.

This patch adds a route to look for the `osa-haproxy-healthcheck`
user agent string, which haproxy uses when performing health checks.
Any requests with that user agent are not logged.

Closes-Bug: 1742718
Change-Id: I8b1bcd58fc0bea95ee0103901eb8f83b480b50ef
"
openstack%2Fopenstack-ansible-os_cinder~master~I1a452a627aaa49adc23aa9a7e30a9d27bddac2fb,openstack/openstack-ansible-os_cinder,master,bug/1742718,I1a452a627aaa49adc23aa9a7e30a9d27bddac2fb,Skip logging for haproxy health checks,MERGED,2018-02-23 14:40:30.000000000,2018-02-25 21:04:49.000000000,2018-02-25 09:16:41.000000000,3,0,0,547444,fb5c7c1fe1364997dc801cba5d5ada929c6974c1,8,3,1,1,538,Major Hayden,rackerhacker,"Skip logging for haproxy health checks

The health check requests from haproxy cause uwsgi to write a
lot of useless log lines. This can make it more difficult to find
a problem with a particular service.

This patch adds a route to look for the `osa-haproxy-healthcheck`
user agent string, which haproxy uses when performing health checks.
Any requests with that user agent are not logged.

Closes-Bug: 1742718
Change-Id: I1a452a627aaa49adc23aa9a7e30a9d27bddac2fb
"
openstack%2Fopenstack-ansible-os_ironic~master~I2a1786e2197fbb0fa77e78b94e0c5ff7f4afc8fb,openstack/openstack-ansible-os_ironic,master,bug/1742718,I2a1786e2197fbb0fa77e78b94e0c5ff7f4afc8fb,Skip logging for haproxy health checks,MERGED,2018-02-23 14:45:41.000000000,2018-02-25 21:04:40.000000000,2018-02-25 09:17:20.000000000,3,0,0,547465,e5e0aa48e3dc5c3009df2e445efa16b2936b9685,8,3,1,1,538,Major Hayden,rackerhacker,"Skip logging for haproxy health checks

The health check requests from haproxy cause uwsgi to write a
lot of useless log lines. This can make it more difficult to find
a problem with a particular service.

This patch adds a route to look for the `osa-haproxy-healthcheck`
user agent string, which haproxy uses when performing health checks.
Any requests with that user agent are not logged.

Closes-Bug: 1742718
Change-Id: I2a1786e2197fbb0fa77e78b94e0c5ff7f4afc8fb
"
openstack%2Fopenstack-ansible-os_keystone~master~Ia163d1686274bd3b80a046a945fb7d7ceb5f721c,openstack/openstack-ansible-os_keystone,master,bug/1742718,Ia163d1686274bd3b80a046a945fb7d7ceb5f721c,Skip logging for haproxy health checks,MERGED,2018-02-23 14:38:59.000000000,2018-02-25 21:04:32.000000000,2018-02-25 09:18:27.000000000,3,0,0,547442,943b5c560b6b9618c35ad5a80b43f781abcc5750,8,3,1,1,538,Major Hayden,rackerhacker,"Skip logging for haproxy health checks

The health check requests from haproxy cause uwsgi to write a
lot of useless log lines. This can make it more difficult to find
a problem with a particular service.

This patch adds a route to look for the `osa-haproxy-healthcheck`
user agent string, which haproxy uses when performing health checks.
Any requests with that user agent are not logged.

Closes-Bug: 1742718
Change-Id: Ia163d1686274bd3b80a046a945fb7d7ceb5f721c
"
openstack%2Fopenstack-ansible-os_octavia~master~I9b0239a9a24861734badbe874dc3e1139d7100c6,openstack/openstack-ansible-os_octavia,master,bug/1742718,I9b0239a9a24861734badbe874dc3e1139d7100c6,Skip logging for haproxy health checks,MERGED,2018-02-23 14:44:50.000000000,2018-02-25 21:04:24.000000000,2018-02-25 09:28:52.000000000,3,0,0,547449,e4d5cd0da7c535e7b235c5e9ab4899efb2a5c8e6,8,3,1,1,538,Major Hayden,rackerhacker,"Skip logging for haproxy health checks

The health check requests from haproxy cause uwsgi to write a
lot of useless log lines. This can make it more difficult to find
a problem with a particular service.

This patch adds a route to look for the `osa-haproxy-healthcheck`
user agent string, which haproxy uses when performing health checks.
Any requests with that user agent are not logged.

Closes-Bug: 1742718
Change-Id: I9b0239a9a24861734badbe874dc3e1139d7100c6
"
openstack%2Fopenstack-ansible-os_nova~master~I960bf62cfcd1bcbcec4923f04eb7566081b1bec1,openstack/openstack-ansible-os_nova,master,bug/1742718,I960bf62cfcd1bcbcec4923f04eb7566081b1bec1,Skip logging for haproxy health checks,MERGED,2018-02-23 14:35:49.000000000,2018-02-25 21:04:15.000000000,2018-02-25 09:34:25.000000000,3,0,0,547440,145b98f3298028187f0e151872dcd7d0e54f1353,8,3,1,1,538,Major Hayden,rackerhacker,"Skip logging for haproxy health checks

The health check requests from haproxy cause uwsgi to write a
lot of useless log lines. This can make it more difficult to find
a problem with a particular service.

This patch adds a route to look for the `osa-haproxy-healthcheck`
user agent string, which haproxy uses when performing health checks.
Any requests with that user agent are not logged.

Closes-Bug: 1742718
Change-Id: I960bf62cfcd1bcbcec4923f04eb7566081b1bec1
"
openstack%2Foslo.concurrency~stable%2Fqueens~I2ce344330905eef437ef3f89a2a01169a30df8ab,openstack/oslo.concurrency,stable/queens,bug/1482382-stable/queens,I2ce344330905eef437ef3f89a2a01169a30df8ab,Mask passwords only when command execution fails,MERGED,2018-02-23 11:40:40.000000000,2018-02-25 20:42:05.000000000,2018-02-25 20:42:05.000000000,47,3,0,547388,0c4718fcb77e9f4e3a22ae458869b7294b7bc91f,7,4,1,2,24005,prashkre,prashkre,"Mask passwords only when command execution fails

At many places, processutils.ssh_execute() is being invoked to run
a command over ssh and output returned is parsed to get appropriate
information. In this flow, unsanitized output is being expected
where processutils.ssh_execute() was invoked but found that
output like volume details(containing ""password"" string in its name)
is being masked away with strutils.mask_password(stdout) even though
no error occured during command execution.

This is regression issue from patch[0]. In this fix, stdout and stderr
in processutils.ssh_execute() will be masked only when
ProcessExecutionError exception is thrown i.e. command execution failed
due to some reasons.

[0] https://github.com/openstack/oslo.concurrency/commit/
ae9e05bfc3d7ec867bd6ec78c301f11c2bdd0d5f

Change-Id: I2ce344330905eef437ef3f89a2a01169a30df8ab
Closes-Bug: #1482382
(cherry picked from commit 21ae27e66d77f276c23a7ca2eaa8869438fb4d31)
"
openstack%2Foslo.context~stable%2Fqueens~Ia2cbc83662bf5f6502ca51d6ef9f299fe125932b,openstack/oslo.context,stable/queens,openstack/requirements,Ia2cbc83662bf5f6502ca51d6ef9f299fe125932b,Updated from global requirements,MERGED,2018-02-13 01:57:58.000000000,2018-02-25 20:25:39.000000000,2018-02-25 20:25:38.000000000,3,3,0,543711,41c0bb8fe06f791b9280446e69112b85eae0cb04,6,2,1,2,11131,OpenStack Proposal Bot,proposal-bot,"Updated from global requirements

Change-Id: Ia2cbc83662bf5f6502ca51d6ef9f299fe125932b
"
openstack%2Fopenstack-helm~master~I40b0c0a0be8a32340d992dc690a76980a129ca90,openstack/openstack-helm,master,ceph/remove-unrequired-keys,I40b0c0a0be8a32340d992dc690a76980a129ca90,OSD: remove redundant DMCRYPT setup,MERGED,2018-02-25 01:14:31.000000000,2018-02-25 19:44:25.000000000,2018-02-25 19:44:25.000000000,2,27,0,547792,84db0873d39d508f78af63f3b82f05d6d7162fe8,7,3,1,2,23928,Pete Birley,portdirect,"OSD: remove redundant DMCRYPT setup

This PS removes the redundant dmcrypt setup from the OSD scripts.

Change-Id: I40b0c0a0be8a32340d992dc690a76980a129ca90
"
openstack%2Fopenstack-helm~master~If224796a4579cde195954ab806c20be7a1974ecd,openstack/openstack-helm,master,ceph/remove-unrequired-keys,If224796a4579cde195954ab806c20be7a1974ecd,Ceph: remove unrequired keyrings from pods,MERGED,2018-02-25 01:06:26.000000000,2018-02-25 19:41:17.000000000,2018-02-25 19:41:17.000000000,0,117,0,547791,1cfb0308b95eb1936b290a65fe4079fad1abce35,7,3,1,5,23928,Pete Birley,portdirect,"Ceph: remove unrequired keyrings from pods

This PS removes unrequired keyrings from being mounted into ceph
pods.

Change-Id: If224796a4579cde195954ab806c20be7a1974ecd
"
openstack%2Fautomaton~stable%2Fqueens~I97ab1049a2de21c8b64d731f0ca2b01895da50cb,openstack/automaton,stable/queens,openstack/requirements,I97ab1049a2de21c8b64d731f0ca2b01895da50cb,Updated from global requirements,MERGED,2018-02-13 01:48:07.000000000,2018-02-25 19:40:48.000000000,2018-02-25 19:40:48.000000000,3,3,0,543674,4e25c5c240f166264f24d15f387ecf4052867b3d,7,3,1,1,11131,OpenStack Proposal Bot,proposal-bot,"Updated from global requirements

Change-Id: I97ab1049a2de21c8b64d731f0ca2b01895da50cb
"
openstack%2Fopenstack-ansible~master~I62aec92df9d40ef7e9c942c91e00055f9c8f0b08,openstack/openstack-ansible,master,,I62aec92df9d40ef7e9c942c91e00055f9c8f0b08,Switch to using the imported nspawn roles,MERGED,2018-02-23 18:06:25.000000000,2018-02-25 19:35:15.000000000,2018-02-25 19:35:15.000000000,2,4,1,547554,620ae776166235101f4c3fbe737270eaa0f1126b,15,5,3,1,6816,Jesse Pretorius,jesse-pretorius,"Switch to using the imported nspawn roles

We've now imported the roles into the OpenStack
namespace, so let's use them from there.

Change-Id: I62aec92df9d40ef7e9c942c91e00055f9c8f0b08
"
openstack%2Fopenstack-ansible~stable%2Focata~I1dcbbf5bc8cc66f11dd8ddc22d2a177c5c0f31f1,openstack/openstack-ansible,stable/ocata,,I1dcbbf5bc8cc66f11dd8ddc22d2a177c5c0f31f1,"Remove the ""max_fail_percentage"" option",MERGED,2018-02-24 17:34:48.000000000,2018-02-25 19:35:14.000000000,2018-02-25 19:35:14.000000000,21,37,0,547774,c1d7a717a7de39c3609ddb1e95976a9229451dae,10,4,2,28,7353,Kevin Carter,cloudnull,"Remove the ""max_fail_percentage"" option

This option can cause silent failures which are confusing and hard to
track down. While the intention of this was to allow large scale
deployments to succeed in cases where a single node fails due to
transiant issues it has produced more problems in terms of confusion
that it solves. This change removes the option from all production
playbooks.

Change-Id: I1dcbbf5bc8cc66f11dd8ddc22d2a177c5c0f31f1
Signed-off-by: Kevin Carter <kevin.carter@rackspace.com>
(cherry picked from commit c2743f5cca1930a553ce9f20b207cb17fa6b763d)
Signed-off-by: Kevin Carter <kevin.carter@rackspace.com>
"
openstack%2Fopenstack-ansible~stable%2Fpike~I1dcbbf5bc8cc66f11dd8ddc22d2a177c5c0f31f1,openstack/openstack-ansible,stable/pike,,I1dcbbf5bc8cc66f11dd8ddc22d2a177c5c0f31f1,"Remove the ""max_fail_percentage"" option",MERGED,2018-02-24 17:30:10.000000000,2018-02-25 19:35:13.000000000,2018-02-25 19:35:13.000000000,21,37,0,547773,2cffc500a593b1163cf55f4965dc67f4829d22cc,11,4,2,29,7353,Kevin Carter,cloudnull,"Remove the ""max_fail_percentage"" option

This option can cause silent failures which are confusing and hard to
track down. While the intention of this was to allow large scale
deployments to succeed in cases where a single node fails due to
transiant issues it has produced more problems in terms of confusion
that it solves. This change removes the option from all production
playbooks.

Change-Id: I1dcbbf5bc8cc66f11dd8ddc22d2a177c5c0f31f1
Signed-off-by: Kevin Carter <kevin.carter@rackspace.com>
(cherry picked from commit c2743f5cca1930a553ce9f20b207cb17fa6b763d)
Signed-off-by: Kevin Carter <kevin.carter@rackspace.com>
"
openstack%2Fdebtcollector~stable%2Fqueens~Idfb8e565a874b081de4cc0e0817791dc34f70dce,openstack/debtcollector,stable/queens,openstack/requirements,Idfb8e565a874b081de4cc0e0817791dc34f70dce,Updated from global requirements,MERGED,2018-02-13 01:49:10.000000000,2018-02-25 19:34:43.000000000,2018-02-25 19:34:43.000000000,2,2,0,543678,4e97d4b550bd35ca36f88206f9ea15854af7bb8b,6,2,1,1,11131,OpenStack Proposal Bot,proposal-bot,"Updated from global requirements

Change-Id: Idfb8e565a874b081de4cc0e0817791dc34f70dce
"
openstack%2Ftaskflow~stable%2Fpike~I7abf4ded7a23464d25f66a468798aeedc3da6028,openstack/taskflow,stable/pike,openstack/requirements,I7abf4ded7a23464d25f66a468798aeedc3da6028,Updated from global requirements,MERGED,2018-02-14 18:47:00.000000000,2018-02-25 19:34:33.000000000,2018-02-25 19:34:32.000000000,1,1,0,544599,64f98d2f0242e2b9cf31c11b1206e09555d544d0,6,2,1,1,11131,OpenStack Proposal Bot,proposal-bot,"Updated from global requirements

Change-Id: I7abf4ded7a23464d25f66a468798aeedc3da6028
"
openstack%2Foslo.middleware~stable%2Fqueens~I8270741f0924846c4ad9179772b3f935dd01260b,openstack/oslo.middleware,stable/queens,openstack/requirements,I8270741f0924846c4ad9179772b3f935dd01260b,Updated from global requirements,MERGED,2018-02-13 01:58:19.000000000,2018-02-25 19:31:58.000000000,2018-02-25 19:31:58.000000000,3,3,0,543716,cb99e7267e3273bb7827ac3d32ef411582a7aac6,6,2,1,1,11131,OpenStack Proposal Bot,proposal-bot,"Updated from global requirements

Change-Id: I8270741f0924846c4ad9179772b3f935dd01260b
"
openstack%2Foslo.utils~stable%2Fqueens~I6d24e2d5e411d631eae955cb63391cde6eeb6538,openstack/oslo.utils,stable/queens,openstack/requirements,I6d24e2d5e411d631eae955cb63391cde6eeb6538,Updated from global requirements,MERGED,2018-02-13 01:58:46.000000000,2018-02-25 19:30:29.000000000,2018-02-25 19:30:28.000000000,3,3,0,543723,a39be007ec9975f441bba6702da596633c044a46,6,2,1,2,11131,OpenStack Proposal Bot,proposal-bot,"Updated from global requirements

Change-Id: I6d24e2d5e411d631eae955cb63391cde6eeb6538
"
openstack%2Freno~master~I9be5017c8bcdc601608ce0fc9a2fe83d3575042e,openstack/reno,master,,I9be5017c8bcdc601608ce0fc9a2fe83d3575042e,Update url in HACKING.rst,MERGED,2018-02-25 17:46:37.000000000,2018-02-25 19:29:56.000000000,2018-02-25 19:29:56.000000000,1,1,0,547849,6f0ce883269e587143590e030e9e263568ea1540,6,2,1,1,17130,melissaml,malei,"Update url in HACKING.rst

Change-Id: I9be5017c8bcdc601608ce0fc9a2fe83d3575042e
"
openstack%2Foslo.log~stable%2Fqueens~Ifaf37f2131e5486e5b7a1112448256b922337c53,openstack/oslo.log,stable/queens,openstack/requirements,Ifaf37f2131e5486e5b7a1112448256b922337c53,Updated from global requirements,MERGED,2018-02-13 01:58:09.000000000,2018-02-25 19:28:51.000000000,2018-02-25 19:28:51.000000000,3,3,0,543714,2721107b69e269ffafdf53e0382fb065b94eb9e7,6,2,1,1,11131,OpenStack Proposal Bot,proposal-bot,"Updated from global requirements

Change-Id: Ifaf37f2131e5486e5b7a1112448256b922337c53
"
openstack%2Foslo.messaging~master~Ia1be1b67a7151d449185e2ad52eff1787e8b0933,openstack/oslo.messaging,master,kafka-update,Ia1be1b67a7151d449185e2ad52eff1787e8b0933,Add kafka config options for security (ssl/sasl),MERGED,2018-01-29 20:37:46.000000000,2018-02-25 19:12:12.000000000,2018-02-25 19:12:12.000000000,82,16,8,539017,90f7610f9d7f4f2b11f0b7d96bef13a440f28b84,25,5,3,3,20523,Andy Smith,ajssmith,"Add kafka config options for security (ssl/sasl)

Change-Id: Ia1be1b67a7151d449185e2ad52eff1787e8b0933
"
openstack%2Fopenstack-ansible~stable%2Fnewton~I1dcbbf5bc8cc66f11dd8ddc22d2a177c5c0f31f1,openstack/openstack-ansible,stable/newton,,I1dcbbf5bc8cc66f11dd8ddc22d2a177c5c0f31f1,"Remove the ""max_fail_percentage"" option",MERGED,2018-02-24 17:36:40.000000000,2018-02-25 19:08:26.000000000,2018-02-25 19:08:26.000000000,21,33,0,547775,0d80b61c43cbf745a8745283842de1e9bec30f21,11,4,2,26,7353,Kevin Carter,cloudnull,"Remove the ""max_fail_percentage"" option

This option can cause silent failures which are confusing and hard to
track down. While the intention of this was to allow large scale
deployments to succeed in cases where a single node fails due to
transiant issues it has produced more problems in terms of confusion
that it solves. This change removes the option from all production
playbooks.

Change-Id: I1dcbbf5bc8cc66f11dd8ddc22d2a177c5c0f31f1
Signed-off-by: Kevin Carter <kevin.carter@rackspace.com>
(cherry picked from commit c2743f5cca1930a553ce9f20b207cb17fa6b763d)
(cherry picked from commit 0afeca7f885c2d8002cafa0ae4a64af1c3680570)
Signed-off-by: Kevin Carter <kevin.carter@rackspace.com>
"
openstack%2Foctavia~master~I692244236537ac52a1bcfcc278c566c7dc2eec45,openstack/octavia,master,openstack/requirements,I692244236537ac52a1bcfcc278c566c7dc2eec45,Updated from global requirements,MERGED,2018-02-14 09:15:13.000000000,2018-02-25 18:58:21.000000000,2018-02-25 18:58:21.000000000,3,3,0,544217,06f1dcd286e3f8fed8fed9d480d9bfb5ec04b275,13,4,3,2,11131,OpenStack Proposal Bot,proposal-bot,"Updated from global requirements

Change-Id: I692244236537ac52a1bcfcc278c566c7dc2eec45
"
openstack%2Fneutron-lbaas~master~Ic544b2ef4286422efac096b902255d16760c1502,openstack/neutron-lbaas,master,openstack/requirements,Ic544b2ef4286422efac096b902255d16760c1502,Updated from global requirements,MERGED,2018-02-17 09:49:21.000000000,2018-02-25 18:53:40.000000000,2018-02-25 18:53:40.000000000,1,1,0,545547,29c319295f5a7cd082f667fcc71b78052e07a6d4,8,4,1,1,11131,OpenStack Proposal Bot,proposal-bot,"Updated from global requirements

Change-Id: Ic544b2ef4286422efac096b902255d16760c1502
"
openstack%2Fcastellan~master~Ib249a72359cffff7cca89460feb2dd1469363c17,openstack/castellan,master,openstack/requirements,Ib249a72359cffff7cca89460feb2dd1469363c17,Updated from global requirements,MERGED,2018-02-17 09:22:06.000000000,2018-02-25 18:40:20.000000000,2018-02-25 18:40:20.000000000,1,1,0,545530,81d3c2d8c0371bca3a05e282ba65f2109a237248,6,2,1,1,11131,OpenStack Proposal Bot,proposal-bot,"Updated from global requirements

Change-Id: Ib249a72359cffff7cca89460feb2dd1469363c17
"
openstack%2Fsenlin~stable%2Fqueens~I10177b76a672b4a0b1406eb830358cb66b3cf0ca,openstack/senlin,stable/queens,scaling_policy_version-stable/queens,I10177b76a672b4a0b1406eb830358cb66b3cf0ca,Add scaling policy version support message,MERGED,2018-02-24 02:16:53.000000000,2018-02-25 18:29:52.000000000,2018-02-25 18:29:52.000000000,5,0,0,547697,6792221968bc81033d9c0dc38085368cd941f29d,11,3,1,1,23517,chenyb4,Yuanbin.Chen,"Add scaling policy version support message

If scaling policy version support miss, policy type
list not display scaling policy type.

Change-Id: I10177b76a672b4a0b1406eb830358cb66b3cf0ca
Signed-off-by: Yuanbin.Chen <cybing4@gmail.com>
(cherry picked from commit da1d380b37a7d20b1af6d01b833b5d351e6e0ae9)
"
openstack%2Foctavia-dashboard~master~If08560c1eb7007c908ad4f0ead0027571c5fa6da,openstack/octavia-dashboard,master,openstack/requirements,If08560c1eb7007c908ad4f0ead0027571c5fa6da,Updated from global requirements,MERGED,2018-02-14 09:15:21.000000000,2018-02-25 18:03:38.000000000,2018-02-25 18:03:38.000000000,1,1,0,544218,760f36566c03a88bfb959c10560ac88f69f482bd,7,3,1,1,11131,OpenStack Proposal Bot,proposal-bot,"Updated from global requirements

Change-Id: If08560c1eb7007c908ad4f0ead0027571c5fa6da
"
openstack%2Foctavia-dashboard~master~I4fc2a3e65102021341a419851b8f1d3a9fdade3e,openstack/octavia-dashboard,master,zanata/translations,I4fc2a3e65102021341a419851b8f1d3a9fdade3e,Imported Translations from Zanata,MERGED,2018-02-18 06:10:12.000000000,2018-02-25 18:02:19.000000000,2018-02-25 18:02:19.000000000,7,4,0,545651,a48fb9d7aaf25cc82bb2559fac96e2d5fac32906,8,3,1,1,11131,OpenStack Proposal Bot,proposal-bot,"Imported Translations from Zanata

For more information about this automatic import see:
https://docs.openstack.org/i18n/latest/reviewing-translation-import.html

Change-Id: I4fc2a3e65102021341a419851b8f1d3a9fdade3e
"
openstack%2Fopenstack-ansible-pip_install~master~Idf726729e725d94b70b53dc40da1ec7e7b0a00bf,openstack/openstack-ansible-pip_install,master,bp/python-build-install-simplification,Idf726729e725d94b70b53dc40da1ec7e7b0a00bf,Remove the implementation of constraints in pip.conf,MERGED,2018-02-24 15:46:10.000000000,2018-02-25 17:52:36.000000000,2018-02-25 17:52:36.000000000,0,9,4,547762,1085f00f16eec1323b4bb19f7bccffd945f4c3da,11,4,1,1,6816,Jesse Pretorius,jesse-pretorius,"Remove the implementation of constraints in pip.conf

In https://review.openstack.org/526889 constraints were
added to pip.conf. While this may be something we want
later in the python build simplification process, it is
currently causing problems in several tests due to the
assumption that constraints are only set on the CLI.

At this stage I think it's better to leave constraints
setting to be done on the CLI as that is ubiquitous
across all pip install tasks right now.

If we switch to setting constraints in pip.conf then it
will take more co-ordination.

Implements: blueprint python-build-install-simplification
Signed-off-by: Jesse Pretorius <jesse.pretorius@rackspace.co.uk>
Change-Id: Idf726729e725d94b70b53dc40da1ec7e7b0a00bf
"
openstack%2Fopenstack-ansible-pip_install~stable%2Fqueens~If472c845036ab904ffc15ca7201ae68d282c1be0,openstack/openstack-ansible-pip_install,stable/queens,bp/python-build-install-simplification-stable/queens,If472c845036ab904ffc15ca7201ae68d282c1be0,Remove pip_lock_to_internal_repo variable,MERGED,2018-02-24 16:40:37.000000000,2018-02-25 17:52:35.000000000,2018-02-25 17:52:35.000000000,2,33,0,547766,071b232074f61b8be91009f835a1e35061ded36a,7,3,1,3,6816,Jesse Pretorius,jesse-pretorius,"Remove pip_lock_to_internal_repo variable

The ability to lock the pip configuration down has
now been extended so that it is possible to implement
a different index and to use find-links to achieve the
same goal.

The only replacement implementation could be to disable
the setting of an index if one wanted to *only* use
wheels, but that is unnecessary in OSA builds as we are
able to set the build to only use a specific set of
wheels through the pypiserver on the repo container.

As such, this variable has become useless and unused.
This patch therefore removes it.

Change-Id: If472c845036ab904ffc15ca7201ae68d282c1be0
Implements: blueprint python-build-install-simplification
Signed-off-by: Jesse Pretorius <jesse.pretorius@rackspace.co.uk>
(cherry picked from commit f9d65b184f6a4ca418d77397b583e5072b6f8641)
"
openstack%2Fdesignate~master~I2d6ec85e0c47b2e129bc55616ad92f53a2298940,openstack/designate,master,OVO,I2d6ec85e0c47b2e129bc55616ad92f53a2298940,Migrate object to OVO (3),MERGED,2017-06-06 09:19:50.000000000,2018-02-25 17:45:49.000000000,2018-02-25 17:45:48.000000000,94,118,0,471280,aac3812c1a292e4155d9c4ba604761495f7965c0,68,10,22,5,19930,Dai Dang Van,daidv,"Migrate object to OVO (3)

This commit will migrate:
- Server and ServerList
- ServiceStatus and ServiceStatusList
- Tenant and TenantList
- Tld and TldList
- TsigKey and TsigKeyList

Co-authored-By: Nguyen Van Trung <trungnv@vn.fujitsu.com>

Change-Id: I2d6ec85e0c47b2e129bc55616ad92f53a2298940
Implements: blueprint designate-rolling-upgrade
"
openstack%2Fdesignate~master~I80173ce20b5ef45f0bbbc2c5552b67e1aaec0c06,openstack/designate,master,OVO,I80173ce20b5ef45f0bbbc2c5552b67e1aaec0c06,Migrate object to OVO (2),MERGED,2017-06-05 09:07:04.000000000,2018-02-25 17:45:45.000000000,2018-02-25 17:45:44.000000000,76,165,0,470890,e9ebf92fbe8b436a57746af0f310803f4294e7e4,77,10,26,5,19930,Dai Dang Van,daidv,"Migrate object to OVO (2)

This commit will migrate:
- ZoneImport and ZoneImportList
- ZoneExport and ZoneExportList
- ZoneTransferAccept and ZoneTransferAcceptList
- ZoneTransferRequest and ZoneTransferRequestList

Co-authored-By: Nguyen Van Trung <trungnv@vn.fujitsu.com>

Change-Id: I80173ce20b5ef45f0bbbc2c5552b67e1aaec0c06
Implements: blueprint designate-rolling-upgrade
"
openstack%2Fdesignate~master~I8a0b0868d25dacd3dabeb7e0436cfcf93b1e4cc7,openstack/designate,master,OVO,I8a0b0868d25dacd3dabeb7e0436cfcf93b1e4cc7,Migrate object to OVO,MERGED,2017-05-16 08:31:19.000000000,2018-02-25 17:45:35.000000000,2018-02-25 17:45:35.000000000,1135,657,44,464971,0eb9627cb0478cc60a20127270b83f3b4451390a,171,14,44,28,19930,Dai Dang Van,daidv,"Migrate object to OVO

This commit will migrate Zone and ZoneMaster objects

Co-authored-By: Hieu LE <hieulq@vn.fujitsu.com>
Co-authored-By: Nguyen Van Trung <trungnv@vn.fujitsu.com>

Change-Id: I8a0b0868d25dacd3dabeb7e0436cfcf93b1e4cc7
Implements: blueprint designate-rolling-upgrade
"
openstack%2Fsenlin~stable%2Fqueens~I72e02695f3eb10d1a00976bf68727e0dfb360167,openstack/senlin,stable/queens,bug/1751242-stable/queens,I72e02695f3eb10d1a00976bf68727e0dfb360167,Get image id from multiple places,MERGED,2018-02-25 15:51:50.000000000,2018-02-25 17:40:59.000000000,2018-02-25 17:40:59.000000000,32,1,0,547831,38f22bc385f082544db99d9ad053ceff98542a39,6,3,1,1,8246,Qiming Teng,tengqm,"Get image id from multiple places

The nova server was not saved image id in 'image' attribute if it was
boot from image(create new volume), then we need to find a volume which
is bootable and use its image_id for the server.

Closes-bug: #1751242

Change-Id: I72e02695f3eb10d1a00976bf68727e0dfb360167
Signed-off-by: blkart <blkart.org@gmail.com>
"
openstack%2Fpython-octaviaclient~master~I99cf0a244c30f67d7b4274d28c24793d468e1782,openstack/python-octaviaclient,master,openstack/requirements,I99cf0a244c30f67d7b4274d28c24793d468e1782,Updated from global requirements,MERGED,2018-02-14 12:30:09.000000000,2018-02-25 17:35:42.000000000,2018-02-25 17:35:42.000000000,2,2,0,544283,31b9234120c79a48ed77758dc923fc78ba849577,9,3,2,1,11131,OpenStack Proposal Bot,proposal-bot,"Updated from global requirements

Change-Id: I99cf0a244c30f67d7b4274d28c24793d468e1782
"
openstack%2Foctavia-dashboard~master~I7121c40543dba4d5b6aafe6b1b150b8a385ee3e7,openstack/octavia-dashboard,master,,I7121c40543dba4d5b6aafe6b1b150b8a385ee3e7,Modify the '.gitignore' file,MERGED,2018-02-09 03:02:14.000000000,2018-02-25 17:32:56.000000000,2018-02-25 17:32:56.000000000,0,1,1,542554,e531b937a9acb496772c2dcb2f9e7de617088cd4,10,4,1,1,14151,ziyu032,ziyu032,"Modify the '.gitignore' file

Since the horizon remove the 'run_tests.sh' file,
so there should remove '.venv' from the '.gitignore' file.
See the patch 'https://review.openstack.org/#/c/399842/'

Change-Id: I7121c40543dba4d5b6aafe6b1b150b8a385ee3e7
"
openstack%2Fnova~master~I4db0c8a5c55f7fcdebd5fcb04273d922727a4521,openstack/nova,master,functional_tests_traits,I4db0c8a5c55f7fcdebd5fcb04273d922727a4521,[placement] Add functional tests for traits API,MERGED,2017-11-30 08:32:48.000000000,2018-02-25 16:56:50.000000000,2018-02-24 03:43:58.000000000,81,1,5,524094,c23f135b117a4ac21e23aba228a399315c5f5942,134,18,17,1,7634,Takashi Natsume,natsumet,"[placement] Add functional tests for traits API

Add functional tests for traits API in the following cases.

* Invalid 'resource_provider_generation' in
  PUT /resource_providers/{uuid}/traits
* Invalid 'traits' in
  PUT /resource_providers/{uuid}/traits
* Additional properties in
  PUT /resource_providers/{uuid}/traits
* Earlier microverion (1.5)

Fix a response string to check in the following test.

* Missing 'resource_provider_generation' in
  PUT /resource_providers/{uuid}/traits

Change-Id: I4db0c8a5c55f7fcdebd5fcb04273d922727a4521
"
openstack%2Fsenlin~master~If93ba5f05103498972c8e8b3e8c2301a543f1c8d,openstack/senlin,master,update_doc,If93ba5f05103498972c8e8b3e8c2301a543f1c8d,Update senlin documentation url,MERGED,2018-02-23 08:52:48.000000000,2018-02-25 16:56:00.000000000,2018-02-25 16:55:59.000000000,5,5,0,547324,f45cad94a2cd7010ff4f3ee5304b3ff16a1e23d9,9,5,1,5,21690,chenpengzi,chenpengzi,"Update senlin documentation url

Change-Id: If93ba5f05103498972c8e8b3e8c2301a543f1c8d
"
openstack%2Fsenlin~master~I72e02695f3eb10d1a00976bf68727e0dfb360167,openstack/senlin,master,bug/1751242,I72e02695f3eb10d1a00976bf68727e0dfb360167,Get image id from multiple places,MERGED,2018-02-23 10:34:50.000000000,2018-02-25 16:55:58.000000000,2018-02-25 16:55:58.000000000,32,1,1,547364,6d99c130be820091d7586c607b6fc98fd7b9a1d4,19,6,3,1,17656,blkart,blkart,"Get image id from multiple places

The nova server was not saved image id in 'image' attribute if it was
boot from image(create new volume), then we need to find a volume which
is bootable and use its image_id for the server.

Closes-bug: #1751242

Change-Id: I72e02695f3eb10d1a00976bf68727e0dfb360167
Signed-off-by: blkart <blkart.org@gmail.com>
"
openstack%2Fdesignate~master~I38d05065bb98c97bb08e878c94d44a18e7c1ac46,openstack/designate,master,,I38d05065bb98c97bb08e878c94d44a18e7c1ac46,Remove install-guide tox env,MERGED,2018-02-22 10:23:31.000000000,2018-02-25 16:45:13.000000000,2018-02-25 16:45:13.000000000,0,7,0,546937,90bb7f6051bf85175803d60c6d425f6dc74e21fb,7,3,1,1,26310,Hoang Trung Hieu,alanhoang,"Remove install-guide tox env

The install-guide tox env is not used any more after docs migration.

Change-Id: I38d05065bb98c97bb08e878c94d44a18e7c1ac46
"
openstack%2Fsenlin~master~I7050b89afae68725f86ef198499547117d4929a7,openstack/senlin,master,doc-fix,I7050b89afae68725f86ef198499547117d4929a7,Update cluster create command example,MERGED,2018-02-24 06:15:29.000000000,2018-02-25 16:27:59.000000000,2018-02-25 16:27:59.000000000,1,0,0,547718,1232ce35d2f1866597e7f62737e7beda25cbfb06,9,5,1,1,17656,blkart,blkart,"Update cluster create command example

Add config into output information.

Change-Id: I7050b89afae68725f86ef198499547117d4929a7
Signed-off-by: blkart <blkart.org@gmail.com>
"
openstack%2Fglance~master~Ib68769e148b5e3fa59d20aad0b40f22936af9216,openstack/glance,master,,Ib68769e148b5e3fa59d20aad0b40f22936af9216,Remove duplicate word 'the',ABANDONED,2018-02-24 04:10:57.000000000,2018-02-25 16:20:04.000000000,,2,2,0,547706,60face549024d979a7dc1a104c10c70e659c3ab9,6,4,1,2,21486,wangqi,wangqi,"Remove duplicate word 'the'

Change-Id: Ib68769e148b5e3fa59d20aad0b40f22936af9216
"
openstack%2Fsenlin~master~I2cb68c57bcb311e84591b436717905e56d4b8343,openstack/senlin,master,doc-update,I2cb68c57bcb311e84591b436717905e56d4b8343,Update cluster policy type list command example,MERGED,2018-02-24 07:47:19.000000000,2018-02-25 16:19:51.000000000,2018-02-25 16:19:50.000000000,3,0,0,547723,2a399848620e1bcd49b43dae5761e272d7ac4c6b,7,3,1,1,17656,blkart,blkart,"Update cluster policy type list command example

Add deletion and loadbalance policy version 1.1 support info.
Add scaling policy version 1.0 support info.

Change-Id: I2cb68c57bcb311e84591b436717905e56d4b8343
Signed-off-by: blkart <blkart.org@gmail.com>
"
openstack%2Fsenlin~master~I546519e814af437fbb93f0d7f1043536f299ed0c,openstack/senlin,master,,I546519e814af437fbb93f0d7f1043536f299ed0c,Update cluster policy type show command example,MERGED,2018-02-24 08:18:51.000000000,2018-02-25 16:19:49.000000000,2018-02-25 16:19:49.000000000,54,9,2,547725,8dbebdf35eaa4359a823af0cfd06b45de5d9a5a6,8,3,1,1,17656,blkart,blkart,"Update cluster policy type show command example

Use deletion policy version 1.1 in example.

Change-Id: I546519e814af437fbb93f0d7f1043536f299ed0c
Signed-off-by: blkart <blkart.org@gmail.com>
"
openstack%2Fsenlin~master~I5008e088a651455ea6d7db21c6ed363449284e6f,openstack/senlin,master,doc-update3,I5008e088a651455ea6d7db21c6ed363449284e6f,Update cluster receiver create command example,MERGED,2018-02-24 09:38:15.000000000,2018-02-25 16:19:48.000000000,2018-02-25 16:19:48.000000000,22,0,0,547742,a3e9e1c2e295f12e5e4f7c7535d01ac488e9b398,8,4,1,1,17656,blkart,blkart,"Update cluster receiver create command example

Add output information for command example.

Change-Id: I5008e088a651455ea6d7db21c6ed363449284e6f
Signed-off-by: blkart <blkart.org@gmail.com>
"
openstack%2Fsenlin~master~Id6c6a72fb35a192a6cac9e461d6a49c36590c06b,openstack/senlin,master,fix-py3-api-test,Id6c6a72fb35a192a6cac9e461d6a49c36590c06b,Fix py35 API test flake,MERGED,2018-02-23 14:59:10.000000000,2018-02-25 16:19:47.000000000,2018-02-25 16:19:47.000000000,2,2,0,547473,581241bee78b37f7a0c70d23ff21977e1fadb8fd,20,3,8,1,8246,Qiming Teng,tengqm,"Fix py35 API test flake

In py35, dict ordering seems not guaranteed so the version negotiation
sometimes (almost always) fail. This patch enforce the version checking
to be based on an ordered dict so py35 will be happy about it.

Change-Id: Id6c6a72fb35a192a6cac9e461d6a49c36590c06b
"
openstack%2Fdevstack~master~I4fdbe6bce12dfedd0d1e975ab8dd624ee3740c11,openstack/devstack,master,remove_xen_tools,I4fdbe6bce12dfedd0d1e975ab8dd624ee3740c11,XenAPI: remove xen tools,MERGED,2018-02-23 03:58:59.000000000,2018-02-25 15:29:38.000000000,2018-02-25 15:29:38.000000000,2,2662,0,547254,e619603bdab1eebc05690e42de887614a778022a,12,10,1,16,17920,Jianghua Wang,wjhfresh,"XenAPI: remove xen tools

The xen tools have been moved to the project of *os-xenapi* since
os-xenapi 0.3.0. We also did some refact work on these tools in
os-xenapi. This commit is to remove these tools from devstack. So
that os-xenapi will be the single place for xen tools.

Change-Id: I4fdbe6bce12dfedd0d1e975ab8dd624ee3740c11
"
openstack%2Fnova~stable%2Focata~Ide6cc5bb1fce2c9aea9fa3efdf940e8308cd9ed0,openstack/nova,stable/ocata,bug/1745977,Ide6cc5bb1fce2c9aea9fa3efdf940e8308cd9ed0,Lazy-load instance attributes with read_deleted=yes,MERGED,2018-02-19 21:38:24.000000000,2018-02-25 15:29:34.000000000,2018-02-25 15:29:34.000000000,20,3,0,545989,e0c1d461af0701adb94e6974f363e12395ed0162,19,11,1,2,6873,Matt Riedemann,mriedem,"Lazy-load instance attributes with read_deleted=yes

If we're doing a lazy-load of a generic attribute on instance, we
should be using read_deleted=yes. Otherwise we just fail in the load
process which is confusing and not helpful to a cleanup routine that
needs to handle the deleted instance. This makes us load those things
with read_deleted=yes.

Change-Id: Ide6cc5bb1fce2c9aea9fa3efdf940e8308cd9ed0
Closes-Bug: #1745977
(cherry picked from commit 6ba8a35825a7ec839b2d0aab7559351d573130ab)
(cherry picked from commit 619754f5c836ed1b58c807138836e6cf5a4e6904)
(cherry picked from commit 1407079d4008c6304799dd83f5bf4ba505d8e438)
"
openstack%2Fnova~stable%2Focata~I09b288aa2ad9969800a3cd26c675b002c6c9f638,openstack/nova,stable/ocata,bug/1693335-stable/ocata,I09b288aa2ad9969800a3cd26c675b002c6c9f638,Fix instance lookup in hide_server_addresses extension,MERGED,2017-11-10 23:43:11.000000000,2018-02-25 15:28:58.000000000,2018-02-25 15:28:57.000000000,3,2,0,518997,09970fe366cf3200a53d93c41bc996a58a25a4af,43,13,1,1,6873,Matt Riedemann,mriedem,"Fix instance lookup in hide_server_addresses extension

The hide_server_addresses extension is looking up the cached
instance based on what the user provided for the server id,
which may not match what is used to cache the instance for the
request. For example, a request with upper-case server uuid
could be found in a mysql-backed system because mysql is
case insensitive by default, but the instance is keyed off the
server id from the DB, which is lower-case, so we'll fail
to look up the instance in the cache if the IDs don't match.

There is no test for this because it turns out it's actually
really hard to recreate this since it requires running with a
mysql backend to recreate the case insensitive check, which
isn't going to work with sqlite. Given how trivial this fix is,
creating a big mysql recreate test is not worth it.

Change-Id: I09b288aa2ad9969800a3cd26c675b002c6c9f638
Closes-Bug: #1693335
(cherry picked from commit ecfb65cee68e96cc99ceecddbf27c6d6f768358e)
"
openstack%2Fcinder~driverfixes%2Focata~I0e55a8f9084bb8074616bc5c3b89fc8e341b6809,openstack/cinder,driverfixes/ocata,bug/1734505,I0e55a8f9084bb8074616bc5c3b89fc8e341b6809,DO NOT MERGE: Zuul fix,ABANDONED,2017-12-12 06:53:29.000000000,2018-02-25 15:05:37.000000000,,1,0,0,527318,3a956522371cd87c53fe74f8986cbb2d7aa3332d,9,7,1,1,24952,Vivek Soni,sonivi,"DO NOT MERGE: Zuul fix

Change-Id: I0e55a8f9084bb8074616bc5c3b89fc8e341b6809
Closes-Bug: #1734505
"
openstack%2Fcinder~master~I8713f846b1e2e30b4bbc4af57645fdc04bcd8386,openstack/cinder,master,bug/1726715,I8713f846b1e2e30b4bbc4af57645fdc04bcd8386,Don't fail when deleting missing backup,MERGED,2017-10-25 11:05:04.000000000,2018-02-25 15:05:34.000000000,2017-10-27 00:19:49.000000000,4,8,5,515026,6ff364f385b2bfe52a9c55ffbe357979b0dee9b4,104,37,8,2,24131,Abhishek Sharma M,abhi.sharma,"Don't fail when deleting missing backup

The problem here is sometimes when the path doesn't exist and we
try to delete it then exception occurs & breaks the flow. In this
case it happens with the volume delete flow, wherein the exception
occurs just before the quota commit & commit doesn't happen even
though the backup volume got deleted, hence catching the exception
just where it occurs.

Change-Id: I8713f846b1e2e30b4bbc4af57645fdc04bcd8386
Closes-Bug: 1726715
"
openstack%2Fcinder~stable%2Focata~Ied42d13b642617dd239ea92c019354b90657821a,openstack/cinder,stable/ocata,bug/1683431-stable/ocata,Ied42d13b642617dd239ea92c019354b90657821a,Fix NoneType has no attribute get,MERGED,2017-11-09 07:33:11.000000000,2018-02-25 15:05:32.000000000,2018-02-09 21:35:58.000000000,2,1,0,518673,8a0c155a9890efd28064da9173086e60579e3121,67,23,3,1,25169,Xiaojun Liao,wwba,"Fix NoneType has no attribute get

If volume_type is None and then create volumes with allow-multiattach,
Cinder-schduler will raise error:

AttributeError: 'NoneType' object has no attribute 'get'

Change-Id: Ied42d13b642617dd239ea92c019354b90657821a
Closes-bug: #1683431
(cherry picked from commit a58f66e180333ace479983e1287a62793bbd26aa)
"
openstack%2Fcinder~master~Ic112a68101c0dcb14da0db06c62ae190474a37d9,openstack/cinder,master,,Ic112a68101c0dcb14da0db06c62ae190474a37d9,Remove deprecated nova config options,MERGED,2017-09-13 11:14:25.000000000,2018-02-25 15:05:30.000000000,2017-10-16 15:49:57.000000000,11,75,2,503596,c463c6f50c5d1cf6277539626fe386f6d4df6355,186,46,6,5,18940,Gyorgy Szombathelyi,gyurco78,"Remove deprecated nova config options

In Pike, the nova client converted to use the [nova] section.
Remove the obsolete config options now.

Change-Id: Ic112a68101c0dcb14da0db06c62ae190474a37d9
"
openstack%2Fcinder~stable%2Fpike~I5c6ad150543213acfd0c78dbbdb1dc1584d22d26,openstack/cinder,stable/pike,bug/1632333,I5c6ad150543213acfd0c78dbbdb1dc1584d22d26,NetApp ONTAP: Copy offload bugfix,MERGED,2018-02-09 10:38:04.000000000,2018-02-25 15:05:26.000000000,2018-02-20 01:51:39.000000000,136,168,0,542770,82a13da48e7451c2f7813bf2de6990625c05624c,40,22,2,4,10058,Erlon R. Cruz,sombrafam,"NetApp ONTAP: Copy offload bugfix

When 'NetApp NFS Copy Offload' tool is configured to download Glance
images, these images are downloaded twice because the tool is doing
the job after Cinder has already done it.
This patch fixes the bug by executing the copy offload tool inside the
clone_image function instead of using the copy_image_to_volume.

Closes-bug: #1632333

Change-Id: I5c6ad150543213acfd0c78dbbdb1dc1584d22d26
(cherry-picked from commit c27173bad69da4889a5237cf2becc14bb6fc578a)
"
openstack%2Fcinder~driverfixes%2Fnewton~Ic94cbc50d5761c7fc67d2973bed70c70cf6bf769,openstack/cinder,driverfixes/newton,bug/1732812,Ic94cbc50d5761c7fc67d2973bed70c70cf6bf769,nimble: handle unicode strings in volume create,MERGED,2017-12-01 23:53:48.000000000,2018-02-25 15:04:41.000000000,2018-01-11 19:33:44.000000000,57,3,0,524768,6f9e2de22b77d9ef76727e018ad5c5308f6a6f3a,70,18,8,2,16668,Raunak Kumar,rkumar,"nimble: handle unicode strings in volume create

currently nimble cinder driver doesn't handle unicode strings
for display_name and display_description

Change-Id: Ic94cbc50d5761c7fc67d2973bed70c70cf6bf769
Closes-Bug: 1732812
(cherry picked from commit 23ac0ab4edd38b91b0c21d5c9e81cd1a7bdddc55)
"
openstack%2Fcinder~master~I76ca1251cd14da6c777bd48a28906d8362d836b0,openstack/cinder,master,522110,I76ca1251cd14da6c777bd48a28906d8362d836b0,Update access control of show under hostAPI,MERGED,2017-11-22 04:26:06.000000000,2018-02-25 15:04:25.000000000,2017-11-23 03:15:02.000000000,7,5,1,522110,f39c3fac2cf4e436a2c5de4f6bfcae1c879f3e43,65,35,5,3,26458,Brin Zhang,zhangbailin,"Update access control of show under hostAPI

Update the detection mechanism of show interface under the host API.
Replacement detection mode, and add policy for host show API.

Change-Id: I76ca1251cd14da6c777bd48a28906d8362d836b0
Closes-Bug: #1732808
"
openstack%2Fcinder~master~If2419008f3f978a4d18f16d57ec6a03fef065d87,openstack/cinder,master,bug/1730720,If2419008f3f978a4d18f16d57ec6a03fef065d87,HPE3PAR: Modify host & clear zone after detach,MERGED,2017-11-07 19:37:46.000000000,2018-02-25 15:04:23.000000000,2017-11-11 22:44:35.000000000,86,17,2,518388,aa15f58bdc40e5e27885b06430a96117b290d91e,122,40,4,3,24952,Vivek Soni,sonivi,"HPE3PAR: Modify host & clear zone after detach

Modify or remove wwn/iqn entries from 3par host, after
vlun deletion. If multiple volumes (via FC and ISCSI)
are exported to same host and FC/ISCSI volumes are
detached subsequently, this fix would remove all
WWN/IQN entries respectively from 3par host

If the last FC volume is detached, then it will remove
all zones from fabrics.

Change-Id: If2419008f3f978a4d18f16d57ec6a03fef065d87
Closes-Bug: #1730720
"
openstack%2Fcinder~master~Ic3c3e622410a83e4c40a95f9012ca19651bd9d01,openstack/cinder,master,,Ic3c3e622410a83e4c40a95f9012ca19651bd9d01,Storwize: Fix typo in log message,MERGED,2017-10-30 18:09:54.000000000,2018-02-25 15:04:21.000000000,2017-11-02 13:02:05.000000000,1,1,0,516414,5a650de44bfd54b88da1bc7a96b4a52ffe58572d,54,37,1,1,4523,Eric Harney,eharney,"Storwize: Fix typo in log message

A missing space here means the message reads as
""theallotted"".

TrivialFix

Change-Id: Ic3c3e622410a83e4c40a95f9012ca19651bd9d01
"
openstack%2Fcinder~master~I8218768216e87f6fdda1dd77dd09ca2ca46111c7,openstack/cinder,master,bug/1714503,I8218768216e87f6fdda1dd77dd09ca2ca46111c7,VMAX driver - Volume identifier issues,MERGED,2017-09-20 09:12:03.000000000,2018-02-25 15:04:15.000000000,2017-10-24 18:17:46.000000000,74,40,6,505559,cbce7226bb4fa922c7bea201e942bb88487154d4,224,48,7,3,23414,Ciara Stacke,cstacke,"VMAX driver - Volume identifier issues

When creating a VMAX volume through cinder, a 'volume_identifier' is
set on the device on the backend. This takes the form 'OS-<cinderUUID>'.
There are a couple of issues with how this is currently being done:
1. When the VMAX driver retrieves the volume using the 'device_id' value
saved in the provider location, it checks that the volume identifier
matches OS-<cinderUUID>. However, the way this is currently being
checked can cause an issue if the create volume operation ends up being
retried in cinder - sometimes there can be two devices on the backend
with the same volume identifier, and the code may not pick up the
correct device.
2. On a deallocate operation, the volume identifier is not being unset
on the device. This patch rectifies these issues.

Change-Id: I8218768216e87f6fdda1dd77dd09ca2ca46111c7
Closes-Bug: 1717933
"
openstack%2Fcinder~master~Id8d886feca938e99df14c35b17826b24d7c2b584,openstack/cinder,master,bp/replication-cg-svc,Id8d886feca938e99df14c35b17826b24d7c2b584,Add Storwize replication group support,MERGED,2017-05-31 09:26:59.000000000,2018-02-25 15:04:13.000000000,2017-10-19 10:11:15.000000000,2307,324,119,469394,24e4c3ea684c7d418c2de5ac8c46d175819a4b42,502,65,15,7,17045,xiaoqin,xiaoqin,"Add Storwize replication group support

This patch adds consistent replication group support for
Storwize/SVC driver.

Supported operations:
* Create replication consistency group
* Add volume to existing replication consistency group
* Adjust existing replication consistency group
* Enable replication on group
* Disable replication on group
* Fail over replication group back and forth

DocImpact Implements: blueprint replication-cg-svc

Change-Id: Id8d886feca938e99df14c35b17826b24d7c2b584
"
openstack%2Fcinder~stable%2Fpike~Ifb14e583723c87de7e83cdf0e5409dc61e8955d8,openstack/cinder,stable/pike,bug/1747656,Ifb14e583723c87de7e83cdf0e5409dc61e8955d8,VMAX doc - incorrect info on Hybrids in Pike,MERGED,2018-02-06 14:11:46.000000000,2018-02-25 15:04:06.000000000,2018-02-07 03:47:07.000000000,1,4,0,541282,114c6582809646f5be396e2912140449180ccbd0,19,15,1,1,12670,Helen Walsh,walshh2,"VMAX doc - incorrect info on Hybrids in Pike

VMAX driver will support VMAX hybrids beyond Rocky.  This has
already been updated in master but is part of the full Queens
documentation which is not relevant for Pike.

Change-Id: Ifb14e583723c87de7e83cdf0e5409dc61e8955d8
Closes-Bug: #1747656
"
openstack%2Fcinder~master~Id0d3b06b2debad70d36c253a3c1ee9d561a22e64,openstack/cinder,master,ks_auth,Id0d3b06b2debad70d36c253a3c1ee9d561a22e64,Simplify keystone password assertions,MERGED,2018-01-24 15:44:22.000000000,2018-02-25 15:03:53.000000000,2018-01-25 08:38:01.000000000,17,24,3,537427,a4b427c5e8a0bcd59c21d821c9a305cf1a54b159,38,28,3,1,11904,Sean McGinnis,SeanM,"Simplify keystone password assertions

With an update to keystoneauth1 > 3.3.0, some of the arguments
to the password plugin change. Some of our unit tests were a
little too zealous in checking the expected parameters that get
passed in to this.

Since we just need to verify that the password plugin is being
used, and we don't necessarily care about each of the values
being passed, just assert that the password plugin was called,
check some specific values, and keep it simple.

Change-Id: Id0d3b06b2debad70d36c253a3c1ee9d561a22e64
"
openstack%2Fcinder~stable%2Fpike~I18b890ab1a73e0e7e9e626c7f896486fdd1f6d75,openstack/cinder,stable/pike,bug/1737551,I18b890ab1a73e0e7e9e626c7f896486fdd1f6d75,Fix available space checking for image conversion,MERGED,2018-01-03 16:47:22.000000000,2018-02-25 15:03:47.000000000,2018-01-27 01:36:59.000000000,2,2,0,530966,fb7d962937b42d53f9bcd4eda60afa7db2997b7e,45,21,1,1,4523,Eric Harney,eharney,"Fix available space checking for image conversion

Cinder checks if there is enough free space to convert image from qcow
to raw format before uploading it into the volume. This patch fixes
the issue when we try to compare GiB to KiB.

Change-Id: I18b890ab1a73e0e7e9e626c7f896486fdd1f6d75
Closes-Bug: #1737551
(cherry picked from commit 66cc0d2429bddf0c983c6969a70b5cd1ea41e086)
Conflicts:
	cinder/image/image_utils.py
"
openstack%2Fcinder~master~I678986e557755c2fe4183927c17342e430f5df0d,openstack/cinder,master,enable_failback_for_solidfire,I678986e557755c2fe4183927c17342e430f5df0d,Enable fail back in SolidFire driver,MERGED,2017-12-19 23:30:57.000000000,2018-02-25 15:03:44.000000000,2017-12-23 16:26:47.000000000,155,48,0,529182,e7498ca5bdd6e16b46e8a6d17dbc7492f6e710e9,61,34,3,3,2243,John Griffith,john-griffith,"Enable fail back in SolidFire driver

This change fixes up a few things in the SolidFire driver to enable the
ability to ""fail back"" to the original cluster in a replication scenario.

We're still assuming a cluster-wide fail over, but now an admin has the
ability to specify subsequent `cinder failover-host` calls to switch
back and forth between their SF clusters.

This change promotes the target on a fail over and also now attempts to
set up replication back to the original src  as well (assuming the
original is available and not a puddle of melted goo).  This means that
writes to the new back end will be replicated back to the src, so if a
user so chooses they can fail back to the original and have their new
data.

Change-Id: I678986e557755c2fe4183927c17342e430f5df0d
"
openstack%2Fcinder~master~Ice541e231eca54318a71c7994a0bf30d1c40f5d0,openstack/cinder,master,,Ice541e231eca54318a71c7994a0bf30d1c40f5d0,Fix migration Invalid volume message,MERGED,2017-12-18 17:24:05.000000000,2018-02-25 15:03:31.000000000,2017-12-20 14:11:39.000000000,1,1,0,528767,313a212202cf30426f12b319c96134c480be1693,34,30,1,1,4523,Eric Harney,eharney,"Fix migration Invalid volume message

This currently prints the volume id as a
dict rather than the volume id.

Make it print the message with just the id.

Change-Id: Ice541e231eca54318a71c7994a0bf30d1c40f5d0
"
openstack%2Fcinder~master~I6ad364fa3713b9f41b56b4b3662634cfb02ef365,openstack/cinder,master,vmdk_version,I6ad364fa3713b9f41b56b4b3662634cfb02ef365,VMware: Bump driver version,MERGED,2017-12-08 02:31:07.000000000,2018-02-25 15:03:22.000000000,2017-12-12 22:20:50.000000000,11,1,0,526570,f857a2c66f1d1af85fc124f423c9889063f4a6ab,43,39,1,1,9171,Vipin Balachandran,vbala,"VMware: Bump driver version

Updating the vmdk driver version to reflect various
enhancements made in the current release.

Change-Id: I6ad364fa3713b9f41b56b4b3662634cfb02ef365
"
openstack%2Fcinder~stable%2Focata~I81dc6f1ac5855b21c10572797fd45a6b38641112,openstack/cinder,stable/ocata,,I81dc6f1ac5855b21c10572797fd45a6b38641112,"Revert ""Tests: Fail if oslo.versionedobjects issues Invalid UUID warnings""",MERGED,2017-11-30 12:46:32.000000000,2018-02-25 15:03:21.000000000,2017-12-04 15:06:43.000000000,0,12,0,524161,23377ac9a84f57c463653efc4b90f789d6f5cf3d,27,20,1,1,11904,Sean McGinnis,SeanM,"Revert ""Tests: Fail if oslo.versionedobjects issues Invalid UUID warnings""

This is currently causing unit test failures since
pymysql _show_warnings calls
    warnings.warn(err.Warning(*w[1:3]), stacklevel=4)
and this code assumes that the warnings are strings.

This reverts commit ed6d50bed642b01d005563866ab9f211632cff5b.

Change-Id: I81dc6f1ac5855b21c10572797fd45a6b38641112
(cherry picked from commit cc6c5b10867544ec0e2cbc73802ec8ee6213bc7a)
"
openstack%2Fcinder~master~Ibcba92f7cdb2506f3b2f31baa2fca6c696ff57a4,openstack/cinder,master,bug/fix_count_error,Ibcba92f7cdb2506f3b2f31baa2fca6c696ff57a4,Fix 'KeyError' when 'with_count' is not specified,MERGED,2017-11-25 07:28:34.000000000,2018-02-25 15:03:19.000000000,2017-11-28 02:42:33.000000000,6,3,2,522917,5b3e809c147a59971260f35f41510c20acaed3b4,69,32,4,3,23083,TommyLike,TommyLike,"Fix 'KeyError' when 'with_count' is not specified

Pop method will raise KeyError if the key
does not exist. Fix this by ensuring 'with_count'
exists before parsing the string value.

Change-Id: Ibcba92f7cdb2506f3b2f31baa2fca6c696ff57a4
"
openstack%2Fcinder~master~I87eef108a6315d630ce78b41bec6543e995e76af,openstack/cinder,master,zanata/translations,I87eef108a6315d630ce78b41bec6543e995e76af,Imported Translations from Zanata,MERGED,2017-11-21 06:14:31.000000000,2018-02-25 15:03:17.000000000,2017-11-21 12:12:01.000000000,239,662,0,521720,b07570360ce1519e205b2cc383fbe9a254ffc39e,36,29,1,11,11131,OpenStack Proposal Bot,proposal-bot,"Imported Translations from Zanata

For more information about this automatic import see:
https://docs.openstack.org/i18n/latest/reviewing-translation-import.html

Change-Id: I87eef108a6315d630ce78b41bec6543e995e76af
"
openstack%2Fcinder~stable%2Fpike~I87a287f5db912e9aeaa401871178c49414098d06,openstack/cinder,stable/pike,bug/1696361-stable/pike,I87a287f5db912e9aeaa401871178c49414098d06,Fix backup-import error when the deleted record in the same db,MERGED,2017-10-20 00:54:38.000000000,2018-02-25 15:03:13.000000000,2017-10-27 02:49:12.000000000,9,5,0,513572,d4c923345d5832dbc6c512f13b85d5c4e3fd4682,16,12,1,2,26567,kaufmann.smith,,"Fix backup-import error when the deleted record in the same db

If we revive the deleted backup record, cinder-api will raise a
DBDuplicateEntry error, this patch will allow user to import the deleted
record either in the same db or not.

Change-Id: I87a287f5db912e9aeaa401871178c49414098d06
Closes-Bug: #1696361
(cherry picked from commit ea5e4f3945714c9c21ae27468288dea36ab4e07d)
"
openstack%2Fcinder~master~I1c3ee6ad21bd27a5ef7f6691ddd8dde25e9c4c01,openstack/cinder,master,docs_cleanup,I1c3ee6ad21bd27a5ef7f6691ddd8dde25e9c4c01,Clean up docs landing page,MERGED,2017-10-03 19:07:07.000000000,2018-02-25 15:03:12.000000000,2017-10-04 22:27:39.000000000,59,77,0,509253,eca5f769270f6acf4d9f384a03a13ee3fb5b8148,33,28,1,5,11904,Sean McGinnis,SeanM,"Clean up docs landing page

Reorganizes and cleans up the docs landing page so viewers eyes don't
immediately start bleeding. Also tries to simplify things and put them
in a more logical and consumable order.

Change-Id: I1c3ee6ad21bd27a5ef7f6691ddd8dde25e9c4c01
"
openstack%2Fcinder~master~Ia26eebe7b5777c5a72c6407de242e683683d94dc,openstack/cinder,master,zanata/translations,Ia26eebe7b5777c5a72c6407de242e683683d94dc,Imported Translations from Zanata,MERGED,2018-02-18 06:25:35.000000000,2018-02-25 15:02:58.000000000,2018-02-18 09:23:11.000000000,5,2,0,545652,062d76ecfc498e74ee77837185356516df47adc8,28,24,1,1,11131,OpenStack Proposal Bot,proposal-bot,"Imported Translations from Zanata

For more information about this automatic import see:
https://docs.openstack.org/i18n/latest/reviewing-translation-import.html

Change-Id: Ia26eebe7b5777c5a72c6407de242e683683d94dc
"
openstack%2Fcinder~master~Ib3cde34d9a181107c77c31c22d225dab073f37b0,openstack/cinder,master,log_format_err,Ib3cde34d9a181107c77c31c22d225dab073f37b0,Remove deprecated fatal_exception_format_errors option,MERGED,2018-02-14 21:42:40.000000000,2018-02-25 15:02:55.000000000,2018-02-17 11:52:03.000000000,0,16,0,544704,948f90835b816336b9df5d192445b74096bc1c50,53,34,2,2,11904,Sean McGinnis,SeanM,"Remove deprecated fatal_exception_format_errors option

This config option was only used for internal testing. In Queens
tests were updated to always do this, regardless of the config
option. This removes the option.

No release note included since this was really only an internal
thing and mentioning there would probably just cause confusion.

Change-Id: Ib3cde34d9a181107c77c31c22d225dab073f37b0
"
openstack%2Fcinder~stable%2Fpike~I745062e8fbc8864e5c9d489c687ec37aca862a8f,openstack/cinder,stable/pike,bug/1745549,I745062e8fbc8864e5c9d489c687ec37aca862a8f,Update NEC driver configuration document for Pike,MERGED,2018-01-26 08:09:14.000000000,2018-02-25 15:02:44.000000000,2018-02-02 06:57:18.000000000,15,4,0,538174,0dfda7ef70aa8a29e81bb3974fff538316aa5816,19,14,1,1,23885,Shunei Shiono,s-shiono,"Update NEC driver configuration document for Pike

Added a step for creating control volumes to the initial setup
procedure.

Change-Id: I745062e8fbc8864e5c9d489c687ec37aca862a8f
Partial-Bug: #1745549
"
openstack%2Fcinder~master~I1db2771f7c970341f62271a857795d413a506a34,openstack/cinder,master,,I1db2771f7c970341f62271a857795d413a506a34,ScaleIO: Enable multiattach for volumes,MERGED,2018-01-05 22:26:10.000000000,2018-02-25 15:01:45.000000000,2018-01-22 16:57:30.000000000,11,0,1,531511,bfdb90ed620d6ef424188e187593940867dbaca5,87,38,2,2,25033,Eric Young,tssgery,"ScaleIO: Enable multiattach for volumes

Enable the multiattach capability to allow volumes
to be attached to more than one instance

Change-Id: I1db2771f7c970341f62271a857795d413a506a34
"
openstack%2Fcinder~master~I154d85cde693c6e77e22a677cae7150be48fce07,openstack/cinder,master,backup,I154d85cde693c6e77e22a677cae7150be48fce07,SMBFS: fix detecting if a volume is in-use,MERGED,2017-12-15 17:25:43.000000000,2018-02-25 15:01:35.000000000,2017-12-20 00:07:14.000000000,24,19,0,528351,fb48a1fe64dfc6f241eaff968b4ba0ed84a39adc,53,33,2,4,8543,Lucian Petrut,plucian,"SMBFS: fix detecting if a volume is in-use

The SMBFS driver along with the remotefs module rely on the volume
status field when checking if it's attached.

While in most cases this is fine, it will cause issues when backing
up volumes. In this situation, the volume status will be 'backing-up',
in which case the driver will wrongfully consider that the volume is
detached (by not having the 'in-use' state).

In particular, this affects the volume snapshot workflow.

This change fixes this check, adding a helper method which detects
the volume attach status by looking at the volume 'attach_status'
field.

Change-Id: I154d85cde693c6e77e22a677cae7150be48fce07
Partial-Implements: windows-smb-backup
"
openstack%2Fcinder~master~Iaec8c382f3ae578b3f1da1c570f0b83be59ee984,openstack/cinder,master,nas_ip,Iaec8c382f3ae578b3f1da1c570f0b83be59ee984,Remove deprecated HP 3PAR config options,MERGED,2017-12-15 15:03:32.000000000,2018-02-25 15:01:28.000000000,2017-12-22 13:37:14.000000000,15,20,0,528300,b36ec9c29b742b416f2eba5cb6a5563d85c3c7af,65,33,2,2,1736,Ivan Kolodyazhny,e0ne,"Remove deprecated HP 3PAR config options

HP 3PAR was deprecated during Liberty and now it's safe to be removed.
New HPE 3PAR options should be used instead.

Change-Id: Iaec8c382f3ae578b3f1da1c570f0b83be59ee984
"
openstack%2Fcinder~master~If59c491446a7bf7b928ca2219092ed9561501cd9,openstack/cinder,master,fix_group_type_specs_api_ref,If59c491446a7bf7b928ca2219092ed9561501cd9,Fix api-ref for v3 group type specs,MERGED,2017-12-06 04:04:35.000000000,2018-02-25 15:01:07.000000000,2017-12-11 21:00:34.000000000,11,3,0,525868,07624e533c37218dfa3aac8f2745d702673dde07,37,32,1,2,23081,Jeremy Zhang,jeremy.zhang,"Fix api-ref for v3 group type specs

This patch aims to make some trivial fix on api-ref for v3 group type
specs.

Change-Id: If59c491446a7bf7b928ca2219092ed9561501cd9
"
openstack%2Fcinder~stable%2Fpike~I3b775da8c5e862def54e9d44d7b157cf17a07a24,openstack/cinder,stable/pike,bug/1726284-stable/pike,I3b775da8c5e862def54e9d44d7b157cf17a07a24,Unity: Fix duplicate hosts created with same name,MERGED,2017-12-04 01:56:34.000000000,2018-02-25 15:01:06.000000000,2017-12-09 19:34:09.000000000,68,39,0,525025,85bc7559fb3b8c8ff3d508b3ef54bc4ba4a0591f,24,21,1,4,10628,Peter Wang,peter_wang,"Unity: Fix duplicate hosts created with same name

In some circumstance, there is a race condition in querying/creating
Unity host thus multiple hosts with same name were created.

This issue stops any further attach/detach operation.

This patch leverage the DSL in cinder to avoid above race condition.

Change-Id: I3b775da8c5e862def54e9d44d7b157cf17a07a24
Closes-bug: #1726284
(cherry picked from commit d8dd30f16b8712385b2f0d43c4d0a45f5fe4be41)
"
openstack%2Fcinder~master~Ide79fda590762cc040acc36987504a2bee2e85fe,openstack/cinder,master,bug/1518798,Ide79fda590762cc040acc36987504a2bee2e85fe,Disallow managed volume to be managed again,MERGED,2017-11-28 13:55:55.000000000,2018-02-25 15:01:04.000000000,2017-12-06 12:43:20.000000000,9,1,9,523417,ff878ad0ade86d527696cd05d1c2ca51c7f9c4b3,72,38,6,1,27274,Omar Muhtaseb,OmarM,"Disallow managed volume to be managed again

On manage existing volume, check if the volume is already managed.
If the volume is already managed, display an error
""Unable to manage existing volume. The volume is already managed""

Closes-bug: #1518798

Change-Id: Ide79fda590762cc040acc36987504a2bee2e85fe
"
openstack%2Fcinder~master~I30fe1b0964679416b46a4bbcb72e75814f022aa8,openstack/cinder,master,filter-valid-fc-initiators,I30fe1b0964679416b46a4bbcb72e75814f022aa8,Filter valid FC initiator while FC attaching,MERGED,2017-09-19 11:25:45.000000000,2018-02-25 15:00:44.000000000,2017-11-25 16:23:43.000000000,42,0,3,505178,213b451d82116072ad7ffac19bb1762356217c78,86,44,3,5,16203,zengyingzhe,zengyingzhe,"Filter valid FC initiator while FC attaching

While attaching a volume by FC, Huawei driver will verify the FC initiator
wwns validation via checking if these wwns exist in Huawei storage.
At the situation of NOVA compute node connects to multiple storage through
FC, the passed in inititator wwns must include the wwns that aren't actually
connected to current backend storage, so the verification would fail.

To avoid this problem, add a filtering step for initiator wwns according to
the actual valid FC initiators in backend storage before verification.

Change-Id: I30fe1b0964679416b46a4bbcb72e75814f022aa8
"
openstack%2Fcinder~master~Ic94cbc50d5761c7fc67d2973bed70c70cf6bf769,openstack/cinder,master,bug/1732812,Ic94cbc50d5761c7fc67d2973bed70c70cf6bf769,nimble: handle unicode strings in volume create,MERGED,2017-11-17 20:10:42.000000000,2018-02-25 15:00:37.000000000,2017-12-01 23:36:04.000000000,57,3,0,521185,23ac0ab4edd38b91b0c21d5c9e81cd1a7bdddc55,84,35,4,2,16668,Raunak Kumar,rkumar,"nimble: handle unicode strings in volume create

currently nimble cinder driver doesn't handle unicode strings
for display_name and display_description

Change-Id: Ic94cbc50d5761c7fc67d2973bed70c70cf6bf769
Closes-Bug: 1732812
"
openstack%2Fcinder~stable%2Fpike~If2419008f3f978a4d18f16d57ec6a03fef065d87,openstack/cinder,stable/pike,bug/1730720,If2419008f3f978a4d18f16d57ec6a03fef065d87,HPE3PAR: Modify host & clear zone after detach,MERGED,2017-11-20 05:16:08.000000000,2018-02-25 15:00:36.000000000,2017-11-20 22:13:18.000000000,87,17,0,521416,cc6bca988da313dd72f190ad84c1a91b58fca9c6,20,20,1,3,24952,Vivek Soni,sonivi,"HPE3PAR: Modify host & clear zone after detach

Modify or remove wwn/iqn entries from 3par host, after
vlun deletion. If multiple volumes (via FC and ISCSI)
are exported to same host and FC/ISCSI volumes are
detached subsequently, this fix would remove all
WWN/IQN entries respectively from 3par host

If the last FC volume is detached, then it will remove
all zones from fabrics.

Change-Id: If2419008f3f978a4d18f16d57ec6a03fef065d87
Closes-Bug: #1730720
(cherry picked from commit aa15f58bdc40e5e27885b06430a96117b290d91e)
"
openstack%2Fcinder~master~Ie63c6ec677f7fd800a10c9759c535cba395f3ec1,openstack/cinder,master,TrivialFix,Ie63c6ec677f7fd800a10c9759c535cba395f3ec1,NetApp ONTAP: Remove orphaned 7mode file,MERGED,2017-11-13 19:09:49.000000000,2018-02-25 15:00:32.000000000,2017-11-14 22:10:01.000000000,0,0,0,519452,0f8afcb8748d1332f983621866a2f5e7bcaa3633,31,25,1,1,16643,Goutham Pacha Ravi,gouthamr,"NetApp ONTAP: Remove orphaned 7mode file

When the 7mode drivers were removed as part
of I129ca060a89275ffd56481b8f64367b0d803cff5,
a file was inadvertently left behind, blank.

TrivialFix

Change-Id: Ie63c6ec677f7fd800a10c9759c535cba395f3ec1
"
openstack%2Fcinder~master~I1471ecfffe340dafb1c95bac5eaff79cde650955,openstack/cinder,master,bug/1718739,I1471ecfffe340dafb1c95bac5eaff79cde650955,NetApp E-series: Fix provisioned_capacity_gb,MERGED,2017-11-07 22:29:38.000000000,2018-02-25 15:00:30.000000000,2017-11-20 09:17:16.000000000,26,3,0,518406,f905253b9443db1870c3d2b7b70e032bb089efa0,51,34,1,4,14865,Adriano Freires Rosso,adriano_rosso,"NetApp E-series: Fix provisioned_capacity_gb

Currently, NetApp E-series drivers (iSCSI and FC) are incorrectly
reporting the total physical used size as the provisioned_capacity_gb.
This patch fixes the calculation of this attribute by summing the
user-visible capacity of all the volumes present in the backend and
reporting the result as the provisioning_capacity_gb.

Change-Id: I1471ecfffe340dafb1c95bac5eaff79cde650955
Closes-Bug: #1718739
"
openstack%2Fcinder~master~I0a7af6e4b2f407df7d02e6a0348fbe48c8d0e21e,openstack/cinder,master,oslo_py_log,I0a7af6e4b2f407df7d02e6a0348fbe48c8d0e21e,Use oslo_log instead of logging,MERGED,2017-11-07 07:17:06.000000000,2018-02-25 15:00:29.000000000,2017-11-07 13:06:14.000000000,1,1,0,518266,2f97b0c98111730b9caaee2cd38daeedcbe4e699,33,27,1,1,11904,Sean McGinnis,SeanM,"Use oslo_log instead of logging

We missed a recent addition that used Python logging instead of oslo.log.
This just changes the import to use the right logging module.

Change-Id: I0a7af6e4b2f407df7d02e6a0348fbe48c8d0e21e
"
openstack%2Fcinder~master~I5f4af36e7643b41b68ac438ce048559c15b6c5b8,openstack/cinder,master,,I5f4af36e7643b41b68ac438ce048559c15b6c5b8,ScaleIO - Cleanup and enhance configuration doc,MERGED,2017-11-02 15:38:32.000000000,2018-02-25 15:00:27.000000000,2017-11-05 01:21:41.000000000,196,190,12,517354,ae69084f7c862296403f5b789b0ff6311c927477,48,27,2,1,25033,Eric Young,tssgery,"ScaleIO - Cleanup and enhance configuration doc

Restructuring the configuration content for the ScaleIo driver
and adding more information on how to specify a specific
protection domain and storage pool in a volume type as well as
providing examples of setting QOS specs.

Change-Id: I5f4af36e7643b41b68ac438ce048559c15b6c5b8
"
openstack%2Fcinder~stable%2Fpike~Iaae24a7de7171d9c1dc6197aa79b7d8ee87c0051,openstack/cinder,stable/pike,bug/1724074-stable/pike,Iaae24a7de7171d9c1dc6197aa79b7d8ee87c0051,ibm-storage: Fix create_volume_from_snapshot,MERGED,2017-10-31 15:42:18.000000000,2018-02-25 15:00:15.000000000,2017-11-05 00:16:38.000000000,23,9,1,516722,f3430f54965b243a33eacdda747f9a5a6315a2f2,21,19,1,2,14532,Gerald McBrearty,gfm,"ibm-storage: Fix create_volume_from_snapshot

If a snapshot was created from a volume that is part of a generic group,
then when calling ""create_volume_from_snapshot"", the exception
SourceVolumeBadNameError is raised.
This is a leftover from the days where there were no generic groups
(Only consistency groups were exist)

Change-Id: Iaae24a7de7171d9c1dc6197aa79b7d8ee87c0051
Closes-Bug: #1724074
(cherry picked from commit 104d6fc8207d8633cd6fd650a488e86c80057477)
"
openstack%2Fcinder~master~I65393a6a5f995d609152d4b8546c055d7bf0b253,openstack/cinder,master,bp/storwize-backup-snapshots,I65393a6a5f995d609152d4b8546c055d7bf0b253,Storwize: add backup snapshots support,MERGED,2017-10-17 09:40:18.000000000,2018-02-25 15:00:09.000000000,2017-11-07 08:22:42.000000000,222,18,4,512562,f68847353e46c8729d8fc13d2e53608c72c159c7,297,46,9,5,11186,yixuan zhang,yixuanzhang,"Storwize: add backup snapshots support

This patch adds backup snapshots support for Storwize/SVC driver.
The change implements attach and detach snapshot:
initialize_connection_snapshot
terminate_connection_snapshot

Implements: blueprint storwize-backup-snapshots

Change-Id: I65393a6a5f995d609152d4b8546c055d7bf0b253
"
openstack%2Fcinder~master~Id66b6bd9d1a26202f0473628976b6b7da8f9997f,openstack/cinder,master,zanata/translations,Id66b6bd9d1a26202f0473628976b6b7da8f9997f,Imported Translations from Zanata,MERGED,2017-10-23 07:26:27.000000000,2018-02-25 15:00:07.000000000,2017-10-23 14:39:32.000000000,55,58429,0,514170,0ff3fb31f088cef2f3ac8b84bc551d4cb54d4988,25,21,1,22,11131,OpenStack Proposal Bot,proposal-bot,"Imported Translations from Zanata

For more information about this automatic import see:
https://docs.openstack.org/i18n/latest/reviewing-translation-import.html

Change-Id: Id66b6bd9d1a26202f0473628976b6b7da8f9997f
"
openstack%2Fcinder~stable%2Fpike~I2caa5f2763ec343b0bc875e707924ff9b6424ce5,openstack/cinder,stable/pike,bug/1719659,I2caa5f2763ec343b0bc875e707924ff9b6424ce5,Dell EMC PS: Fix over-subscription ratio stats,MERGED,2017-10-17 17:11:57.000000000,2018-02-25 15:00:06.000000000,2017-10-19 20:08:01.000000000,9,4,0,512740,a6632b7a79a13e3611801080dfdb4131b90985a5,26,19,2,3,10379,Rajini Karthik,rajinir,"Dell EMC PS: Fix over-subscription ratio stats

Fixed the provisioned_capacity_gb to use the VolumeReportedSpace
to calculate the over-subscription ratio stats in the Dell EMC
PS volume driver.

Closes Bug: #1719659

Change-Id: I2caa5f2763ec343b0bc875e707924ff9b6424ce5
(cherry picked from commit 761f0c3e66691e6f5c683a63a81beccbbca1cacf)
"
openstack%2Fcinder~master~I8e1b544f510c1a0af30a5a0b672578226c9fd315,openstack/cinder,master,policy-and-docs-in-code,I8e1b544f510c1a0af30a5a0b672578226c9fd315,[policy in code] Add support for snapshot resource,MERGED,2017-09-27 03:15:37.000000000,2018-02-25 15:00:03.000000000,2017-10-10 19:58:34.000000000,349,58,2,507721,d5d070534305eb56582e6e24ebecb6433e4cb746,89,40,3,13,23083,TommyLike,TommyLike,"[policy in code] Add support for snapshot resource

This patch adds policy in code support for snapshot
resources and depends on the basic patch [1].

[1]: https://review.openstack.org/#/c/506976/

Change-Id: I8e1b544f510c1a0af30a5a0b672578226c9fd315
Partial-Implements: blueprint policy-in-code
"
openstack%2Fcinder~master~Id03ff9310fd53c4e6df300f2866b7a17cba82561,openstack/cinder,master,update_blockbox,Id03ff9310fd53c4e6df300f2866b7a17cba82561,Update BlockBox,MERGED,2017-10-04 20:10:18.000000000,2018-02-25 15:00:01.000000000,2017-10-06 19:49:16.000000000,70,2228,0,509622,3a2205e39359fdf98940c35f8ece7d26afc909aa,34,30,1,21,2243,John Griffith,john-griffith,"Update BlockBox

There have been a number of changes to LOCI since the introduction
of BlockBox.  In particular LOCI now offers a `universal` Dockerfile
and employees bindeps and new ARGS features of Docker to customize
images.

This patch modifies BlockBox to use the new universal LOCI repo and
also cleans up a bunch of cruft and adds an updated conf entry with
key-manager.

This patch also removes the dev environment as it's out dated and
doesn't seem to be gaining much usage.  It's easy enough to set
this up on your own, so rather than maintain it just remove it.

Change-Id: Id03ff9310fd53c4e6df300f2866b7a17cba82561
"
openstack%2Fcinder~master~Ib4a0c50f699edb1cc2ea669ac711eb2f537be417,openstack/cinder,master,,Ib4a0c50f699edb1cc2ea669ac711eb2f537be417,Fix tempest test revet_client typo,MERGED,2017-10-02 20:34:41.000000000,2018-02-25 15:00:00.000000000,2017-10-06 17:44:33.000000000,2,2,0,508995,395407c9578686ebc23f0bd4cbc567ac97bafbe9,52,34,1,2,4523,Eric Harney,eharney,"Fix tempest test revet_client typo

TrivialFix

Change-Id: Ib4a0c50f699edb1cc2ea669ac711eb2f537be417
"
openstack%2Fcinder~stable%2Fpike~I117319ac12991e4b46170fe71d18a65ea4c98556,openstack/cinder,stable/pike,bug/1750074,I117319ac12991e4b46170fe71d18a65ea4c98556,Cinder logs rabbitmq password on connection log,MERGED,2018-02-17 19:14:57.000000000,2018-02-25 14:59:53.000000000,2018-02-21 19:47:54.000000000,1,0,0,545621,d51fabb497df2606f04f90cbd2e842c7692bb1af,37,17,2,1,11269,Marga Millet,marga,"Cinder logs rabbitmq password on connection log

Cinder displays rabbitmq password if debug is enabled.

Closes-Bug: 1750074
Change-Id: I117319ac12991e4b46170fe71d18a65ea4c98556
(cherry picked from commit 919dd16a35ef2d0fd2ee4911398ba7830c02c6fd)
(cherry picked from commit ca9bf2d1c56605a565ffc468bb91fb5d58ef5ce9)
"
openstack%2Fcinder~stable%2Fqueens~I53e94a827c3ba31c7322e6faecfcc8ebf4a05b4a,openstack/cinder,stable/queens,add_multiattach_capability_to_solidfire-stable/queens,I53e94a827c3ba31c7322e6faecfcc8ebf4a05b4a,Add multiattach reporting to SolidFire,MERGED,2018-02-20 09:01:22.000000000,2018-02-25 14:59:18.000000000,2018-02-20 12:00:32.000000000,1,0,0,546081,29b151483104cd0a548923b16a56c88b2c585894,17,13,1,1,9562,Ildiko Vancsa,ildikov,"Add multiattach reporting to SolidFire

Wonders never cease!  Multiattach has landed, the cow jumped over
the moon and they put Humpty Dumpty back together again!

This change just addes multiattach=True to the SolidFire driver
now that everything has in fact landed.

Change-Id: I53e94a827c3ba31c7322e6faecfcc8ebf4a05b4a
"
openstack%2Fcinder~master~I991282cd7547dddf2324cdf1ea63bd12d4303ab1,openstack/cinder,master,gaofei,I991282cd7547dddf2324cdf1ea63bd12d4303ab1,Replace Chinese punctuation with English punctuation,MERGED,2018-01-23 08:26:47.000000000,2018-02-25 14:58:09.000000000,2018-01-23 17:59:07.000000000,16,16,0,536712,5f0ea63b60dbec6175145f975789253d2a956384,36,31,1,5,27386,gaofei,gaofei,"Replace Chinese punctuation with English punctuation

Change-Id: I991282cd7547dddf2324cdf1ea63bd12d4303ab1
"
openstack%2Fcinder~stable%2Fpike~I3419e628d42eddfe19c55cd72e7b9469e9fccc94,openstack/cinder,stable/pike,bug/1732462-stable/pike,I3419e628d42eddfe19c55cd72e7b9469e9fccc94,VNX: Fix cloning failure when system is busy,MERGED,2018-01-06 09:31:44.000000000,2018-02-25 14:58:07.000000000,2018-01-22 17:35:01.000000000,10,9,0,531532,41c565debb918c07f18fbe864002abcc241fe50e,39,22,1,3,10628,Peter Wang,peter_wang,"VNX: Fix cloning failure when system is busy

In newton, the 30s wait was removed due to refactor, in this case,
If the session hasn't started in the VNX, the driver would perform
unexpected rollback for the migration.

Adding a wait will make sure the session is started on the VNX thus
cloning can succeed.

Change-Id: I3419e628d42eddfe19c55cd72e7b9469e9fccc94
Closes-bug: #1732462
(cherry picked from commit 552d6fd33a4a2534eea6ca71765ab9936f5920b7)
"
openstack%2Fcinder~stable%2Focata~Id31258ef6f28caca226ac4a0a7f91fd8c8d87e88,openstack/cinder,stable/ocata,zanata/translations,Id31258ef6f28caca226ac4a0a7f91fd8c8d87e88,Imported Translations from Zanata,MERGED,2018-01-19 07:14:56.000000000,2018-02-25 14:58:02.000000000,2018-01-19 19:37:56.000000000,164,4,0,535639,225eef456adee310314335857e9594c7d12fc2de,14,10,1,1,11131,OpenStack Proposal Bot,proposal-bot,"Imported Translations from Zanata

For more information about this automatic import see:
https://docs.openstack.org/i18n/latest/reviewing-translation-import.html

Change-Id: Id31258ef6f28caca226ac4a0a7f91fd8c8d87e88
"
openstack%2Fcinder~master~I0ab094a961f0911e860d986c3db28a4e6c75a9f6,openstack/cinder,master,bug/fix_transfer_bug,I0ab094a961f0911e860d986c3db28a4e6c75a9f6,Update volume's 'updated_at' when accept transfer,MERGED,2018-01-16 10:02:00.000000000,2018-02-25 14:57:52.000000000,2018-01-18 06:46:09.000000000,1,2,0,534216,6ce5268b5629533401840bb4aebbf7bff0014621,64,34,1,1,23083,TommyLike,TommyLike,"Update volume's 'updated_at' when accept transfer

When accept volume transfer, the volume object's
'user_id', 'project_id' and 'status' are all updated,
'updated_at' should be refreshed as well.

Change-Id: I0ab094a961f0911e860d986c3db28a4e6c75a9f6
"
openstack%2Fcinder~master~Ifd91b8ddd0f18451b73b7472c9185dacb48b3a72,openstack/cinder,master,huawei-tests-loop,Ifd91b8ddd0f18451b73b7472c9185dacb48b3a72,Mock FixedIntervalLoopingCall for Huawei unit tests,MERGED,2018-01-04 15:52:08.000000000,2018-02-25 14:56:58.000000000,2018-01-05 13:54:49.000000000,4,0,0,531181,b0b0213ec08a9222259d8cb0ceb145044f7c6fc8,37,27,1,1,1736,Ivan Kolodyazhny,e0ne,"Mock FixedIntervalLoopingCall for Huawei unit tests

We should use ZeroIntervalLoopingCall instead of
FixedIntervalLoopingCall to speed-up our tests.

Change-Id: Ifd91b8ddd0f18451b73b7472c9185dacb48b3a72
"
openstack%2Fcinder~master~Id47c42e91885413572dfcc893cf3ecc02681c673,openstack/cinder,master,bug/1739987,Id47c42e91885413572dfcc893cf3ecc02681c673,Missing generalized_filters in cinder administration doc,MERGED,2017-12-25 02:42:07.000000000,2018-02-25 14:56:30.000000000,2017-12-26 02:26:09.000000000,1,0,0,529996,b5adb1e7bc14473555509229465cdcfd4b479b95,30,25,1,1,8846,Hao Wang,sxmatch,"Missing generalized_filters in cinder administration doc

Now cinder miss ""generalized_filters"" in administration doc,
though we defined it in index.rst.

Closes-Bug: #1739987
Change-Id: Id47c42e91885413572dfcc893cf3ecc02681c673
"
openstack%2Fcinder~master~I84e614346cfa4d302f919d12bea9680c5e527475,openstack/cinder,master,,I84e614346cfa4d302f919d12bea9680c5e527475,Follow the new PTI for document build,MERGED,2017-12-19 09:26:46.000000000,2018-02-25 14:56:28.000000000,2017-12-22 16:41:30.000000000,17,5,2,529006,f877ec291776930737c509220a7ac4a74cc2ed15,76,35,4,3,22694,jian.song,jiansong,"Follow the new PTI for document build

For compliance with the Project Testing Interface as described in:

https://governance.openstack.org/tc/reference/project-testing-interface.html

For more detials information, please refer to:

http://lists.openstack.org/pipermail/openstack-dev/2017-December/125710.html

Change-Id: I84e614346cfa4d302f919d12bea9680c5e527475
"
openstack%2Fcinder~master~Ic0698e4fc0f6519c2676fe91e1a6c0fb47bbeb95,openstack/cinder,master,bug/1737724,Ic0698e4fc0f6519c2676fe91e1a6c0fb47bbeb95,Add online data migration routine for attachment_specs,MERGED,2017-12-19 21:26:36.000000000,2018-02-25 14:56:27.000000000,2017-12-22 17:31:29.000000000,108,5,1,529160,bf5c34e30a74d7915b25dff36dd1bd34de9d4e4f,49,31,2,5,6873,Matt Riedemann,mriedem,"Add online data migration routine for attachment_specs

This adds the hook to the cinder-manage db online_data_migration
CLI for migrating attachment_specs entries to the volume_attachment
table.

Along the way, two changes have to be made in the VolumeAttachment
object:

1. Handle 'connector' in updates in VolumeAttachment.create(); this
   makes the test work to create a volume attachment with the connector
   already set, something we should support so you don't have to create()
   and then save() the object.
2. In _from_db_object, we have to set the context on the attachment
   object and reset the volume field changes *before* saving the
   connector changes, otherwise save() fails because (a) it has an
   empty context and (2) you can't change a volume through the attachment.

Change-Id: Ic0698e4fc0f6519c2676fe91e1a6c0fb47bbeb95
Related-Bug: #1737724
"
openstack%2Fcinder~master~Ibff5a5aaa288138c4c63875d67ddebd24a40fd3f,openstack/cinder,master,openstack/requirements,Ibff5a5aaa288138c4c63875d67ddebd24a40fd3f,Updated from global requirements,MERGED,2017-12-15 21:23:37.000000000,2018-02-25 14:56:22.000000000,2017-12-19 13:18:00.000000000,4,4,0,528395,2a71d4cdebf462b9ffd24bfa28ff7109f264818b,67,32,3,1,11131,OpenStack Proposal Bot,proposal-bot,"Updated from global requirements

Change-Id: Ibff5a5aaa288138c4c63875d67ddebd24a40fd3f
"
openstack%2Fcinder~master~I35db18f36f86683f2ab16694c9787c908251a382,openstack/cinder,master,bug/1703954,I35db18f36f86683f2ab16694c9787c908251a382,Fix create encrypted volume from image,MERGED,2017-12-18 11:40:46.000000000,2018-02-25 14:56:21.000000000,2017-12-19 01:07:49.000000000,45,0,0,528694,3b01eb78ce1c1ce388521f8122b3d6b8f2686fda,32,28,1,2,9535,Gorka Eguileor,Gorka,"Fix create encrypted volume from image

If we run two create encrypted volume from image serially (waiting for
one operation to complete before the making the next request) the first
operation succeeds while the second one will fail during the attach
phase.

The failure we see in the logs indicate that OS-Brick is unable to get
the WWN from the connected volume.

In reality the failure to attach the volume on the second operation is
caused by a failed cleanup of the first create, even if there's no error
in the logs.

The reason why OS-Brick didn't correctly do the cleanup of the first
volume is because didn't know that it was attaching an encrypted volume
and returned a real path (ie: /dev/sdf) that then go overwritten by the
unencrypted device mapper.

The solution is letting OS-Brick know that it's an encrypted volume
during the attachment phase so it will return a symlink to the real
device instead of the real device itself.

The manager's ""initialize_connection"" does this correctly, but the
method creating the volume from an image doesn't use the method of that
class and calls the driver's ""initialize_connection"" method instead,
which is missing the ""encrypted"" field.

Closes-Bug: #1703954
Change-Id: I35db18f36f86683f2ab16694c9787c908251a382
"
openstack%2Fcinder~master~I60f8e8864f236fb92dd03560576377f1a0bdd82b,openstack/cinder,master,bug/1733967,I60f8e8864f236fb92dd03560576377f1a0bdd82b,Check for migrated UUID in SolidFire delete,MERGED,2017-11-23 00:34:45.000000000,2018-02-25 14:56:10.000000000,2017-12-17 22:55:24.000000000,24,28,0,522410,0e6ee1b1df38059f338ebd93c605dfb51a93a8a5,45,30,2,2,2243,John Griffith,john-griffith,"Check for migrated UUID in SolidFire delete

Migration of volumes kinda screws up the use of ID as the
reference to use for deleting volumes.

If a volume is migrated, the UUID (ID) gets swapped and no
longer matches the UUID the volume had when it was initially
created on the back end device.  The result is that deletion
of that volume fails on the back end because the handle to the
new UUID doesn't exist.

On the other hand, you also have to be careful in dealing with
and cleaning up volumes migrated off of your back end device for
the same types of reasons.

This change just adds an additional check in the SF driver so that
we are querying the back end device for the ID and the name_id.

This way we make sure if the volume is on our device we clean it up.

Change-Id: I60f8e8864f236fb92dd03560576377f1a0bdd82b
Closes-Bug: #1733967
"
openstack%2Fcinder~master~Ia3623af2048d6cbda65deebf4404e6b5fefe1bfc,openstack/cinder,master,bug/1731992,Ia3623af2048d6cbda65deebf4404e6b5fefe1bfc,qemu-img info --force-share for NFS driver,MERGED,2017-11-09 19:16:57.000000000,2018-02-25 14:55:57.000000000,2017-12-19 02:06:30.000000000,76,24,0,518782,524a74c6babd300c06f92fdc460bc568089435b0,104,40,4,7,4523,Eric Harney,eharney,"qemu-img info --force-share for NFS driver

NFS initialize_connection fails due to new locking
code in qemu-img info.  Bug 1718133 tracked a related issue.

Fix the NFS driver to work with the new version of
qemu-img info by disabling locking for qemu-img info
queries during initialize_connection and create_snapshot.

Closes-Bug: #1731992
Change-Id: Ia3623af2048d6cbda65deebf4404e6b5fefe1bfc
"
openstack%2Fcinder~master~Ib0ab0319e04e23e93f31a49bca17ed30af2474d0,openstack/cinder,master,api-ref-host-format,Ib0ab0319e04e23e93f31a49bca17ed30af2474d0,API ref: add host format to description,MERGED,2017-12-13 10:12:31.000000000,2018-02-25 14:55:39.000000000,2017-12-25 22:22:19.000000000,4,2,0,527659,69b4a3c9ab25165b93fb0668d0097535404e2fd0,34,26,1,2,13636,aarefiev,aarefiev,"API ref: add host format to description

Specify host and os-vol-host-attr:host parameters format.

Change-Id: Ib0ab0319e04e23e93f31a49bca17ed30af2474d0
"
openstack%2Fcinder~master~I37937c1ebe4a10b896f1deb77f64b520ceba2830,openstack/cinder,master,ut_slowest,I37937c1ebe4a10b896f1deb77f64b520ceba2830,Add output of slowest tests to UT runs,MERGED,2017-12-11 16:26:41.000000000,2018-02-25 14:55:36.000000000,2017-12-12 23:40:28.000000000,1,0,0,527149,6d366292941ef77d32f42b56868750dbf331fc95,46,27,1,1,11904,Sean McGinnis,SeanM,"Add output of slowest tests to UT runs

With the switch to stestr we lost the automatic output of the slowest
tests. We can still get that output, but it is a separate command to
run after the tests. Add that to our tox.ini command for test execution.

Change-Id: I37937c1ebe4a10b896f1deb77f64b520ceba2830
"
openstack%2Fcinder~master~I0ffc5da37d342b722098ea36e11e269c3ae463b3,openstack/cinder,master,bug/1737131,I0ffc5da37d342b722098ea36e11e269c3ae463b3,Updates Help Text on Quobyte Volume URL Option,MERGED,2017-12-08 13:31:44.000000000,2018-02-25 14:55:34.000000000,2017-12-09 01:58:57.000000000,2,1,4,526671,4ca4f644008f4c89edc472cacda19050367ba54a,38,32,3,1,13915,Silvan Kaiser,kaisers,"Updates Help Text on Quobyte Volume URL Option

This microchange updates the quobyte_volume_url option help text to
point out that using a DNS SRV record is the best solution for this
config option.

Change-Id: I0ffc5da37d342b722098ea36e11e269c3ae463b3
"
openstack%2Fcinder~master~I614c0866f52503ed7264f7bf74a193dd17590028,openstack/cinder,master,volume_manage_discripancy,I614c0866f52503ed7264f7bf74a193dd17590028,Fix discrepancy in api-ref for create volume manage api,MERGED,2017-12-07 09:36:49.000000000,2018-02-25 14:55:33.000000000,2017-12-10 16:35:50.000000000,23,3,0,526326,0548a4172e3d9f2794f4d8d54d7be248b81f8c92,36,32,1,2,26541,Neha Alhat,nehaalhat,"Fix discrepancy in api-ref for create volume manage api

For create volume manage api, 'bootable', 'name', and 'metadata'
parameters are mandatory as per api ref document but as per code
these parameters are optional.

This patch fixes this discrepancy by updating the api-ref according
to the code.

Change-Id: I614c0866f52503ed7264f7bf74a193dd17590028
"
openstack%2Fcinder~master~I0dde39ec96b04e497553b07a07acb95039ee5959,openstack/cinder,master,bp/json-schema-validation,I0dde39ec96b04e497553b07a07acb95039ee5959,V3 jsonschema validation: Group types,MERGED,2017-11-14 12:58:37.000000000,2018-02-25 14:55:30.000000000,2017-12-06 12:43:08.000000000,86,41,3,519643,f71b7063c119197a030821030960d79fd5832cd7,109,40,4,4,24645,Pooja Jadhav,poojajadhav,"V3 jsonschema validation: Group types

This patch adds jsonschema validation for below Group types API's
* POST /v3/{project_id}/group_types
* PUT  /v3/{project_id}/group_types/{group_type_id}

Made changes to unit tests to pass body as keyword argument as wsgi
calls action method [1] and passes body as keyword argument.

[1] https://github.com/openstack/cinder/blob/master/cinder/api/openstack/wsgi.py#L997

Change-Id: I0dde39ec96b04e497553b07a07acb95039ee5959
Partial-Implements: bp json-schema-validation
"
openstack%2Fcinder~master~Ie6a8136835550d1cec1bc0ccd9c30c83e59580d4,openstack/cinder,master,bug/1735674,Ie6a8136835550d1cec1bc0ccd9c30c83e59580d4,Pass in the parameters multipath when migrating volume,MERGED,2017-12-01 09:10:40.000000000,2018-02-25 14:55:28.000000000,2017-12-12 21:39:40.000000000,4,1,0,524536,a045c0f28a31231fc31dc3f4452b19f3cee3cd4f,60,36,1,1,20146,yuyafei,yuyafei,"Pass in the parameters multipath when migrating volume

When multipath is enabled, we do not pass in parameters
multipath when migrating volume.

Change-Id: Ie6a8136835550d1cec1bc0ccd9c30c83e59580d4
Closes-Bug: #1735674
"
openstack%2Fcinder~master~I30817ae767e08c45f9540b19e922864fe2f7a9c2,openstack/cinder,master,504135,I30817ae767e08c45f9540b19e922864fe2f7a9c2,Tests: Fix Storwize hash randomization failure,MERGED,2017-09-14 17:18:12.000000000,2018-02-25 14:54:35.000000000,2017-12-06 12:43:15.000000000,11,0,0,504135,6b34450786aa50eb05e6bf3d0022f0c0b6404e86,54,33,2,1,4523,Eric Harney,eharney,"Tests: Fix Storwize hash randomization failure

Some fields tested here are lists that are generated
from dicts, and can therefore be in any order.

Change-Id: I30817ae767e08c45f9540b19e922864fe2f7a9c2
"
openstack%2Fcinder~master~I2a7440789753bb0e42ac0e8d0190b21652a87e2f,openstack/cinder,master,bp/qnap-enhance-support,I2a7440789753bb0e42ac0e8d0190b21652a87e2f,Add support for enhanced features to the QNAP Cinder driver,MERGED,2017-06-02 08:04:46.000000000,2018-02-25 14:54:30.000000000,2017-12-09 20:58:50.000000000,256,135,25,470188,08dcf03541995cc9f8a22232bf738967e4b6570b,394,65,11,3,20361,Pony Chou,ponychou,"Add support for enhanced features to the QNAP Cinder driver

This adds enhanced supports to the QNAP Cinder driver:
 - CHAP
 - Thin Provision
 - SSD Cache
 - Dedupe
 - Compression

DocImpact
Implements: blueprint qnap-enhance-support

Change-Id: I2a7440789753bb0e42ac0e8d0190b21652a87e2f
"
openstack%2Fcinder~stable%2Fpike~I1f72a8567faa78fec447b9e0a6f948514b43a864,openstack/cinder,stable/pike,,I1f72a8567faa78fec447b9e0a6f948514b43a864,VMAX driver - concurrently deleting volumes can fail,MERGED,2017-11-28 16:42:50.000000000,2018-02-25 14:54:14.000000000,2017-12-13 17:33:44.000000000,16,7,0,523462,5b6b43078b5694601b2c5316b8ea3b2b58ac7130,28,17,1,2,12670,Helen Walsh,walshh2,"VMAX driver - concurrently deleting volumes can fail

When concurrently deleting volumes, sometimes the task fails leaving
the volume in an 'error_deleting' state. This only occurs when
image_volume_cache_enabled is True because a temp snapvx session is
created. This same issue also occurs when there is a batch delete
of snapshots from the same source volume. The fix locks the delete
snapvx session using the source DeviceID as key.

Change-Id: I1f72a8567faa78fec447b9e0a6f948514b43a864
Closes-Bug: #1714922
(cherry picked from commit 209e1564df3dcbb3426799e0010bd94973acbcda)
"
openstack%2Fcinder~master~I8747b56804704da07bc29b9680c57bc172693994,openstack/cinder,master,521619,I8747b56804704da07bc29b9680c57bc172693994,Add cleanup to TestCase.flags(),MERGED,2017-11-20 18:07:15.000000000,2018-02-25 14:54:13.000000000,2017-11-27 19:01:33.000000000,1,1,1,521619,4bbe4dae8451071f336cfdff2699b13091782e93,62,36,2,1,4523,Eric Harney,eharney,"Add cleanup to TestCase.flags()

Prior to change 43a31525, this method was installing
a cleanup method to reset the changed config values
after the test was run.

It should still do that to prevent conf changes in one
test from interfering with other tests.

Change-Id: I8747b56804704da07bc29b9680c57bc172693994
"
openstack%2Fcinder~master~I3308bdedbfe3bb83d695d38667eaea6327fa4461,openstack/cinder,master,bp/datacore-volume-driver,I3308bdedbfe3bb83d695d38667eaea6327fa4461,Adds DataCore Volume Drivers,MERGED,2017-02-08 11:53:45.000000000,2018-02-25 14:54:06.000000000,2017-12-05 02:47:16.000000000,5252,0,95,430858,747efde4709d7aa00f5d13d98d0036639e612945,274,66,10,18,22878,Michael Latchmansingh,mlatchmansingh.datacore,"Adds DataCore Volume Drivers

The iSCSI and Fibre Channel volume drivers for DataCore’s
SANsymphony and Hyper-converged Virtual SAN storage
support the core/minimum feature set:
 - Volume Create/Delete
 - Volume Attach/Detach
 - Snapshot Create/Delete
 - Create Volume from Snapshot
 - Get Volume Stats
 - Copy Image to Volume
 - Copy Volume to Image
 - Clone Volume
 - Extend Volume

DocImpact
Implements: blueprint datacore-volume-driver

Change-Id: I3308bdedbfe3bb83d695d38667eaea6327fa4461
"
openstack%2Fcinder~master~Ie75b6b135610a8bb206a6f941721d5e97f6db502,openstack/cinder,master,bug/1733480,Ie75b6b135610a8bb206a6f941721d5e97f6db502,Remove DB authorisation checking with quota API operations.,MERGED,2017-11-21 04:46:50.000000000,2018-02-25 14:54:05.000000000,2017-11-22 02:46:09.000000000,12,23,1,521712,93b1d86f6d158a156e7bd2e43f5de84587bb5e6d,59,31,2,4,3031,Sam Morrison,sorrison,"Remove DB authorisation checking with quota API operations.

This is now handled completely in policy.

Change-Id: Ie75b6b135610a8bb206a6f941721d5e97f6db502
Closes-Bug: #1733480
"
openstack%2Fcinder~master~Icfde885384d174dbf9b211faca3f31be0b41f232,openstack/cinder,master,bug/1733632,Icfde885384d174dbf9b211faca3f31be0b41f232,Fix policy documentation for os-show_image_metadata endpoint,MERGED,2017-11-21 16:05:10.000000000,2018-02-25 14:53:55.000000000,2017-12-07 08:56:26.000000000,0,4,0,521915,52576bbbc89af0842b2c7bda2bc4b0d6214bccbb,66,42,1,1,23186,Felipe Monteiro,felipe.monteiro,"Fix policy documentation for os-show_image_metadata endpoint

The policy documentation for os-show_image_metadata endpoint
is inconsistent with the implementation.

In policy documentation, the endpoint is listed as enforcing
""volume_extension:volume_image_metadata"": [0]

But in the code it is clear that no policy enforcement is performed: [1]

This PS removes the os-show_image_metadata entry from the policy
documentation for consistency.

[0] https://github.com/openstack/cinder/blob/9fbf236dc17d67404e2ce9ced517182716d72e6f/cinder/policies/volume_metadata.py#L102
[1] https://github.com/openstack/cinder/blob/0cf910d4345c000e8c306b1cb2b2dd291975cf71/cinder/api/contrib/volume_image_metadata.py#L123

Change-Id: Icfde885384d174dbf9b211faca3f31be0b41f232
Closes-Bug: #1733632
"
openstack%2Fcinder~master~I9272f71e0e68268ad9f558ddd1e1183e3ea69806,openstack/cinder,master,bug/1728640,I9272f71e0e68268ad9f558ddd1e1183e3ea69806,Suppress UT log messages,MERGED,2017-11-20 14:59:05.000000000,2018-02-25 14:53:37.000000000,2017-11-20 19:36:58.000000000,17,31,1,521555,d0fab07245fec2629ffe11e81509037f96c98ff1,38,31,2,3,11904,Sean McGinnis,SeanM,"Suppress UT log messages

Large logger output during unit test run is causing subunit.parser
failures. Most of this output is unnecessary for unit tests, so we
should just suppress this logging.

Also switching oslo.context args from user and tenant to user_id
and project_id to get rid of deprecation warnings and move to new
expected attributes. The minimum version of oslo.context has been
raised to ensure we have a version with the renamed kwargs, so we
are safe changing this. Originally planned to change as its own
change in Iecee4cbd57ac319a02f9bfdf24e3742dbbcb3950, but it causes
enough log output in the unit tests that failures are preventing
either patch from going through without the other included.

Change-Id: I9272f71e0e68268ad9f558ddd1e1183e3ea69806
Partial-bug: #1728640
"
openstack%2Fcinder~master~If5fcdefaa10bfb00e60aa4559d3282d3c6a53752,openstack/cinder,master,bug/1732763,If5fcdefaa10bfb00e60aa4559d3282d3c6a53752,Update api-ref to include volume_image_metadata,MERGED,2017-11-16 19:04:38.000000000,2018-02-25 14:53:29.000000000,2017-11-21 02:04:04.000000000,20,0,2,520686,8cb4aedda6b44c6cacb37cf525e02e5f299af41d,85,31,5,4,8768,Chris Friesen,cbf123,"Update api-ref to include volume_image_metadata

The detailed information for a volume can include ""volume_image_metadata""
in the case where the volume was created from an image, or in the case
where the volume was created from a snapshot of such a volume.

Update the API ref to include the field so we accurately represent
the code.

Change-Id: If5fcdefaa10bfb00e60aa4559d3282d3c6a53752
Closes-Bug: #1732763
"
openstack%2Fcinder~stable%2Fpike~Ief6ff0771488417fc80a3ffe7505a0d478ec5eb6,openstack/cinder,stable/pike,,Ief6ff0771488417fc80a3ffe7505a0d478ec5eb6,Add .zuul.yaml with LIO job,MERGED,2017-11-16 15:27:34.000000000,2018-02-25 14:53:28.000000000,2017-11-20 19:37:03.000000000,122,0,0,520618,e633feee8a17d7d7278064280197eccdf5fd00a7,22,15,1,4,4523,Eric Harney,eharney,"Add .zuul.yaml with LIO job

This replaces the legacy-tempest-dsvm-full-lio job.

Skip tests that are currently failing.

Change-Id: Ief6ff0771488417fc80a3ffe7505a0d478ec5eb6
(cherry picked from commit 5601d336ca556c82891466c89cadef0676df576c)
"
openstack%2Fcinder~master~I6f80c766fed3a98d050290be179b91b218bedcef,openstack/cinder,master,add-gitignore-sample,I6f80c766fed3a98d050290be179b91b218bedcef,Add doc/source/_static/cinder.policy.yaml.sample to .gitignore,MERGED,2017-11-15 07:49:16.000000000,2018-02-25 14:53:27.000000000,2017-11-15 18:48:44.000000000,1,0,0,520001,f1cd25861b8d5ea392c1bb698134d296ac76e5a8,35,31,1,1,5689,Masayuki Igawa,igawa,"Add doc/source/_static/cinder.policy.yaml.sample to .gitignore

This commit adds doc/source/_static/cinder.policy.yaml.sample to
.gitignore which is created by sphinx build.

Change-Id: I6f80c766fed3a98d050290be179b91b218bedcef
"
openstack%2Fcinder~master~I96cd285a82b44af8818514692818e739443dcc45,openstack/cinder,master,bug/1699936,I96cd285a82b44af8818514692818e739443dcc45,Fix resource count for os-host show,MERGED,2017-06-23 02:42:40.000000000,2018-02-25 14:53:25.000000000,2017-11-16 02:26:39.000000000,148,33,27,476750,f50b3555773a1559e29c75ac48857b50cea8dfe5,344,56,11,8,15054,wangxiyuan,wangxiyuan,"Fix resource count for os-host show

os-host show API should only return the resouce count on the
specified host.
The logic in Cinder which counts the project's resouce on all host
is wrong.

Change-Id: I96cd285a82b44af8818514692818e739443dcc45
Closes-bug: #1699936
"
openstack%2Fcinder~master~Ifbb5248e3ad5bad4b8fb6957156540cdf97babde,openstack/cinder,master,bug/fix_request_spec_bug,Ifbb5248e3ad5bad4b8fb6957156540cdf97babde,Add missing 'obj_make_compatible' in RequestSpec object,MERGED,2017-11-13 06:40:43.000000000,2018-02-25 14:53:24.000000000,2017-11-16 19:33:42.000000000,12,0,0,519237,945a2754a92063688236d64a64c80253a5096ab2,31,27,1,1,23083,TommyLike,TommyLike,"Add missing 'obj_make_compatible' in RequestSpec object

RequestSpec is converted to OVO, thus need to add the
'obj_make_compatible' to support backward compatibility.

Change-Id: Ifbb5248e3ad5bad4b8fb6957156540cdf97babde
"
openstack%2Fcinder~master~Idd34cf25b6d146cb1228a31ec738c09bb73588fb,openstack/cinder,master,unity_trace,Idd34cf25b6d146cb1228a31ec738c09bb73588fb,Unity: Remove redundant debug logging,MERGED,2017-11-08 06:20:22.000000000,2018-02-25 14:53:23.000000000,2017-11-21 02:04:00.000000000,0,4,1,518456,b93f1ddf4e5ae6264581e420c53e880a93ec7454,74,38,1,1,11904,Sean McGinnis,SeanM,"Unity: Remove redundant debug logging

Remove cases where tracing decorated methods called tracing decorated
methods that performed debug logging to reduce duplication of the
same data in the logs.

Change-Id: Idd34cf25b6d146cb1228a31ec738c09bb73588fb
"
openstack%2Fcinder~driverfixes%2Focata~I02f79a1ccc1af29e1f843e94c0618c8e4962bdae,openstack/cinder,driverfixes/ocata,bug/1692775,I02f79a1ccc1af29e1f843e94c0618c8e4962bdae,Fix backup compression unit tests,MERGED,2017-11-07 11:53:33.000000000,2018-02-25 14:53:21.000000000,2017-11-13 07:09:48.000000000,3,3,0,518305,0f20809828e5d56b4b22861d49dde485abf2c1dc,15,9,1,3,9535,Gorka Eguileor,Gorka,"Fix backup compression unit tests

Cinder backup tests for compression were incorrectly testing the size of
the compression data, instead of testing against the compressed data
they were checking the tuple (algorithm, compressed_data).

This patches fixes those tests.

Change-Id: I02f79a1ccc1af29e1f843e94c0618c8e4962bdae
(cherry picked from commit fd671c77cd93e8a5a5bafbee7f24564fb780a044)
(cherry picked from commit 9d0658febea9a81e54afd62f37a6a9dfe3135797)
"
openstack%2Fcinder~master~I2e7acb3f407dab2a8c82191e13d491cdc71d279c,openstack/cinder,master,bug/1729793,I2e7acb3f407dab2a8c82191e13d491cdc71d279c,Improve cinder revert-to-snapshot notifications,MERGED,2017-11-03 08:35:14.000000000,2018-02-25 14:53:20.000000000,2017-11-11 00:38:05.000000000,8,4,15,517575,e11f07204255496c3b99adc2c88d24db7e303188,80,37,6,1,25169,Xiaojun Liao,wwba,"Improve cinder revert-to-snapshot notifications

The reverting were sending 'revert.end' message without a
corresponding 'revert.start' notification if creating backup
snapshot failed by an exception, so this patch fixes that.

Closes-Bug:#1729793

Change-Id: I2e7acb3f407dab2a8c82191e13d491cdc71d279c
Signed-off-by: Xiaojun Liao <xiaojunliao85@gmail.com>
"
openstack%2Fcinder~master~I3f95fd3b83d6b5c5801d3a16a3e73623ed49da29,openstack/cinder,master,test_log_setup,I3f95fd3b83d6b5c5801d3a16a3e73623ed49da29,Make test logging setup fixture disable future setup,MERGED,2017-10-31 20:06:33.000000000,2018-02-25 14:52:55.000000000,2017-11-04 07:34:05.000000000,11,0,1,516777,57321ad60c82d2113ff8fb6f60dfb85af85cea00,102,36,3,1,11904,Sean McGinnis,SeanM,"Make test logging setup fixture disable future setup

Our logging fixture sets up logging in a way that we need to capture
things during tests. However, some of our tests do things like call
back into main functions, which then call logging setup again, and
unwind everything we're doing (including debug message testing).

This patches out oslo_log setup after the fixture runs, thus ignoring
calls to it in the future.

This change originally implemented in Nova with commit
dc2f4f88ac8d7bcf904908b4683522cd6839ba70.

Closes-bug: #1728640
Change-Id: I3f95fd3b83d6b5c5801d3a16a3e73623ed49da29
"
openstack%2Fcinder~master~I5024642f8e3e6cd7d221dc3af367bba55fe56cf5,openstack/cinder,master,capability,I5024642f8e3e6cd7d221dc3af367bba55fe56cf5,HPE 3PAR: ISCSI/FC drivers – code refactoring,MERGED,2017-03-16 11:32:23.000000000,2018-02-25 14:52:46.000000000,2017-11-03 15:49:58.000000000,535,734,23,446475,8588aa5cf62ab1623fac0bb239280358ccc5ff49,820,73,30,5,21407,Kushal Wathore,kwathore,"HPE 3PAR: ISCSI/FC drivers – code refactoring

Issue:
=====
Redundant code was present for ISCSI and FC drivers with
the potential to maintenance issues.

Solution:
=======
Refactored code as below:
1.Made common as a base class for existing ISCSI and FC drivers.
2.Moved duplicate methods to the base class.
3.Incorporated template method pattern wherever applicable.

Change-Id: I5024642f8e3e6cd7d221dc3af367bba55fe56cf5
"
openstack%2Fcinder~master~I6bcdbd8343cca237c5f85077273a8ea18c6f534d,openstack/cinder,master,bug/1727248,I6bcdbd8343cca237c5f85077273a8ea18c6f534d,Fix migate_volume API with replication_status ‘not-capable’,MERGED,2017-10-25 09:36:18.000000000,2018-02-25 14:52:28.000000000,2017-10-29 23:17:57.000000000,16,1,4,514988,6b5ff682fe45eda12da666ff26126f573478b2f0,92,38,3,2,11186,yixuan zhang,yixuanzhang,"Fix migate_volume API with replication_status ‘not-capable’

When migrating a volume with replication_status = 'not-capable',
migrate_volume api will reject it because 'not-capable' isn't in
the replication_status expected list.
This patch fixes the issue by adding ‘not-capable’ to the expected
replication_status list.

Change-Id: I6bcdbd8343cca237c5f85077273a8ea18c6f534d
Closes-Bug: #1727248
"
openstack%2Fcinder~master~I1d924da3504861f027273d3319e5cf6c485d1d37,openstack/cinder,master,remove-comma,I1d924da3504861f027273d3319e5cf6c485d1d37,[TrivialFix] Remove errant comma in capabilities policies,MERGED,2017-10-26 03:08:38.000000000,2018-02-25 14:52:27.000000000,2017-10-28 03:19:25.000000000,1,1,0,515272,9d1d8ed852b329d9f9465218b516840f308c9340,89,36,1,1,23186,Felipe Monteiro,felipe.monteiro,"[TrivialFix] Remove errant comma in capabilities policies

Currently, the initialization of CAPABILITIES_POLICY is supposed
to be a string, but due to the comma at the end of the string literal
the type of CAPABILITIES_POLICY is actually a tuple, which is a bug.

Change-Id: I1d924da3504861f027273d3319e5cf6c485d1d37
"
openstack%2Fcinder~driverfixes%2Focata~Iee27c0368522c90525a4b8ad757f9fb89dc293a0,openstack/cinder,driverfixes/ocata,backport-migration-issue-to-O,Iee27c0368522c90525a4b8ad757f9fb89dc293a0,Fix a migration issue of Huawei driver,MERGED,2017-09-21 01:33:18.000000000,2018-02-25 14:52:26.000000000,2017-10-26 02:41:37.000000000,17,12,0,505900,f811487fca78d934b19baeb3e8aba3439d7e9db2,40,19,2,2,16203,zengyingzhe,zengyingzhe,"Fix a migration issue of Huawei driver

While migrating volume crossing backends by the host-based way,
after data copying is done, Huawei driver's update_migrated_volume
method doesn't return the provider_location property, which
results old and new volumes' provider_locations aren't swapped as
expected, afterwards, while deleting the old volume, new volume's
provider_location will be used and the if-volume-exist-check fails
because it verifies the new volume's LUN ID actually on the old
backend, which certainly doesn't exist.

This patch fixes this issue.

Change-Id: Iee27c0368522c90525a4b8ad757f9fb89dc293a0
(cherry picked from commit 011daa9b463043a15f9e97986ecce6233ac72de5)
"
openstack%2Fcinder~master~I94b32634396ab3acf19a70c6f3601edc67eedab1,openstack/cinder,master,,I94b32634396ab3acf19a70c6f3601edc67eedab1,Completely remove mox from Cinder unittest,MERGED,2017-10-24 12:54:01.000000000,2018-02-25 14:52:24.000000000,2017-10-27 00:19:42.000000000,41,47,0,514640,2359ee7c8a78c1b3b99063f09de3ae35a0a330c3,46,29,2,5,18320,Dao Cong Tien,TienDC,"Completely remove mox from Cinder unittest

This patch removes mox from the remaining unit tests and
the base class.

Change-Id: I94b32634396ab3acf19a70c6f3601edc67eedab1
"
openstack%2Fcinder~master~I129ca060a89275ffd56481b8f64367b0d803cff5,openstack/cinder,master,bp/remove-netapp-7mode-drivers,I129ca060a89275ffd56481b8f64367b0d803cff5,NetApp ONTAP: Remove support for 7mode systems,MERGED,2017-10-21 05:29:33.000000000,2018-02-25 14:52:22.000000000,2017-10-26 20:23:22.000000000,45,5127,1,513897,425f45a311dc78ff34a18ffea7dbf5bb6dd2d421,107,33,5,33,16643,Goutham Pacha Ravi,gouthamr,"NetApp ONTAP: Remove support for 7mode systems

The Unified Driver for NetApp Storage in Cinder
supports two families of ONTAP, 7mode and Clustered
Data ONTAP.

ONTAP 7 is now officially nearing the end-of-life
of product support. The deprecation notice [1]
for these drivers in Cinder was issued in the Newton
Release, so it is time to remove them from tree.

[1] http://lists.openstack.org/pipermail/openstack-operators/2016-November/011957.html

Implements: bp remove-netapp-7mode-drivers

Change-Id: I129ca060a89275ffd56481b8f64367b0d803cff5
"
openstack%2Fcinder~master~I6696a15cd2c8fbf851a59b8d6d60ae1981bb1b89,openstack/cinder,master,bug/1721837,I6696a15cd2c8fbf851a59b8d6d60ae1981bb1b89,Fix migration 112 to use live_data_migration API,MERGED,2017-10-06 18:07:57.000000000,2018-02-25 14:52:20.000000000,2017-10-24 17:53:42.000000000,100,36,27,510201,e88d3b2c8205a4865d64419623de10d9159eeea2,201,46,10,10,2243,John Griffith,john-griffith,"Fix migration 112 to use live_data_migration API

In the 112 db migration I was being lazy and generating and
updating the newly added UUID column.  I also didn't update
the Service object (left that for the follow on patch).

Turns out we're going to want/need the online_data_migration
pieces for some follow up work and we might as well do this at
least a little bit more efficiently/correctly now.

This patch modifies the db migration to NOT try and populate
the newly added UUID fields in the Service table, and it
updates the Service object properly including adding the gen UUID
components to service.create()

This also fixes up what we had in place for the online_data_migration
code in cmd/manage.py; note that we had a framework there/started but
it wasn't being used up to this point.

Change-Id: I6696a15cd2c8fbf851a59b8d6d60ae1981bb1b89
Closes-Bug: #1721837
"
openstack%2Fcinder~master~I9072e80f4e2817e48b4b5dd23790b727b3d7e4e4,openstack/cinder,master,vol_db_empty,I9072e80f4e2817e48b4b5dd23790b727b3d7e4e4,"Revert ""Move vol_db_empty to NFS driver""",MERGED,2017-10-11 20:03:17.000000000,2018-02-25 14:52:19.000000000,2017-10-18 22:10:00.000000000,24,35,0,511330,9778c5b04acb045dd41754af87da1b7b7eccb0a0,52,32,2,4,4523,Eric Harney,eharney,"Revert ""Move vol_db_empty to NFS driver""

This reverts commit 9b81659128f18239c682a407dcfc9766f0ad307d.

This was purposefully done in the volume manager
because otherwise it requires direct database access
from the driver, which is something we are better off
avoiding.

Change-Id: I9072e80f4e2817e48b4b5dd23790b727b3d7e4e4
"
openstack%2Fcinder~stable%2Fpike~I673b43f9ebe335ced4981af6c53b320a886438c8,openstack/cinder,stable/pike,bug/1715275-stable/pike,I673b43f9ebe335ced4981af6c53b320a886438c8,Storwize: add NPIV support,MERGED,2017-10-18 02:20:25.000000000,2018-02-25 14:52:05.000000000,2017-11-13 06:45:12.000000000,168,9,0,512915,b0abda576e3377d8c2f363b4570d3063291ff795,27,14,1,3,11186,yixuan zhang,yixuanzhang,"Storwize: add NPIV support

The Storwize/svc release 7.7.0.0 introduced an NPIV feature,
which when enabled provides for both virtual and physical wwpns.
The patch enables the storwize cinder driver to make use of the
virtual and physical wwpns that have been enabled for I/O
operations.

Change-Id: I673b43f9ebe335ced4981af6c53b320a886438c8
Closes-Bug: #1715275
(cherry picked from commit 8429fb53c0c3a89ba6508be913487a5d16b7ea52)
"
openstack%2Fcinder~master~I47d11a2f6423a76ca053abf075791ed70ee84b07,openstack/cinder,master,policy-and-docs-in-code,I47d11a2f6423a76ca053abf075791ed70ee84b07,"[policy in code] Add support for volume, volume type resources",MERGED,2017-10-12 09:01:46.000000000,2018-02-25 14:51:47.000000000,2017-10-19 06:22:17.000000000,1117,361,37,511427,a9e075021fe04b8de6c963d8e8d39c2869f5ed4b,84,34,4,38,23083,TommyLike,TommyLike,"[policy in code] Add support for volume, volume type resources

This patch adds policy in code support for volume
and volume type resources.

Change-Id: I47d11a2f6423a76ca053abf075791ed70ee84b07
Partial-Implements: blueprint policy-in-code
"
openstack%2Fcinder~master~Ic47f04e06b886656c9a0f0f7a0494a10fef93e80,openstack/cinder,master,bug/1723922,Ic47f04e06b886656c9a0f0f7a0494a10fef93e80,Make stringify header work under python2.,MERGED,2017-10-16 10:45:41.000000000,2018-02-25 14:51:46.000000000,2017-10-17 14:21:01.000000000,5,5,0,512259,04543abedd429101dc6b410090e463358d22ca48,45,33,2,1,17068,Jean-Philippe Evrard,evrardjp,"Make stringify header work under python2.

This fixes the following issue appearing during
cinder-manage db online_data_migrations.

Change-Id: Ic47f04e06b886656c9a0f0f7a0494a10fef93e80
Closes-Bug: #1723922
"
openstack%2Fcinder~master~I87a287f5db912e9aeaa401871178c49414098d06,openstack/cinder,master,bug/1696361,I87a287f5db912e9aeaa401871178c49414098d06,Fix backup-import error when the deleted record in the same db,MERGED,2017-09-12 07:05:47.000000000,2018-02-25 14:51:44.000000000,2017-10-19 10:00:38.000000000,9,5,2,502897,ea5e4f3945714c9c21ae27468288dea36ab4e07d,102,46,3,2,24564,qtlu,qtlu,"Fix backup-import error when the deleted record in the same db

If we revive the deleted backup record, cinder-api will raise a
DBDuplicateEntry error, this patch will allow user to import the deleted
record either in the same db or not.

Change-Id: I87a287f5db912e9aeaa401871178c49414098d06
Closes-Bug: #1696361
"
openstack%2Fcinder~master~I9a79b5ececc587e80129cc980930e168e805b139,openstack/cinder,master,policy-and-docs-in-code,I9a79b5ececc587e80129cc980930e168e805b139,[policy in code] Add support for backup resource,MERGED,2017-09-25 08:18:56.000000000,2018-02-25 14:51:39.000000000,2017-10-13 07:13:55.000000000,201,41,5,507015,1462d9c2e42775140cc228c90e49eea19e0b4458,210,48,8,8,23083,TommyLike,TommyLike,"[policy in code] Add support for backup resource

This patch adds policy in code support for backup
resources and depends on the basic patch [1].

[1]: https://review.openstack.org/#/c/506976/

Change-Id: I9a79b5ececc587e80129cc980930e168e805b139
Partial-Implements: blueprint policy-in-code
"
openstack%2Fcinder~stable%2Fpike~I8528752630276bd6e2348f27721238115de504cd,openstack/cinder,stable/pike,bug/1722326,I8528752630276bd6e2348f27721238115de504cd,Remove newton-compat upgrade code on service startup,MERGED,2017-10-10 05:52:50.000000000,2018-02-25 14:51:38.000000000,2017-10-12 03:16:28.000000000,29,145,0,510753,d0dc23fb77b8a7b0496313881434267b0091fb3c,29,17,1,2,7198,Jay Bryant,jsbryant,"Remove newton-compat upgrade code on service startup

This upgrade compat check code was marked for removal
in Ocata. Since we're now in Queens, and this is burning
time on every service start, let's remove it.

Change-Id: I8528752630276bd6e2348f27721238115de504cd
Related-Bug: #1722326
(cherry picked from commit 6c630c5e5383ea1cbd5475aad9826bbe2becf364)
"
openstack%2Fcinder~master~I0aaf2775d3fe1d54e64be3616a0a528e452cfa50,openstack/cinder,master,up_cli_quota_doc,I0aaf2775d3fe1d54e64be3616a0a528e452cfa50,Update tenant to project in cli quota doc,MERGED,2017-09-15 07:08:25.000000000,2018-02-25 14:51:31.000000000,2017-11-06 03:15:47.000000000,10,10,0,504353,55ac1ba1afaab3f82136ef91b33be5b0302329dc,57,35,2,1,25111,Dou Rui Yuan,rydou,"Update tenant to project in cli quota doc

Replace tenant with project and keep the descriptions consistent

Change-Id: I0aaf2775d3fe1d54e64be3616a0a528e452cfa50
"
openstack%2Fcinder~master~I7452bb2952459dca8cf0baf39fa76e0e39ad2ffd,openstack/cinder,master,bug/1722326,I7452bb2952459dca8cf0baf39fa76e0e39ad2ffd,Do not load extendable routes for the Versions router,MERGED,2017-10-09 18:35:15.000000000,2018-02-25 14:51:30.000000000,2017-10-10 02:43:43.000000000,4,0,0,510653,abeb81029026dd623f4b132fe6870af40cd97ed1,44,28,3,1,6873,Matt Riedemann,mriedem,"Do not load extendable routes for the Versions router

The Versions router is implicitly spending time loading
up extension routes on startup which is unnecessary since
the Versions router only cares about handling requests to
""/"" on the base endpoint.

Change-Id: I7452bb2952459dca8cf0baf39fa76e0e39ad2ffd
Partial-Bug: #1722326
"
openstack%2Fcinder~master~Ic4c7fd66858039db3f9d09a0babd5601b25a95e3,openstack/cinder,master,bug/1718762,Ic4c7fd66858039db3f9d09a0babd5601b25a95e3,Brocade: Add HTTP connection cleanup,MERGED,2017-10-03 21:35:16.000000000,2018-02-25 14:51:21.000000000,2017-10-09 03:12:26.000000000,5,1,2,509292,4dd33f7e502cd5e91bed78bfa62ee38bc5434697,140,37,3,1,8757,Angela Smith,asmith_brcd,"Brocade: Add HTTP connection cleanup

Method for get device mapping opens
connection to the switch but does not
close the connection.  Add finally
block to close the session.

Closes Bug: #1718762

Change-Id: Ic4c7fd66858039db3f9d09a0babd5601b25a95e3
"
openstack%2Fcinder~master~I48398331fe086760a88bd5ca4c0f28f90e22bd0b,openstack/cinder,master,bug/1720454,I48398331fe086760a88bd5ca4c0f28f90e22bd0b,Dell EMC PS: Fix extend volume creating unmanaged snapsots,MERGED,2017-10-02 21:27:53.000000000,2018-02-25 14:50:24.000000000,2017-10-09 23:38:58.000000000,8,2,10,509006,0910706e762cec88a2b53e82bd7e6a1c372163b9,85,41,4,2,10379,Rajini Karthik,rajinir,"Dell EMC PS: Fix extend volume creating unmanaged snapsots

The Dell EMC PS driver's extend volume code is missing the
no-snap option and creates unmanaged snapshots in the background.
Added that option to fix it.

Closes Bug: #1720454

Change-Id: I48398331fe086760a88bd5ca4c0f28f90e22bd0b
"
openstack%2Fcinder~master~I0c1593a72473f0db5fb8b5e4d436fee4c9f5c62a,openstack/cinder,master,bug/1716991,I0c1593a72473f0db5fb8b5e4d436fee4c9f5c62a,Doc: Configuration: Remove some outdated Ceph info,MERGED,2017-10-03 15:27:02.000000000,2018-02-25 14:50:10.000000000,2017-10-06 05:49:18.000000000,6,25,0,509207,e4dfc98378cfbf64745039b96ad5ddd140d1fffb,37,29,1,1,4523,Eric Harney,eharney,"Doc: Configuration: Remove some outdated Ceph info

A few small cleanups:
  - Remove irrelevant text about linux kernel
  - Remove recommendations about file systems
  - Remove outdated note about config option

Closes-Bug: #1716991
Change-Id: I0c1593a72473f0db5fb8b5e4d436fee4c9f5c62a
"
openstack%2Fcinder~stable%2Fpike~I78e552998e822fff37fb2c7cf890ebab65d9291f,openstack/cinder,stable/pike,bug/1698786-stable/pike,I78e552998e822fff37fb2c7cf890ebab65d9291f,Do not fail if RBD image is broken,MERGED,2017-10-02 13:10:11.000000000,2018-02-25 14:50:03.000000000,2017-10-05 08:57:20.000000000,32,2,0,508873,225618bf0ca38d70f45c1aa97acd491cce43e8a1,41,21,1,2,13636,aarefiev,aarefiev,"Do not fail if RBD image is broken

Change-Id: I78e552998e822fff37fb2c7cf890ebab65d9291f
Closes-Bug: #1698786
(cherry picked from commit 3e7b9ba546c8cac7bac2ed3d9d985cad0d166313)
"
openstack%2Fcinder~stable%2Fqueens~Id4cfb7771439940c59b828ea7f1d95bcfe7d1e26,openstack/cinder,stable/queens,bp/multi-attach-v3-attach,Id4cfb7771439940c59b828ea7f1d95bcfe7d1e26,Only enforce multiattach policy for retype target,MERGED,2018-02-20 02:29:17.000000000,2018-02-25 14:49:12.000000000,2018-02-20 16:26:50.000000000,5,1,0,546019,6fb0c066dc97ee46b9399a0049e60600165ecb4c,23,14,1,1,11904,Sean McGinnis,SeanM,"Only enforce multiattach policy for retype target

We should only be checking multiattach policy if the target
of a retype is multiattach capable. If they are already on
a type and policy has changed, we should not block retyping.

Change-Id: Id4cfb7771439940c59b828ea7f1d95bcfe7d1e26
(cherry picked from commit aea249f3604200ba329c260daed8b1259011f049)
"
openstack%2Fcinder~master~Ib0bdeeb01e35196ae862e3bf87e198b004f7403f,openstack/cinder,master,linkcheck,Ib0bdeeb01e35196ae862e3bf87e198b004f7403f,Modify broken link,MERGED,2018-01-22 09:12:03.000000000,2018-02-25 14:48:46.000000000,2018-02-21 19:37:36.000000000,2,2,2,536265,3b307ebe3e58efdd96499fb16e7bbaa8e7e85bb5,167,43,5,2,27386,gaofei,gaofei,"Modify broken link

Fix a couple dead links.

Change-Id: Ib0bdeeb01e35196ae862e3bf87e198b004f7403f
"
openstack%2Fcinder~stable%2Fpike~I4a59ed298ba2542dcb4d6787b47085749a34244e,openstack/cinder,stable/pike,rebase-logs-pike,I4a59ed298ba2542dcb4d6787b47085749a34244e,Improve logs on scheduler,MERGED,2018-02-13 12:16:37.000000000,2018-02-25 14:48:44.000000000,2018-02-17 11:53:00.000000000,33,7,1,543912,425dac98c3156a3e7bc0aa57db67b1477bd529c9,23,19,1,2,10058,Erlon R. Cruz,sombrafam,"Improve logs on scheduler

Scheduler decisions still not easy to track due lacking of information
about backends and pools. This adds more verbose information on that
so we can have a better means to help debug problems.

TrivialFix

Change-Id: I4a59ed298ba2542dcb4d6787b47085749a34244e
(cherry picked from commit 9c4cd4a2d75d36145f68e08d3aa28f9a45a68f48)
"
openstack%2Fcinder~stable%2Fqueens~I18a4bdf416f739b400e19e073ea7317034d2e211,openstack/cinder,stable/queens,create-queens,I18a4bdf416f739b400e19e073ea7317034d2e211,Update .gitreview for stable/queens,MERGED,2018-02-08 17:26:59.000000000,2018-02-25 14:48:27.000000000,2018-02-08 20:37:32.000000000,1,0,0,542336,d02b6894f50f07ebd6f4e424f2438e58c234630d,22,18,1,1,22816,OpenStack Release Bot,release,"Update .gitreview for stable/queens

Change-Id: I18a4bdf416f739b400e19e073ea7317034d2e211
"
openstack%2Fcinder~master~I1a1d02a1407926c22fbadcc1049434e24b92549b,openstack/cinder,master,bug/1744005,I1a1d02a1407926c22fbadcc1049434e24b92549b,Use provider_id for SolidFire Volume lookups,MERGED,2018-01-18 18:56:09.000000000,2018-02-25 14:48:23.000000000,2018-02-08 00:09:24.000000000,73,55,2,535449,3b7a2ba47a2b711ff0f356788e41446a0f58bdca,74,38,2,2,2243,John Griffith,john-griffith,"Use provider_id for SolidFire Volume lookups

Over the years the various iterations of volume-get in the SolidFire
driver has gotten a bit redundant.  The biggest problem with all of
these changes comes in when we start dealing with things like managed
volumes, most of the methods we have in place expect the volume-name
on the SolidFire backend to match the cinder UUID.

In the case of manage, migrate and some other cases however, this
isn't a valid assumption.  SolidFire doesn't allow changing the name
of an existing volume.  You're only choice in that case is to clone
or copy to a new volume, but that's terribly heavy weight in this case.

So, what we need to do is harden the volume_get method a bit.  We
want to do a better job here, first by attempting to use the provider_id
info that's stored with a volume, from there we can try some failback
methods like looking for name:uuid map and finally checking attributes.

This should make things much more efficient for delete calls, and fix
the current bug due to imported volumes not having the cinder-uuid as
the name.

We need to do some follow up work and consolidate all of these get calls,
but for now we just fix the recently reported bug.

Change-Id: I1a1d02a1407926c22fbadcc1049434e24b92549b
Closes-Bug: #1744005
"
openstack%2Fcinder~master~Id9905728f0f68df2847b7b71cb76d89a205deea0,openstack/cinder,master,wronggramar,Id9905728f0f68df2847b7b71cb76d89a205deea0,Fix wrong grammar,MERGED,2018-01-31 09:37:04.000000000,2018-02-25 14:47:57.000000000,2018-02-02 05:51:50.000000000,1,1,0,539475,23d657d357fd752e9326510e151d55e4ab2cd986,34,29,1,1,27346,chenxiangui,chenxiangui,"Fix wrong grammar

Modify 'should has' to 'should have'

Change-Id: Id9905728f0f68df2847b7b71cb76d89a205deea0
"
openstack%2Fcinder~driverfixes%2Fnewton~I2099b804a2043078e50a5a9e14c1497861576f61,openstack/cinder,driverfixes/newton,bug/1720147,I2099b804a2043078e50a5a9e14c1497861576f61,Kaminario K2: Support duplicated FQDN in network,MERGED,2017-11-24 06:54:43.000000000,2018-02-25 14:47:50.000000000,2018-01-31 01:48:16.000000000,44,2,0,522722,c527e89be9f5ec5c9ca66590b25659c8e191facc,44,22,2,3,16258,nikesh,nikem,"Kaminario K2: Support duplicated FQDN in network

The Kaminario K2 driver uses the FQDN of the node that is doing the
attach as an unique identifier to map the volume.

The problem is that the FQDN is not always unique, there are
environments where the same FQDN can be found in different systems, and
in those cases if both try to attach volumes the second system will
fail.

One example of this happening would be on a QA environment where you are
creating VMs and they all have names like controller-0.localdomain and
compute-0.localdomain.

This patch adds a configuration option to the K2 driver called
`unique_fqdn_network` to support these kind of environments.

Closes-Bug: #1720147
Change-Id: I2099b804a2043078e50a5a9e14c1497861576f61
(cherry picked from commit baa8626eac9c975b719c03274d42b54ce3de74fe)
"
openstack%2Fcinder~driverfixes%2Focata~Iddf2908ab28825a9082989cb1392ba59379f4bf5,openstack/cinder,driverfixes/ocata,bug/1745183,Iddf2908ab28825a9082989cb1392ba59379f4bf5,VMAX driver Ocata - backward compatibility fix,MERGED,2018-01-24 16:57:18.000000000,2018-02-25 14:47:43.000000000,2018-02-02 05:35:51.000000000,56,7,0,537454,043d7e21f06c1b938c3caf625ee849d2b9530abc,24,17,2,4,12670,Helen Walsh,walshh2,"VMAX driver Ocata - backward compatibility fix

Launchpad 1401297 breaks backward compatibility with Newton. This
fixes the issue by checking for the existence of the uuid within
the ElementName rather than a full equality check

Change-Id: Iddf2908ab28825a9082989cb1392ba59379f4bf5
Closes-Bug: #1745183
"
openstack%2Fcinder~stable%2Fpike~I677a8e39de4292fe4fa8e70d7b6ae2fc3d5cf2ac,openstack/cinder,stable/pike,bug/1743461,I677a8e39de4292fe4fa8e70d7b6ae2fc3d5cf2ac,Fix Backup uses latest req-id for all log calls,MERGED,2018-01-23 23:03:28.000000000,2018-02-25 14:47:23.000000000,2018-01-26 12:41:06.000000000,5,1,0,537001,06fb04a040db7a90f19fea8d3b928fbba5cf9582,22,18,1,1,9535,Gorka Eguileor,Gorka,"Fix Backup uses latest req-id for all log calls

Currently all log entries will have the request ID of the latest request
that was received in the Backup service.

So you would receive a request with ID 1 and you would start logging
that thread log calls with its ID, but as soon as you receive another
request, let's say with ID 2, you will have both request logging with ID
2 instead of each one logging with its own request ID.

The reason for this is that we are monkey patching after we have
imported OSLO logging and we should be doing the monkey patching before,
because OSLO logging imports OSLO context, which in turn imports
threading and defines the _request_store where the context is stored as
threading.local, which is not the monkey patched version and therefore
will be shared among all the greenthreads that share the same python
thread.

To fix this we just move the monkey patching earlier in the imports.

Closes-Bug: #1743461
Change-Id: I677a8e39de4292fe4fa8e70d7b6ae2fc3d5cf2ac
(cherry picked from commit 1a569e15c35d772a8ca236d75cd1840a415983d3)
"
openstack%2Fcinder~master~Ib15a4c06f80dfcfaff2f195ecf0f3afbfb5bfa0b,openstack/cinder,master,533813,Ib15a4c06f80dfcfaff2f195ecf0f3afbfb5bfa0b,Add contributor notes on how to use pdb with tests,MERGED,2018-01-15 22:57:07.000000000,2018-02-25 14:47:21.000000000,2018-01-24 02:40:00.000000000,28,0,6,533813,ad397b4dd7e579a71759617e879bbf948d9f9ce9,61,36,2,1,4523,Eric Harney,eharney,"Add contributor notes on how to use pdb with tests

Change-Id: Ib15a4c06f80dfcfaff2f195ecf0f3afbfb5bfa0b
"
openstack%2Fcinder~stable%2Fpike~Ibfd6f40e8b8ab88d4ec76e9ac27617a0f97b6c29,openstack/cinder,stable/pike,bug/1744383-stable/pike,Ibfd6f40e8b8ab88d4ec76e9ac27617a0f97b6c29,Move disk space check to run when needed,MERGED,2018-01-22 18:26:38.000000000,2018-02-25 14:47:18.000000000,2018-01-27 15:28:57.000000000,24,30,0,536529,0e57f89b8b0e3ed39c7fe59ee9b4e5cf3b8711b6,37,23,1,2,1004,Mohammed Naser,mnaser,"Move disk space check to run when needed

At the moment, the check for disk space when booting from an image
currently happens regardless if the backend supports cloning or not.

This means that even if a backend can clone the image directly, the
control plane must have enough disk to download the entire image
which can be unreasonable in backend such as RBD.

This patch moves the code which checks for enough disk space to be
in the same function that effectively downloads the image, ensuring
that it only runs when an image has to be downloaded and avoiding
the check if the backend successfully cloned the image.

Closes-Bug: #1744383
Change-Id: Ibfd6f40e8b8ab88d4ec76e9ac27617a0f97b6c29
(cherry picked from commit f62f8abad17d1c287d48ea273ea4c4fe7f536d07)
"
openstack%2Fcinder~master~I5054f348f9c016d15b36b9f18d9c89e19e25e81f,openstack/cinder,master,volume-encryption-doc,I5054f348f9c016d15b36b9f18d9c89e19e25e81f,Update Volume Encryption Documentation,MERGED,2018-01-19 16:58:23.000000000,2018-02-25 14:47:14.000000000,2018-01-22 22:09:49.000000000,3,3,0,535850,56b62f9423292c5e802d5f1b545f46e80c7c447f,27,22,1,2,7012,Brianna Poulos,brianna-poulos,"Update Volume Encryption Documentation

The castellan library has recently been updated to
use 'backend' instead of 'api_class' to configure
the backend that should be used.  This change updates
the volume encryption documentation to use the updated
configuration option instead of the deprecated one.

Change-Id: I5054f348f9c016d15b36b9f18d9c89e19e25e81f
"
openstack%2Fcinder~master~Id0aea58f7091c78fcd38a47e475384807f1c04c7,openstack/cinder,master,bug/1741476,Id0aea58f7091c78fcd38a47e475384807f1c04c7,Fix readonly mode for new attachment API calls,MERGED,2018-01-10 22:03:03.000000000,2018-02-25 14:47:13.000000000,2018-01-19 11:40:38.000000000,27,0,0,532645,e69a6a5e0626177c70ed0eafa3be6a45fbfb3f05,80,33,3,3,2243,John Griffith,john-griffith,"Fix readonly mode for new attachment API calls

The introduction of the new attachment API's doesn't
know how to deal with RO volumes that don't use the
connector to set their values.

One of the ways to do RO volumes in cinder is to set
a parameter in the admin_metadata of the volume.  If
this is set, we expect the connector to have a matching
mode setting in it's parameters.  During finalizing of
an attachment this values are compared and if they don't
match the attach fails.

The New attachment calls from the Nova side don't set
this information; and honestly using the connector for
this isn't such a great idea anyway.  To address this
change in behavior/bug however we'll default to the
settings of the volume admin_metadata.

When an attachment is created, we'll check the volumes
admin_metadata and set the attach_mode of the attach
object to ro if required.  Additionally, when the
attachment-completion is performed in the manager, we'll
use the attach_mode setting of the attachment object to
override and force any settings in the connector.

This seems like a better option than forcing Nova to check
and set based on the metadata, and there's no real value
in having an extra lever or requirement during attach that
can go wrong.  There's no case where seting the admin_metadata
to Read Only on a volume and attaching it any other way than
'ro' is valid, so just use the metdata directly.

Going forward we deprecate the use of admin_metadata for
Read Only settings and replace it with an attachment-create
option.

Closes-Bug: # 1741476

Change-Id: Id0aea58f7091c78fcd38a47e475384807f1c04c7
"
openstack%2Fcinder~master~Ie64af4305605717af01f903b05352e2480569d25,openstack/cinder,master,openstack/requirements,Ie64af4305605717af01f903b05352e2480569d25,Updated from global requirements,MERGED,2018-01-12 02:56:12.000000000,2018-02-25 14:47:05.000000000,2018-01-17 00:20:24.000000000,5,5,0,533040,91d6ea9bd535d6ebbc36929f05bb7b2a02f5f55f,86,31,6,2,11131,OpenStack Proposal Bot,proposal-bot,"Updated from global requirements

Change-Id: Ie64af4305605717af01f903b05352e2480569d25
"
openstack%2Fcinder~master~Id5d5f5ed8b449c9f1059528de241417f231f90b5,openstack/cinder,master,bug/1742940,Id5d5f5ed8b449c9f1059528de241417f231f90b5,Fix combination of parameters for update APIs,MERGED,2018-01-16 11:47:01.000000000,2018-02-25 14:47:04.000000000,2018-01-18 20:40:46.000000000,99,14,4,534244,2b2ed02fe531313a6a98673534b97f53a9f00edc,75,36,2,6,26541,Neha Alhat,nehaalhat,"Fix combination of parameters for update APIs

For group_type and volume_type update APIs, If user passes
description or is_public parameter in the request body then name
can be null. But after schema validation [1][2], it is failing with
BadRequest.

This patch allows users to pass 'name' as None if ""description""
or is_public"" parameter is passed in the request body.

[1]: https://review.openstack.org/#/c/520561/
[2]: https://review.openstack.org/#/c/519643/

Change-Id: Id5d5f5ed8b449c9f1059528de241417f231f90b5
Closes-Bug: #1742940
"
openstack%2Fcinder~master~Ib11bda868085dfed0ab0e9018b8ed35956dbdf10,openstack/cinder,master,bug/1741833,Ib11bda868085dfed0ab0e9018b8ed35956dbdf10,Revert volume consumed capacity when rescheduling,MERGED,2018-01-05 09:41:39.000000000,2018-02-25 14:46:56.000000000,2018-01-17 01:30:40.000000000,33,2,2,531345,4bc11505be0b064185ce1173a70706abb51f4353,105,38,2,3,23083,TommyLike,TommyLike,"Revert volume consumed capacity when rescheduling

Cinder scheduler will consume pool capacity repeatedly
when rescheduling creating request.

Closes-Bug: #1741833
Change-Id: Ib11bda868085dfed0ab0e9018b8ed35956dbdf10
"
openstack%2Fcinder~driverfixes%2Fmitaka~Ib68d65ef49c880047768b16241f49afae2dd802f,openstack/cinder,driverfixes/mitaka,,Ib68d65ef49c880047768b16241f49afae2dd802f,Re-enable unit tests,MERGED,2018-01-11 20:50:52.000000000,2018-02-25 14:46:50.000000000,2018-01-18 04:52:22.000000000,1,1,0,532970,1f77ceb5e6e5aa7c8bf6d17d1d0a81e424e031cf,30,11,3,1,4523,Eric Harney,eharney,"Re-enable unit tests

Run unit tests normally.

Change-Id: Ib68d65ef49c880047768b16241f49afae2dd802f
"
openstack%2Fcinder~driverfixes%2Fmitaka~Iaae29d3a48da3e849e558894a2d707be90294551,openstack/cinder,driverfixes/mitaka,532556,Iaae29d3a48da3e849e558894a2d707be90294551,Fix requirements.txt reference / disable tests,MERGED,2017-11-27 15:36:24.000000000,2018-02-25 14:46:39.000000000,2018-01-12 05:56:39.000000000,2,2,0,523149,cdac4d9da0ae6af0e0d190484a9cc8a9aec67c71,43,14,5,1,4523,Eric Harney,eharney,"Fix requirements.txt reference / disable tests

The URL for requirements.txt must now point to
mitaka-eol rather than stable/mitaka.

NOTE: this change allows unit tests to pass
regardless of their actual result.  This is
being done to get the driverfixes/mitaka branch
CI into working order.

Change-Id: Iaae29d3a48da3e849e558894a2d707be90294551
"
openstack%2Fcinder~driverfixes%2Focata~Ie6ec59b4f6d31cb72e37f25f5347c815fee5af48,openstack/cinder,driverfixes/ocata,bug/1739651,Ie6ec59b4f6d31cb72e37f25f5347c815fee5af48,StorageCenter: Fix volume mapping for API v3.1,MERGED,2018-01-11 17:30:13.000000000,2018-02-25 14:46:37.000000000,2018-01-17 18:15:44.000000000,32,14,0,532919,6e4a924fe28e66afc122e22beb4d404d4aab738a,17,12,1,2,9535,Gorka Eguileor,Gorka,"StorageCenter: Fix volume mapping for API v3.1

Volume attachment fails on StorageCenter API v3.1 because the backend
instead of returning wwn or WWN as the key in the controller port it
returns wWN, thus preventing the driver from finding the mapping.

This patch adds support to any combination of upper and lower case of
the WWN key.

Closes-Bug: #1739651
Change-Id: Ie6ec59b4f6d31cb72e37f25f5347c815fee5af48
(cherry picked from commit b50e08bcd8618d9b7935b0245d8b764912c919be)
(cherry picked from commit 0652a58069af9e908d12dd1f1fac8b6a8a8c6c2a)
"
openstack%2Fcinder~stable%2Fpike~I60f8e8864f236fb92dd03560576377f1a0bdd82b,openstack/cinder,stable/pike,bug/1733967,I60f8e8864f236fb92dd03560576377f1a0bdd82b,Check for migrated UUID in SolidFire delete,MERGED,2017-12-18 21:50:19.000000000,2018-02-25 14:46:32.000000000,2018-01-18 15:12:41.000000000,24,28,0,528828,24825e932831286481f2eb610ac0ba3682c3f3ad,50,22,3,2,2243,John Griffith,john-griffith,"Check for migrated UUID in SolidFire delete

Migration of volumes kinda screws up the use of ID as the
reference to use for deleting volumes.

If a volume is migrated, the UUID (ID) gets swapped and no
longer matches the UUID the volume had when it was initially
created on the back end device.  The result is that deletion
of that volume fails on the back end because the handle to the
new UUID doesn't exist.

On the other hand, you also have to be careful in dealing with
and cleaning up volumes migrated off of your back end device for
the same types of reasons.

This change just adds an additional check in the SF driver so that
we are querying the back end device for the ID and the name_id.

This way we make sure if the volume is on our device we clean it up.

Change-Id: I60f8e8864f236fb92dd03560576377f1a0bdd82b
Closes-Bug: #1733967
(cherry picked from commit 0e6ee1b1df38059f338ebd93c605dfb51a93a8a5)
"
openstack%2Fcinder~stable%2Fpike~I4b8d99966f387f51c1125ba72c1ce149229a8bc0,openstack/cinder,stable/pike,flashsystem_hostmap-stable/pike,I4b8d99966f387f51c1125ba72c1ce149229a8bc0,FlashSystem: Add CMMVC6045E CLI error for multi-host mapping,MERGED,2018-01-04 20:26:55.000000000,2018-02-25 14:46:30.000000000,2018-01-18 23:14:13.000000000,72,13,0,531238,dda90fe573303ac8bf1a213f611cdcb9209b27da,47,20,1,2,27059,John Cates,jccates,"FlashSystem: Add CMMVC6045E CLI error for multi-host mapping

Add CMMVC6045E to list of CLI error codes indicating a multi-host
map was attempted without the '-force' parameter. Re-raise on
match failure to avert spurious success when an unexcepted CLI
error is emitted. Add good and bad-path testing for multi-host
map to test_flashsystem_map_vdisk_to_host

Change-Id: I4b8d99966f387f51c1125ba72c1ce149229a8bc0
Closes-Bug: #1723188
(cherry picked from commit 421837ab4a3244022ad8292ad1ef0de37e9de532)
"
openstack%2Fcinder~driverfixes%2Fnewton~Ib55b22009a496bae002bda94190d041519090c75,openstack/cinder,driverfixes/newton,,Ib55b22009a496bae002bda94190d041519090c75,3PAR: Get host from os-brick,MERGED,2018-01-03 08:32:06.000000000,2018-02-25 14:46:25.000000000,2018-01-22 22:09:55.000000000,21,12,0,530862,379024675e028d1635b3fac7af913274369a815c,30,17,2,2,24299,Govardhan Chintha,chinthagovardhan,"3PAR: Get host from os-brick

Driver create hosts from os-brick connector
so get hosts from os-brick connector instead of
volume.

Change-Id: Ib55b22009a496bae002bda94190d041519090c75
Closes-Bug: 1690244
(cherry picked from commit e7a5ae1eaea6fa5b0dfc58920773fadae7ba0a68)
(cherry picked from commit 7973f02e84702f5b22fc27ee0fcfcb79543f8d14)
"
openstack%2Fcinder~master~Ib6751fae6b5fb78de98a2ea62f507f9102f71b76,openstack/cinder,master,cg_api,Ib6751fae6b5fb78de98a2ea62f507f9102f71b76,Deprecate CG APIs,MERGED,2017-12-10 17:46:47.000000000,2018-02-25 14:45:35.000000000,2017-12-25 23:54:01.000000000,28,4,4,526932,556ae86d382bc4bf9a4272884dd1f8ed5f694b4e,104,46,2,5,6491,xing-yang,xing-yang,"Deprecate CG APIs

This patch prints a deprecation message when CG APIs are used and
prompts users to swich to Generic Volume Group APIs instead. CG APIs
are also marked as deprecated in API reference docs. CG APIs will be
removed in a future release when it is appropriate and will be
decided by the Cinder team. This was communicated in Pike.

Change-Id: Ib6751fae6b5fb78de98a2ea62f507f9102f71b76
"
openstack%2Fcinder~master~I0f7b58751c6d8d05cad5b1b95c4e21c8b5d36692,openstack/cinder,master,bug/1731984,I0f7b58751c6d8d05cad5b1b95c4e21c8b5d36692,Update tgt iSCSI target on volume extend,MERGED,2017-12-21 08:09:50.000000000,2018-02-25 14:45:32.000000000,2018-01-04 05:59:45.000000000,33,3,6,529500,d96b6dfba03424baf8b3ddc7539347554892e941,61,39,3,5,11904,Sean McGinnis,SeanM,"Update tgt iSCSI target on volume extend

When extending an in-use volume, the volume will be extended but
the target exposing the volume will still report the original size.

The target needs to be updated to pick up the change, but since it
is in-use the update must be forced. This can cause IO disruption
if there is active IO to the target, however retries will cause the
next attempt to succeed and there will just be a few second IO
pause on the host while the target session is reestablished. Not
ideal, but it does recover with minimal impact on the host.

And operators probably shouldn't extend volumes without pausing
active IO to the volume anyway.

See bug report comments for more testing details. Marking this as
partial as it only addresses the tgt target and further
investigation is needed to see if the other target drivers need
similar updates.

Change-Id: I0f7b58751c6d8d05cad5b1b95c4e21c8b5d36692
Partial-bug: #1731984
"
openstack%2Fcinder~master~I11839fbeec4d9b7adf4255ea237848984350386e,openstack/cinder,master,bug/1731393,I11839fbeec4d9b7adf4255ea237848984350386e,Remove unused sf_enable_volume_mapping conf option,MERGED,2017-12-20 18:40:12.000000000,2018-02-25 14:45:31.000000000,2017-12-25 19:52:27.000000000,0,8,0,529396,88b7963fa94db08c767d0559a322050c583c12ae,36,31,1,2,2243,John Griffith,john-griffith,"Remove unused sf_enable_volume_mapping conf option

The SolidFire driver has a stale config option that's no longer used
anywhere (sf_enable_volume_mapping).

This patch removes that unused variable.

Change-Id: I11839fbeec4d9b7adf4255ea237848984350386e
Closes-Bug: #1731393
"
openstack%2Fcinder~master~I5ff95ca13f02ed6e0afb35f0d6bb5c36d4111f5a,openstack/cinder,master,goal-split-tempest-plugins,I5ff95ca13f02ed6e0afb35f0d6bb5c36d4111f5a,Remove In-repo cinder tempest plugin,MERGED,2017-07-25 17:15:11.000000000,2018-02-25 14:45:29.000000000,2018-01-18 02:35:22.000000000,0,960,2,487144,bcec744c4513d4d5c88deff4f4b7832eadac2d5e,134,58,4,16,22259,Nishant Kumar,nishant.e.kumar,"Remove In-repo cinder tempest plugin

As part of Queens Goal ""Split Tempest Plugins into Separate
Repos/Projects"",the cinder tempest plugin needs to be split
into a separate project.
https://governance.openstack.org/tc/goals/queens/split-tempest-plugins.html

This patch removes the in-tree tempest plugin as well as the
setuptools entry point.

Change-Id: I5ff95ca13f02ed6e0afb35f0d6bb5c36d4111f5a
Depends-On: Ib309cb1f87211e82eae0d27fa2464ec13a9deca6
Implements: blueprint goal-split-tempest-plugin
"
openstack%2Fcinder~master~I581ffcd8e14ab10e054be05429ee0f6717e27015,openstack/cinder,master,bug/1737735_2,I581ffcd8e14ab10e054be05429ee0f6717e27015,VMAX doc - Queens feature documentation,MERGED,2017-12-19 15:40:52.000000000,2018-02-25 14:45:16.000000000,2017-12-26 04:00:01.000000000,237,118,0,529094,e7b940c3126f3be3022972f41268ed7fa82914ee,40,28,1,1,12670,Helen Walsh,walshh2,"VMAX doc - Queens feature documentation

Part 2 - New features documented are iSCSI CHAP Authentication
and deprecation of configuration XML file.

Change-Id: I581ffcd8e14ab10e054be05429ee0f6717e27015
Partial-Bug: #1737735
"
openstack%2Fcinder~master~I263c3f5201ac76773a9c962ec958f02f601c6adc,openstack/cinder,master,bug/1722736,I263c3f5201ac76773a9c962ec958f02f601c6adc,Raise PolicyNotAuthorized exception on consistency Group snapshot,MERGED,2017-10-11 09:47:41.000000000,2018-02-25 14:43:49.000000000,2017-12-20 00:53:53.000000000,36,5,16,511195,3f86310b44105b53846820d262d82091cf58f8f0,198,51,8,2,20050,MonicaJoshi,MonicaJoshi,"Raise PolicyNotAuthorized exception on consistency Group snapshot

In role based access control test case, a consistencyGroup snapshot
delete when attempted by Non-admin role/user does not return
an informative policy not authorized message.

The proposed fix catches the PolicyNotAuthorized exception
explicitly to raise the appropriate message and error code
to the caller method, includes a new unit test case.

Closes-bug:#1722736

Change-Id: I263c3f5201ac76773a9c962ec958f02f601c6adc
"
openstack%2Fcinder~master~Ief48c73eb09afe2b5ff8c391f06013ab7eebd670,openstack/cinder,master,fix_api_ref,Ief48c73eb09afe2b5ff8c391f06013ab7eebd670,[api-ref] Fix http method for updating encryption type,MERGED,2017-11-21 15:52:46.000000000,2018-02-25 14:43:40.000000000,2017-12-19 00:40:38.000000000,2,2,4,521904,f02aa85d75fb0a942b7aff1c0220571a38ca1c48,86,40,3,2,23081,Jeremy Zhang,jeremy.zhang,"[api-ref] Fix http method for updating encryption type

This patch aims to fix http method in api-ref for updating encryption
type, changing from 'POST' to 'PUT'.

Change-Id: Ief48c73eb09afe2b5ff8c391f06013ab7eebd670
"
openstack%2Fcinder~master~I5231f8fe3399deb9c57e6efb121d0d008dc9c7f4,openstack/cinder,master,bp/nvme-target-cli,I5231f8fe3399deb9c57e6efb121d0d008dc9c7f4,Rename iSCSI target config options to more general,MERGED,2017-12-16 22:56:26.000000000,2018-02-25 14:43:38.000000000,2017-12-20 16:23:46.000000000,131,118,8,528515,4b092e8d9d6611d73e22177cb57581e3e2cecee3,92,37,3,37,1736,Ivan Kolodyazhny,e0ne,"Rename iSCSI target config options to more general

Since NVMET target driver will be implemented it would be good to use
the same config options both for NVMEoF and iSCSI targets. That's why
this path renames iscsi_ip_address, iscsi_port, iscsi_helper
iscsi_target_prefix, iscsi_protocol to target_ip_address, target_port,
target_helper, target_prefix, and target_protocol according to current
deprecation policy.

Change-Id: I5231f8fe3399deb9c57e6efb121d0d008dc9c7f4
Related-Blueprint: nvme-target-cli
"
openstack%2Fcinder~master~I950316ac0924acd692b2410993f3c240ce319d6f,openstack/cinder,master,validate_integer,I950316ac0924acd692b2410993f3c240ce319d6f,Use method validate_integer from oslo.utils,MERGED,2017-12-18 04:12:23.000000000,2018-02-25 14:43:37.000000000,2018-01-07 07:13:48.000000000,6,16,4,528618,c0951aac0ade57dbd548bf3ded6630f06303858a,69,36,3,2,9796,ChangBo Guo,gcb,"Use method validate_integer from oslo.utils

We added method validate_integer in oslo.utils 3.33.0 [1].
so we can simply the method validate_integer in Cinder.

Depends-On: I741875eba329b762789a7c7c910a6c46beeff3fa

[1] https://review.openstack.org/#/c/508401/

Change-Id: I950316ac0924acd692b2410993f3c240ce319d6f
"
openstack%2Fcinder~master~Ic1545e431d5b874c5b4beb7265c318aa1708d18e,openstack/cinder,master,tempest_volume_base_client,Ic1545e431d5b874c5b4beb7265c318aa1708d18e,Tempest plugin: switch to use new base_client.BaseClient,ABANDONED,2017-12-16 08:15:04.000000000,2018-02-25 14:43:33.000000000,,1,1,0,528457,12285d03c25e08ab3a9d14274d813b50d6012e93,23,17,2,1,23081,Jeremy Zhang,jeremy.zhang,"Tempest plugin: switch to use new base_client.BaseClient

Class 'tempest.lib.services.volume.v3.base_client.BaseClient' has moved
to 'tempest.lib.services.volume.base_client.BaseClient' in version Pike
[1] and will be removed in a future version.

[1] I645ae35daebd924c4c4523163e5419cc050bb0ed

Change-Id: Ic1545e431d5b874c5b4beb7265c318aa1708d18e
"
openstack%2Fcinder~master~Ifa8ea98e494d3058ef1a29fee4ab9fa76149ce08,openstack/cinder,master,bug/1738223,Ifa8ea98e494d3058ef1a29fee4ab9fa76149ce08,Correct documented service upgrade order,MERGED,2017-12-14 21:08:35.000000000,2018-02-25 14:43:31.000000000,2017-12-16 01:46:54.000000000,25,26,1,528084,cf355db0ed357fb8387206735f4ea2cb717751a8,37,21,2,1,11904,Sean McGinnis,SeanM,"Correct documented service upgrade order

We had inconsistent service upgrade order information in our upgrade
documentation. This corrects the order to be consistent with our
recommended order of operations.

Change-Id: Ifa8ea98e494d3058ef1a29fee4ab9fa76149ce08
Closes-bug: #1738223
"
openstack%2Fcinder~master~Ib37ed5e65ccdd44d2726b36bc668aad2dcd98339,openstack/cinder,master,bug/1737735,Ib37ed5e65ccdd44d2726b36bc668aad2dcd98339,VMAX doc - Queens feature documentation,MERGED,2017-12-12 16:42:49.000000000,2018-02-25 14:43:12.000000000,2017-12-24 23:19:26.000000000,288,26,1,527458,d2281815dfcd0803c7d6ccc52d2f8fd398761876,35,24,2,1,12670,Helen Walsh,walshh2,"VMAX doc - Queens feature documentation

Part 1 - New features documented are Asynchronous SRDF,
SRDF Metro and Manage/Unmanage Snapshots.

Change-Id: Ib37ed5e65ccdd44d2726b36bc668aad2dcd98339
Partial-Bug: #1737735
"
openstack%2Fcinder~master~Id95beae0a46ab492756e0108039fefb28f4f0b69,openstack/cinder,master,bp/use-service-tokens,Id95beae0a46ab492756e0108039fefb28f4f0b69,Add service_token for cinder-nova interaction,MERGED,2017-12-01 07:09:22.000000000,2018-02-25 14:42:42.000000000,2017-12-21 13:05:47.000000000,209,1,0,524497,0787710c2477b127baeba901dc0a1598f7f1eabe,124,47,5,7,26463,Niraj Singh,nirajsingh,"Add service_token for cinder-nova interaction

Service token will be passed along with user token to communicate
with services when dealing with long running tasks like
Create volume snapshot.

Partial-Implements: blueprint use-service-tokens

Change-Id: Id95beae0a46ab492756e0108039fefb28f4f0b69
"
openstack%2Fcinder~master~I496e45608798a6a5d9606f9594feeb8b60855d1a,openstack/cinder,master,bug/1738254,I496e45608798a6a5d9606f9594feeb8b60855d1a,Don't call driver.terminate_connection if there is no connector,MERGED,2017-12-14 18:23:13.000000000,2018-02-25 14:42:35.000000000,2017-12-15 18:50:31.000000000,68,2,3,528028,1bcab6a48de991dd0e029c6acd5527643aa457c9,69,31,4,2,6873,Matt Riedemann,mriedem,"Don't call driver.terminate_connection if there is no connector

It's possible to attach a volume to a shelved offloaded instance,
which is not on a compute host - which means no host connector,
and then detach that volume while the instance is unshelved. There
is a test in Tempest just for this scenario.

When nova calls attachment_delete on detach, the cinder volume
manager is calling the driver.terminate_connection method regardless
of there being a host connector, and some drivers blow up on that.

This used to ""work"" with the pre-3.27 attach flow in nova because
in the detach case where there was no connector, nova would simply
not call os-terminate_connection, but with the new 3.27+ flow for
attach, nova only calls attachment_delete regardless of there
being a connector.

This change simply checks to see if the attachment has a connector
and if not, it avoids the call to the driver to terminate a connection
which does not exist.

Change-Id: I496e45608798a6a5d9606f9594feeb8b60855d1a
Closes-Bug: #1738254
"
openstack%2Fcinder~master~Ie3b8ffb209b30edf2a26a935aab840441b43adfa,openstack/cinder,master,bp/json-schema-validation,Ie3b8ffb209b30edf2a26a935aab840441b43adfa,V3 jsonschema validation: Group Snapshots,MERGED,2017-12-01 08:59:33.000000000,2018-02-25 14:42:34.000000000,2017-12-23 16:26:49.000000000,110,39,2,524528,65d57cf4b16fc47eb0c7e4ef9cb96b6c955f00b5,148,51,4,6,24645,Pooja Jadhav,poojajadhav,"V3 jsonschema validation: Group Snapshots

This patch adds jsonschema validation for below group snapshots API's

* POST /v3/{project_id}/group_snapshots
* POST /v3/{project_id}/group_snapshots/{group_snapshot_id}/action

Made changes to unit tests to pass body as keyword argument as wsgi
calls action method [1] and passes body as keyword argument.

[1] https://github.com/openstack/cinder/blob/master/cinder/api/openstack/wsgi.py#L997

Change-Id: Ie3b8ffb209b30edf2a26a935aab840441b43adfa
Partial-Implements: bp json-schema-validation
"
openstack%2Fcinder~master~I23def8b2095dcf3945d2e0e1b4e5efe178cef9be,openstack/cinder,master,,I23def8b2095dcf3945d2e0e1b4e5efe178cef9be,SMBFS: remove deprecated config options,MERGED,2017-11-15 11:27:04.000000000,2018-02-25 14:42:32.000000000,2017-12-20 16:23:44.000000000,9,75,2,520050,d618c66c60c2a8d7083f4d0eb5847227996b68e3,98,42,3,3,8543,Lucian Petrut,plucian,"SMBFS: remove deprecated config options

Some driver specific config options have been marked as deprecated
in Pike and are now being removed. The equivalent generic options
are available.

Note that the 'smbfs_sparsed_volumes' config option was only used
by the Linux SMB driver, which was removed in Pike. By mistake,
it was copied over to the Windows SMB driver, which was inheriting
it.

Change-Id: I23def8b2095dcf3945d2e0e1b4e5efe178cef9be
"
openstack%2Fcinder~master~I74c15a99e90a24020b2f427a70f5d04376bd31af,openstack/cinder,master,bug/1732378,I74c15a99e90a24020b2f427a70f5d04376bd31af,Restore_backup: set error when volume status not matched,MERGED,2017-11-15 09:42:32.000000000,2018-02-25 14:42:30.000000000,2017-12-14 00:59:37.000000000,4,0,0,520026,06d4ba2080155632e4609948994df5c8c76b9840,139,43,5,2,25169,Xiaojun Liao,wwba,"Restore_backup: set error when volume status not matched

When volume actual_status was not equal to expected_status, the
restoring were not setting the volume to a 'error_restoring'
status, if it so happened that the actual_status was 'available',
client would be misled to think that restoring had finished. So
this patch fixes that.

Closes-Bug:#1732378

Change-Id: I74c15a99e90a24020b2f427a70f5d04376bd31af
Signed-off-by: Xiaojun Liao <xiaojunliao85@gmail.com>
"
openstack%2Fcinder~master~I33447b1d83911b5cc18d0f29bea4f9a7c855f567,openstack/cinder,master,,I33447b1d83911b5cc18d0f29bea4f9a7c855f567,Fix json formatting eror,MERGED,2017-12-12 09:27:06.000000000,2018-02-25 14:42:27.000000000,2017-12-18 06:13:46.000000000,1,1,0,527351,a345dc0b706f506b8c5b635e8e1dce652a927183,40,27,1,1,26458,Brin Zhang,zhangbailin,"Fix json formatting eror

Change-Id: I33447b1d83911b5cc18d0f29bea4f9a7c855f567
"
openstack%2Fcinder~master~Id20000e483246b96d2dd478b041a56c2b1e119ff,openstack/cinder,master,fix-api-ref-v3-reverting-error-response-codes,Id20000e483246b96d2dd478b041a56c2b1e119ff,Modify v3 api-ref error response codes for reverting,MERGED,2017-11-23 10:07:53.000000000,2018-02-25 14:42:26.000000000,2017-12-12 21:23:16.000000000,1,1,2,522509,7241a8ee521bd6ef539bd8a81fbb8b484958ac9f,70,30,3,1,25169,Xiaojun Liao,wwba,"Modify v3 api-ref error response codes for reverting

Change-Id: Id20000e483246b96d2dd478b041a56c2b1e119ff
Signed-off-by: Xiaojun Liao <xiaojunliao85@gmail.com>
"
openstack%2Fcinder~master~I5672904383d41949b86cfdff41cfa0f0ae79b5ba,openstack/cinder,master,,I5672904383d41949b86cfdff41cfa0f0ae79b5ba,Deprecate cinder-manage logs commands,MERGED,2017-12-10 16:23:46.000000000,2018-02-25 14:41:31.000000000,2017-12-12 00:56:56.000000000,28,4,0,526928,7c00d9b966abac50ad5ad8664fbe327ba2aca10e,76,33,3,3,4523,Eric Harney,eharney,"Deprecate cinder-manage logs commands

These commands search Cinder log files and
/var/log/messages to look for log messages related
to Cinder.

This is hacky and bound to be unreliable in
deployments which now may have log files configured
in different ways.

They also read entire log files into memory as
lists and reverse them, which is bound to be slow
on large deployments.

Deprecate these commands and leave log analysis
as a job for another tool.

Change-Id: I5672904383d41949b86cfdff41cfa0f0ae79b5ba
"
openstack%2Fcinder~master~I2226c8533cbd1ddd274d8dd0b2d77708463896f4,openstack/cinder,master,bp/json-schema-validation,I2226c8533cbd1ddd274d8dd0b2d77708463896f4,V3 jsonschema validation: Volume metadata,MERGED,2017-12-08 07:11:09.000000000,2018-02-25 14:41:04.000000000,2017-12-14 14:26:22.000000000,117,58,0,526606,afa410bcf65c8039edb424caa7ae510c515528e3,60,40,1,5,24645,Pooja Jadhav,poojajadhav,"V3 jsonschema validation: Volume metadata

This patch adds jsonschema validation for below metadata API's
* POST /v3/{project_id}/volumes/{volume_id}/metadata
* PUT  /v3/{project_id}/volumes/{volume_id}/metadata
* PUT  /v3/{project_id}/volumes/{volume_id}/metadata/{key}

The reason behind applying schema for v2(update and update_all) is
that in ""/cinder/tests/unit/api/v2/test_volume_metadata.py"" module
from this patch, V2's unit test cases are inherited for V3 and now
we are applying schema validation for V3 because of that V2's unit
test cases responses are modified.  If we remove schema validation
from V2 then we will need to add separate unit test cases for V3.

Made changes to unit tests to pass body as keyword argument as wsgi
calls action method [1] and passes body as keyword argument.

[1] https://github.com/openstack/cinder/blob/master/cinder/api/openstack/wsgi.py#L997
Partial-Implements: bp json-schema-validation

Change-Id: I2226c8533cbd1ddd274d8dd0b2d77708463896f4
"
openstack%2Fcinder~master~I2de9766406f5abf7710de8e7a9637d5a23324347,openstack/cinder,master,openstack/requirements,I2de9766406f5abf7710de8e7a9637d5a23324347,Updated from global requirements,MERGED,2017-12-07 13:19:32.000000000,2018-02-25 14:41:02.000000000,2017-12-10 17:52:12.000000000,1,1,0,526367,3ac39a99f6b2b770b6d17f6efa837c9835d7a628,39,34,1,1,11131,OpenStack Proposal Bot,proposal-bot,"Updated from global requirements

Change-Id: I2de9766406f5abf7710de8e7a9637d5a23324347
"
openstack%2Fcinder~master~Ib9596ac3ecc57a4f825b7d7118014e2ac14b2473,openstack/cinder,master,bug/1735337,Ib9596ac3ecc57a4f825b7d7118014e2ac14b2473,Remove skip_validation_flag to False by default,MERGED,2017-11-30 08:07:57.000000000,2018-02-25 14:41:01.000000000,2017-12-18 21:54:25.000000000,8,48,10,524091,7310676502f34a3e38329995731e12bcd5331210,103,42,4,6,14806,Chhavi Agarwal,chhagarw,"Remove skip_validation_flag to False by default

Remove the skip_validation to force quota
validation.
Closes-bug: #1735337

Change-Id: Ib9596ac3ecc57a4f825b7d7118014e2ac14b2473
"
openstack%2Fcinder~driverfixes%2Focata~I623d6114db866a465955f8a5ae7f40b69c781622,openstack/cinder,driverfixes/ocata,bug/1734505-driverfixes/ocata,I623d6114db866a465955f8a5ae7f40b69c781622,HPE3PAR: Create FC vlun as host sees,MERGED,2017-12-05 18:03:04.000000000,2018-02-25 14:40:59.000000000,2018-01-10 21:02:39.000000000,17,92,0,525719,e789cd21eb2d052c6ba57462b7a39d57243705c8,42,21,2,2,24952,Vivek Soni,sonivi,"HPE3PAR: Create FC vlun as host sees

Host sees VLUN template allows host connected
to any port to see a vv. so, only one vlun
template will be created per host irrespective
of number of FC ports available.

Change-Id: I623d6114db866a465955f8a5ae7f40b69c781622
Closes-Bug: #1734505
(cherry picked from commit cd18537fd631ba08a342bcfd328d765ea4d8c129)
"
openstack%2Fcinder~master~I14c4ea5ac1bdb0dedfa875c94d1e1b36a256a390,openstack/cinder,master,bug/1734037,I14c4ea5ac1bdb0dedfa875c94d1e1b36a256a390,DS8K: lss_range_for_cg should take csv as well as range,MERGED,2017-11-23 08:23:37.000000000,2018-02-25 14:40:57.000000000,2017-12-13 15:32:31.000000000,56,13,9,522474,b9ee79fae6d673538df532bf801eba0f0f372816,123,43,5,2,26422,Peng Wang,wangpeng,"DS8K: lss_range_for_cg should take csv as well as range

Now, lss_range_for_cg only accept a range value, but we think it
should also accept csv. This patch is used to implement it in
Queues Release.

Change-Id: I14c4ea5ac1bdb0dedfa875c94d1e1b36a256a390
Closes-Bug: 1734037
"
openstack%2Fcinder~master~I0fb5dc6404ee4db54a3dfc839b9a56622bff6906,openstack/cinder,master,bug/1734633,I0fb5dc6404ee4db54a3dfc839b9a56622bff6906,NEC driver: delete an unused configuration parameter.,MERGED,2017-11-28 10:26:49.000000000,2018-02-25 14:40:56.000000000,2017-12-15 18:45:46.000000000,127,215,3,523382,9974c39f0355bd0a0c3c3364297688de2eccf467,162,44,7,5,23885,Shunei Shiono,s-shiono,"NEC driver: delete an unused configuration parameter.

The `ldset_controller_node_name' parameter has been deprecated
and is ineffective already.
This patch refactors NEC driver by deleting the unused codes.

Change-Id: I0fb5dc6404ee4db54a3dfc839b9a56622bff6906
Closes-Bug: #1734633
"
openstack%2Fcinder~master~Ic70f45762cf4e426c222415e49b947a328282ca0,openstack/cinder,master,bp/migrate-fixed-key-to-barbican,Ic70f45762cf4e426c222415e49b947a328282ca0,Migrate fixed_key encryption keys to Barbican,MERGED,2017-12-01 20:34:23.000000000,2018-02-25 14:40:54.000000000,2017-12-14 17:49:02.000000000,429,0,2,524720,189a1096da2b0ad6b51fd5943a385a89f56a18c4,39,35,1,6,21129,Alan Bishop,ASBishop,"Migrate fixed_key encryption keys to Barbican

Assist users who are switching from the legacy ConfKeyManager to
Barbican by automatically migrating any existing keys. Key migration
is executed in its own thread spawned on cinder-volume startup. Two
factors are used to determine whether existing keys need to be
migrated.

1) The ConfKeyManager's fixed_key config value is set (not None).
   This indicates volumes may exist that were encrypted using the
   ConfKeyManager.
2) Barbican is the current key manager.

When the both conditions are met, each instance of the cinder-volume
service scans its volumes in the database, looking for volumes using
the ConfKeyManager's all-zeros encryption key ID. If a volume has an
all-zeros key ID, the same secret (derived from the fixed_key) is stored
in Barbican, and all database references to that volume's key ID are
replaced with the new Barbican key ID.

Implements: blueprint migrate-fixed-key-to-barbican
Change-Id: Ic70f45762cf4e426c222415e49b947a328282ca0
"
openstack%2Fcinder~master~Ifefc495bdc8877e981e11bd5ffee371dc0eb2e0a,openstack/cinder,master,zanata/translations,Ifefc495bdc8877e981e11bd5ffee371dc0eb2e0a,Imported Translations from Zanata,MERGED,2017-12-01 06:33:05.000000000,2018-02-25 14:40:40.000000000,2017-12-01 17:31:21.000000000,14,5,0,524483,c906171b94de27c3a5174de24dfbb69d009274f5,34,29,1,1,11131,OpenStack Proposal Bot,proposal-bot,"Imported Translations from Zanata

For more information about this automatic import see:
https://docs.openstack.org/i18n/latest/reviewing-translation-import.html

Change-Id: Ifefc495bdc8877e981e11bd5ffee371dc0eb2e0a
"
openstack%2Fcinder~master~Id2165a07995ab706d4a327f7340dccee7799c7b6,openstack/cinder,master,bug/1735177,Id2165a07995ab706d4a327f7340dccee7799c7b6,Discrepancy in api-ref and code for create group snapshot API,MERGED,2017-11-30 10:13:37.000000000,2018-02-25 14:40:32.000000000,2017-12-01 03:24:10.000000000,1,1,0,524120,7e693dd10729d696723e3742fdfbca845f821418,36,31,1,1,24645,Pooja Jadhav,poojajadhav,"Discrepancy in api-ref and code for create group snapshot API

'group_id' is mentioned as an optional parameter in api-ref doc for
POST /v3/{project_id}/group_snapshots API but in the code if we don't
pass group-id it returns BadRequest.

This patch fixes this discrepancy by updating the api-ref according
to the code.

Closes-Bug: #1735177
Change-Id: Id2165a07995ab706d4a327f7340dccee7799c7b6
"
openstack%2Fcinder~master~I7d48a0210f3d4545d5a4d932796cb82a677e467f,openstack/cinder,master,,I7d48a0210f3d4545d5a4d932796cb82a677e467f,"added clarification in docs for usage of ""volume_clear*"" options",MERGED,2017-11-29 16:15:31.000000000,2018-02-25 14:40:30.000000000,2017-12-14 00:29:44.000000000,3,3,1,523923,c07f4d3a788951ea3dfa310c46252f41c1141c58,32,27,1,1,11915,Jan Klare,jklare,"added clarification in docs for usage of ""volume_clear*"" options

* In the current documentation its pretty unclear where to set the
volume_clear* options and since we found that they will not work while
set in the [DEFAULT] section this commit adds information on where to
set them.

Change-Id: I7d48a0210f3d4545d5a4d932796cb82a677e467f
"
openstack%2Fcinder~driverfixes%2Fnewton~I7932b1d952844b49cfdb504ed0ba188b489d7f44,openstack/cinder,driverfixes/newton,kaminario-iscsi-non-discovery-newton,I7932b1d952844b49cfdb504ed0ba188b489d7f44,Kaminario K2: Add non discovery iSCSI multipath,MERGED,2017-11-24 09:12:32.000000000,2018-02-25 14:40:29.000000000,2018-01-10 13:54:26.000000000,103,43,3,522748,1e1e8e94b161c161efc227aedf43e95798cbfd18,61,20,2,4,16258,nikesh,nikem,"Kaminario K2: Add non discovery iSCSI multipath

Current Kaminario K2 driver only supports iSCSI multipathing using
discovery (sendtargets), which in some cases may be undesirable, since a
broken primary path could prevent an attachment.

This code adds the possibility of not using discovery mode and return
all connection information when `initialize_connection` is called, which
should provide increased reliability.

Change-Id: I7932b1d952844b49cfdb504ed0ba188b489d7f44
(cherry picked from commit c9ec9b9bd755f042dbe1ccbdc5e3ff87fa60269c)
(cherry picked from commit 7bcb2ff94cf38eaa9def1115569981760e36510c)
"
openstack%2Fcinder~master~Ic220ea4d8a6e83293e5237acfb07b1a417293803,openstack/cinder,master,bug/1710937,Ic220ea4d8a6e83293e5237acfb07b1a417293803,handle no default_cgsnapshot_type,MERGED,2017-11-16 14:47:58.000000000,2018-02-25 14:40:27.000000000,2017-12-13 22:48:27.000000000,13,13,0,520607,be7b476d562f79d649724555aeadfad60127e356,92,38,2,2,10608,Matthew Edmonds,edmondsw,"handle no default_cgsnapshot_type

If default_cgsnapshot_type has been deleted, group operations for
drivers relying on the generic volume group implementation were failing
with a KeyError while attempting to determine if the targeted group was
default_cgsnapshot_type. This fixes that by using a comparison that
allows for the possibility that default_cgsnapshot_type does not
exist.

Change-Id: Ic220ea4d8a6e83293e5237acfb07b1a417293803
Closes-Bug: #1710937
"
openstack%2Fcinder~stable%2Fpike~I065ffba9615af54998ae94a8d2d2fd3853f462cb,openstack/cinder,stable/pike,bug/1721207,I065ffba9615af54998ae94a8d2d2fd3853f462cb,VMAX driver - detach volume shouldn't remove from volume groups,MERGED,2017-11-28 17:11:30.000000000,2018-02-25 14:40:25.000000000,2017-12-19 13:17:59.000000000,165,107,0,523475,68df7c8d7c6445661206fdf0fc15a4e59892ebb6,35,19,1,4,12670,Helen Walsh,walshh2,"VMAX driver - detach volume shouldn't remove from volume groups

Detaching a volume in VMAX removes the volume from all its current
storage groups and returns it to its default storage group. This is not
desired behaviour when the volume is a member of a generic volume group.
The volume should only be removed from the storage group associated
with the masking view related to the detach operation (or all masking
views in the case of a force detach). This patch rectifies the issue.

Change-Id: I065ffba9615af54998ae94a8d2d2fd3853f462cb
Closes-Bug: 1721207
(cherry picked from commit 27fd333df9a7f5b473225b3c55cd0c250f017134)
"
openstack%2Fcinder~master~I962b06eeabfc1ac8dc2bdfc6459fd37f7532f0ee,openstack/cinder,master,doc-migration,I962b06eeabfc1ac8dc2bdfc6459fd37f7532f0ee,Update the documentation links,MERGED,2017-11-28 02:50:47.000000000,2018-02-25 14:40:22.000000000,2017-12-07 06:45:31.000000000,2,2,0,523282,ab86e7c34a176c578c09150d8c71b590de179f88,31,28,1,1,24209,Ding Guoqiang,dingguoqiang,"Update the documentation links

The documentation about ""ops-guide"" has been moved.

Change-Id: I962b06eeabfc1ac8dc2bdfc6459fd37f7532f0ee
"
openstack%2Fcinder~master~Iaf77db73e368aee0d09b4c8e76f180f394f1aa37,openstack/cinder,master,bug/1733903,Iaf77db73e368aee0d09b4c8e76f180f394f1aa37,Use new oslo.db test cases,MERGED,2017-11-22 16:22:38.000000000,2018-02-25 14:39:32.000000000,2017-11-28 18:57:48.000000000,1,1,0,522290,a7ab5ba1f3f0618f29ff02a1e8b61922eaddac61,56,30,2,1,11904,Sean McGinnis,SeanM,"Use new oslo.db test cases

Base migration test cases have moved to a new location in oslo.db
resulting in DeprecationWarnings in the Cinder logs. This updates
the migration tests to use the new location for these base test
classes.

Also tries to clean up slightly by moving the test_migrations
tests under the db directory.

Change-Id: Iaf77db73e368aee0d09b4c8e76f180f394f1aa37
Closes-bug: #1733903
"
openstack%2Fcinder~master~Ic44dfae8bb187a5aa9c2c1f50f7b5dc0ef0f28f8,openstack/cinder,master,bug/1560867,Ic44dfae8bb187a5aa9c2c1f50f7b5dc0ef0f28f8,Support create a volume from image snapshot,MERGED,2016-05-11 10:05:58.000000000,2018-02-25 14:39:09.000000000,2017-11-27 17:42:02.000000000,105,7,13,314944,25dd8109df4425e7f470429956d093bf59fcf669,189,60,10,7,12382,YaoZheng,YaoZheng,"Support create a volume from image snapshot

The instance boot from volume, snapshot the instance will create
a image in glance. The image size is 0, it just a link to the
volume snapshot. When the user create volume from the snapshot
image, in the current version, it will create a blank volume. so
the user is troubled. This patch fix it.

The scheme: when the user create volume from snapshot image, the
api create interface will parse out the snapshot image corresponds
to the volume snapshot id. Then create a volume from the volume
snapshot. So, the user can use this way to restore the instance's
bootable volume.

Change-Id: Ic44dfae8bb187a5aa9c2c1f50f7b5dc0ef0f28f8
Closes-Bug: #1560867
"
openstack%2Fcinder~master~I54695655e563d84e4fb1b76c42f0127c5fb909f7,openstack/cinder,master,bp/remotefs-manage-unmanage-volume,I54695655e563d84e4fb1b76c42f0127c5fb909f7,SMBFS: manageable volumes,MERGED,2017-11-17 18:49:40.000000000,2018-02-25 14:39:08.000000000,2017-12-14 00:59:08.000000000,568,10,1,521158,ed945da6bf05475c272443d2eebacfc79c389926,147,42,6,6,8543,Lucian Petrut,plucian,"SMBFS: manageable volumes

This change allows the SMBFS driver to claim (manage) vhd/x images
present on pre-configured shares.

Note that images having backing (parent) files will be rejected.
Managing snapshots will not be supported either.

The images may reside in subdirectories (and get moved afterwards),
which may be useful when having a folder dedicated to images that
are to be imported in Cinder.

All the logic is included in the new ""RemoteFSManageableVolumesMixin""
class so that any related driver may inherit it. For the record,
this works out of the box for the NFS driver (special care has been
taken in this sense).

Implements: blueprint remotefs-manage-unmanage-volume
Change-Id: I54695655e563d84e4fb1b76c42f0127c5fb909f7
"
openstack%2Fcinder~master~I84b5ff546726c9eddb46badb48b24ed1905e0aa8,openstack/cinder,master,bp/ceph-volume-migrate,I84b5ff546726c9eddb46badb48b24ed1905e0aa8,RBD: support driver-assisted volume migration,MERGED,2015-12-10 20:50:25.000000000,2018-02-25 14:39:04.000000000,2017-11-22 22:26:23.000000000,188,10,94,256091,dd119d5620bebc59a72f4fb1e1b795f56da5db64,559,100,23,3,9236,Jon Bernard,jbernard,"RBD: support driver-assisted volume migration

This patch implements the driver function migration_volume() and allows
a user to efficiently migrate a volume from one pool to another as long
as both pools reside in the same cluster.

Change-Id: I84b5ff546726c9eddb46badb48b24ed1905e0aa8
Implements: blueprint ceph-volume-migrate
"
openstack%2Fcinder~master~I50a1d3b60652d9d44d2c47bb9bc413dd127bc938,openstack/cinder,master,bp/json-schema-validation,I50a1d3b60652d9d44d2c47bb9bc413dd127bc938,V3 jsonschema validation: Attachments,MERGED,2017-11-08 06:42:16.000000000,2018-02-25 14:39:02.000000000,2017-11-22 07:12:25.000000000,113,23,3,518457,95ba9118c6de62094572eefaf7a14d008295d886,113,42,4,5,24645,Pooja Jadhav,poojajadhav,"V3 jsonschema validation: Attachments

This patch adds jsonschema validation for below Attachments API's
* POST /v3/{project_id}/attachments
* PUT  /v3/{project_id}/attachments/{attachment_id}

Made changes to unit tests to pass body as keyword argument as wsgi
calls action method [1] and passes body as keyword argument.

[1] https://github.com/openstack/cinder/blob/master/cinder/api/openstack/wsgi.py#L997

Partial-Implements: bp json-schema-validation

Change-Id: I50a1d3b60652d9d44d2c47bb9bc413dd127bc938
"
openstack%2Fcinder~master~I50e4c66097aefdfea1e7589b2ae67e262ae6a6d3,openstack/cinder,master,updated-pti,I50e4c66097aefdfea1e7589b2ae67e262ae6a6d3,Update bindep.txt for doc builds,MERGED,2017-11-21 20:07:19.000000000,2018-02-25 14:39:01.000000000,2017-11-21 23:19:02.000000000,6,3,0,521998,da6470d32f2bc11976e43582932ae8bf713aa883,28,21,1,1,6547,Andreas Jaeger,jaegerandi,"Update bindep.txt for doc builds

https://governance.openstack.org/tc/reference/project-testing-interface.html#documentation
specifies that doc dependencies need the doc tag in bindep, use it.

Leave test environment in for transition period until we use the new
scripts.

Change-Id: I50e4c66097aefdfea1e7589b2ae67e262ae6a6d3
"
openstack%2Fcinder~master~Ia5d1e988256246e3552e3a770146503ea7f7bf73,openstack/cinder,master,add_fk_service_uuid_to_volumes,Ia5d1e988256246e3552e3a770146503ea7f7bf73,Add service_uuid FK to volumes,MERGED,2017-11-11 15:39:45.000000000,2018-02-25 14:38:59.000000000,2017-11-27 19:22:32.000000000,191,4,18,519025,cdb6cdcc961a5553cf9f81cbb49994d98180f947,214,42,8,12,2243,John Griffith,john-griffith,"Add service_uuid FK to volumes

This patch adds a service_uuid FK to the volumes table.
Up until now we've just done some host name parsing and
to match up service node with where the volume is being
serviced from.

With this, we now have a unique identifier that's user
visible to indicate what node the volume-service for a
particular volume is being serviced by.

We'll use this for things like share-target locks going
forward.

Change-Id: Ia5d1e988256246e3552e3a770146503ea7f7bf73
"
openstack%2Fcinder~master~I220cd20fefbe83ba8c392ab6b1679620d6a1d934,openstack/cinder,master,,I220cd20fefbe83ba8c392ab6b1679620d6a1d934,Fix group_type_id in api-ref,MERGED,2017-11-21 07:53:59.000000000,2018-02-25 14:38:54.000000000,2017-11-29 20:18:51.000000000,3,9,2,521747,176f9b17b9e3cc22f17ae7200156491a29fc8fc5,52,29,4,2,8556,Ghanshyam,ghanshyam,"Fix group_type_id in api-ref

group_type_id in GET/DELETE/PUT /group_types/group_type_id
is mentioned as optional path variable which is not true.

- https://github.com/openstack/cinder/blob/7c66eb3d976048e7179fedb7694a989c9181c374/cinder/api/v3/group_types.py#L101

This id is mandatory and doc should be updated.
This create confusion while test case or using this API,
example - https://review.openstack.org/#/c/521634/4/tempest/lib/services/volume/v3/group_types_client.py
Closes-Bugs: # 1733504

Change-Id: I220cd20fefbe83ba8c392ab6b1679620d6a1d934
"
openstack%2Fcinder~master~I37d4fb98e165bed2f36f54d6a30477b65bcddd50,openstack/cinder,master,bug/1728654,I37d4fb98e165bed2f36f54d6a30477b65bcddd50,NetApp ONTAP: Fix delayed snapshot deletion call,MERGED,2017-11-20 18:02:25.000000000,2018-02-25 14:38:36.000000000,2017-11-30 23:25:56.000000000,3,12,0,521616,954ce725d900b653e4f32e71c753bb4e241956ea,62,41,1,3,16643,Goutham Pacha Ravi,gouthamr,"NetApp ONTAP: Fix delayed snapshot deletion call

The ONTAP drivers have a retry mechanism to cleanup
deleted FlexVol snapshots (those that get taken to assist
Cinder's CG snapshots or consistent volume group
snapshots). The driver calls for this pass a redundant
parameter after the cleanup committed in:
I129ca060a89275ffd56481b8f64367b0d803cff5

Fix this redundant parameter.

Change-Id: I37d4fb98e165bed2f36f54d6a30477b65bcddd50
Closes-Bug: #1728654
"
openstack%2Fcinder~master~I80b1853cbe2cc02a056195e967e9422617bbf850,openstack/cinder,master,add_volume_encryption_api_ref,I80b1853cbe2cc02a056195e967e9422617bbf850,Add v3 api-ref for showing encryption specs item,MERGED,2017-11-18 08:21:17.000000000,2018-02-25 14:38:12.000000000,2017-11-20 22:13:16.000000000,39,4,2,521239,4f4a0256f782b4d3f9a54ea975f9f81c59c955a2,39,30,2,3,23081,Jeremy Zhang,jeremy.zhang,"Add v3 api-ref for showing encryption specs item

This patch adds v3 api-ref for showing encryption specs item for an
existing volume type.

Change-Id: I80b1853cbe2cc02a056195e967e9422617bbf850
"
openstack%2Fcinder~master~I9b631dbedd1b2c8bfe7430943dfc16e85b9f85e0,openstack/cinder,master,remove_reno_vers,I9b631dbedd1b2c8bfe7430943dfc16e85b9f85e0,Remove setting of version/release from releasenotes,MERGED,2017-11-16 16:25:46.000000000,2018-02-25 14:38:08.000000000,2017-11-20 08:53:35.000000000,3,10,0,520638,46144c4a27c31101882dc5ca96c16672f4550c02,66,31,2,1,11904,Sean McGinnis,SeanM,"Remove setting of version/release from releasenotes

Release notes are version independent, so remove version/release values.
We've found that most projects now require the service package to be
installed in order to build release notes, and this is entirely due to
the current convention of pulling in the version information.

Release notes should not need installation in order to build, so this
unnecessary version setting needs to be removed.

Change-Id: I9b631dbedd1b2c8bfe7430943dfc16e85b9f85e0
"
openstack%2Fcinder~stable%2Fpike~I9ef79a21c7438e69221a5ed2a1c1bfb59f3f9a32,openstack/cinder,stable/pike,bug/1728834,I9ef79a21c7438e69221a5ed2a1c1bfb59f3f9a32,"Correct gb,snapshot quota update in group snapshot",MERGED,2017-11-16 04:38:52.000000000,2018-02-25 14:38:06.000000000,2017-11-16 20:56:20.000000000,59,20,0,520292,f17ace72fe2cfb4823b153dda915d25261e74cfe,22,17,2,7,24131,Abhishek Sharma M,abhi.sharma,"Correct gb,snapshot quota update in group snapshot

Currently we are incrementing gigabytes quota twice, once while
creating snapshot & then while creating individual volumes & this
is fixed in this change. Also, snapshot quota updation was put in
a loop of volumes because of which it gets incremented to number
of volume times.

Change-Id: I9ef79a21c7438e69221a5ed2a1c1bfb59f3f9a32
Closes-Bug: 1728834
(cherry picked from commit b3669fa67cf08f1075be1dd7641ab3af951c138c)
"
openstack%2Fcinder~master~I06a8eb38f35ccff125282c8886458bfe99fe196e,openstack/cinder,master,bp/inspur-instorage-driver,I06a8eb38f35ccff125282c8886458bfe99fe196e,Inspur Cinder iSCSI driver,MERGED,2017-09-11 12:33:46.000000000,2018-02-25 14:38:04.000000000,2017-11-20 19:37:00.000000000,9877,0,56,502455,e7362103c67579bf7caf1437afc3d4518923c8a6,458,57,13,15,25648,wang yong,wangyong,"Inspur Cinder iSCSI driver

Features that Inspur Driver support:
Create, list, delete, attach (map), and detach (unmap) volumes
Create, list, and delete volume snapshots
Copy an image to a volume
Copy a volume to an image
Clone a volume
Extend a volume
Retype a volume
Create a volume from a snapshot
Manage an existing volume
Consistency group create,update,delete
Consistency group snapshot create,delete
Group create,update,delete
Group snapshot create,delete
Replication V2.1

ThirdPartySystems: INSPUR CI

Implements: Blueprint inspur-instorage-driver

Change-Id: I06a8eb38f35ccff125282c8886458bfe99fe196e
"
openstack%2Fcinder~master~I615d5cab95b07f995318266166480a9fd4d713f8,openstack/cinder,master,fix-docs-indent,I615d5cab95b07f995318266166480a9fd4d713f8,Fix controller install document indentation,MERGED,2017-11-15 06:14:21.000000000,2018-02-25 14:37:59.000000000,2017-11-18 02:31:04.000000000,88,88,0,519978,9a29d679f73623fd3f412d29a3b3efcd8ab0be6d,35,28,2,3,5689,Masayuki Igawa,igawa,"Fix controller install document indentation

This commit fixes the document of cinder-controller-install*.rst.
Otherwise, the html docs are a little weird.

Change-Id: I615d5cab95b07f995318266166480a9fd4d713f8
"
openstack%2Fcinder~master~Id74d48348f2a9aa212fe178ac2e2304ff134be9a,openstack/cinder,master,pwlogging,Id74d48348f2a9aa212fe178ac2e2304ff134be9a,Fix several instances of chap secret being output to logs.,MERGED,2017-11-14 20:03:29.000000000,2018-02-25 14:37:35.000000000,2017-12-14 00:29:52.000000000,26,12,0,519734,46f26084ce59ffcd5c2d66558fee85f4deb53a94,46,34,1,7,24147,Mark Giles,mark-giles,"Fix several instances of chap secret being output to logs.

Several drivers had cases where chap secrets could be output to
the log files.  This fixes several such cases by masking the secret.

Change-Id: Id74d48348f2a9aa212fe178ac2e2304ff134be9a
"
openstack%2Fcinder~master~I093da81fb9a0021e4fedff7eb48d3245957e787a,openstack/cinder,master,bug/1727176,I093da81fb9a0021e4fedff7eb48d3245957e787a,HPE 3PAR: Handle single path in FC configuration,MERGED,2017-11-13 10:30:51.000000000,2018-02-25 14:37:33.000000000,2017-11-14 20:27:43.000000000,95,10,2,519304,d265cc5a2d4edf5bdaecb34feb6d7c35a76ec526,68,39,2,2,24952,Vivek Soni,sonivi,"HPE 3PAR: Handle single path in FC configuration

Issue :- With single path configuration, post
volume attach multiple vluns are created,
instead of one vlun.

Added check to create host with single initiator,
which will use single target wwn to create a vlun

Change-Id: I093da81fb9a0021e4fedff7eb48d3245957e787a
Closes-Bug: #1727176
"
openstack%2Fcinder~master~Ie4c157f11e5fde0c2dd1d3e06feb0caa9d2d9ede,openstack/cinder,master,bp/inspection-mechanism-for-capacity-limited-host,Ie4c157f11e5fde0c2dd1d3e06feb0caa9d2d9ede,Schedule request to scheduler when create group from resource,MERGED,2017-11-03 08:30:22.000000000,2018-02-25 14:37:32.000000000,2017-11-16 06:41:56.000000000,118,34,0,517574,d812f5705fbb9503f307452a9904d21cc609439a,122,39,5,7,23083,TommyLike,TommyLike,"Schedule request to scheduler when create group from resource

Pass the request to scheduler rather than volume service in
order to check the backend's capacity.

Change-Id: Ie4c157f11e5fde0c2dd1d3e06feb0caa9d2d9ede
Partial-Implements: bp inspection-mechanism-for-capacity-limited-host
"
openstack%2Fcinder~master~Ic9720c649ccb1fbcf2f319c0cc422c54f0925aac,openstack/cinder,master,bug/1715041,Ic9720c649ccb1fbcf2f319c0cc422c54f0925aac,set vg_thin_pool_size to float type,MERGED,2017-09-05 03:28:38.000000000,2018-02-25 14:37:28.000000000,2017-11-18 02:31:02.000000000,3,3,0,500663,9a386cee127519ce70a0ef494cbbeaeb7f52c5e7,69,44,3,2,22905,wanghongxu,wanghongxu,"set vg_thin_pool_size to float type

lvsize is type of str, we need a float type.

Closes-Bug: #1715041
Change-Id: Ic9720c649ccb1fbcf2f319c0cc422c54f0925aac
"
openstack%2Fcinder~master~Ief6ff0771488417fc80a3ffe7505a0d478ec5eb6,openstack/cinder,master,,Ief6ff0771488417fc80a3ffe7505a0d478ec5eb6,Add .zuul.yaml with LIO job,MERGED,2017-11-07 19:47:30.000000000,2018-02-25 14:37:27.000000000,2017-11-14 18:43:10.000000000,122,30,0,518390,5601d336ca556c82891466c89cadef0676df576c,106,29,7,5,4523,Eric Harney,eharney,"Add .zuul.yaml with LIO job

This replaces the legacy-tempest-dsvm-full-lio job.

Skip tests that are currently failing.

Change-Id: Ief6ff0771488417fc80a3ffe7505a0d478ec5eb6
"
openstack%2Fcinder~master~I3cf8e29184a68a07d35fb121c816e40b89df393e,openstack/cinder,master,assertRaisesRegex,I3cf8e29184a68a07d35fb121c816e40b89df393e,Handle assertRaisesRegexp Python 3 deprecation,MERGED,2017-11-07 23:54:47.000000000,2018-02-25 14:37:25.000000000,2017-11-16 05:09:41.000000000,28,23,0,518417,c79d1519545baefd3faccbac9e6c5ee9a2b177bd,42,26,2,2,11904,Sean McGinnis,SeanM,"Handle assertRaisesRegexp Python 3 deprecation

In Python 3, assertRaisesRegexp has been deprecated in favor of
assertRaisesRegex. This newer name is not available in Python 2
though, so we can't just change over to the new name.

To get rid of the deprecation messages in our py35 unit test runs,
this adds an alias to our test base that just provides an alias
rather than updating all locations in our tests that use this.

Change-Id: I3cf8e29184a68a07d35fb121c816e40b89df393e
"
openstack%2Fcinder~driverfixes%2Fnewton~Ib78293efa626c098a572f4c64119ee2ff296bd40,openstack/cinder,driverfixes/newton,bug/1726591,Ib78293efa626c098a572f4c64119ee2ff296bd40,Dell EMC PS: Fix Duplicate ACL records Issue,MERGED,2017-11-07 15:35:52.000000000,2018-02-25 14:37:16.000000000,2017-11-21 12:26:53.000000000,45,10,0,518359,e637fe080e18b8faa910c0d90f653de964162ccb,26,14,2,3,10379,Rajini Karthik,rajinir,"Dell EMC PS: Fix Duplicate ACL records Issue

Live migration was creating duplicate ACL records for the compute
nodes. Fixed it by not creating one when an ACL exists during
initialization of the volume.

Closes Bug: #1726591

Change-Id: Ib78293efa626c098a572f4c64119ee2ff296bd40
(cherry picked from commit 22c09d57687b98faf4193cb1be3d738ddf3bbd28)
"
openstack%2Fcinder~driverfixes%2Fnewton~I1946dc0ad9cb7a68072a39816fa9fa224c2eb6a5,openstack/cinder,driverfixes/newton,bug/1692775,I1946dc0ad9cb7a68072a39816fa9fa224c2eb6a5,Run backup compression on native thread,MERGED,2017-11-07 11:54:42.000000000,2018-02-25 14:35:55.000000000,2018-01-18 18:40:42.000000000,49,4,0,518311,41754fd57f27bba646d1d6e26388c7f5f4c2dc4e,42,17,1,4,9535,Gorka Eguileor,Gorka,"Run backup compression on native thread

Backup data compression is a CPU bound operation that will not yield to
other greenthreads, so given enough simultaneous backup operations they
will lead to other threads' starvation.

This is really problematic for DB connections, since starvation will
lead to connections getting dropped with errors such as ""Lost connection
to MySQL server during query"".

Detailed information on why these connections get dropped can be found
in comment ""[31 Aug 2007 9:21] Magnus Blåudd"" on this MySQL bug [1].

These DB issues may result in backups unnecessary ending in an ""error""
state.

This patch fixes this by moving the compression to a native thread so
the cooperative multitasking in Cinder Backup can continue switching
threads.

[1] https://bugs.mysql.com/bug.php?id=28359

Closes-Bug: #1692775
Closes-Bug: #1719580
Change-Id: I1946dc0ad9cb7a68072a39816fa9fa224c2eb6a5
(cherry picked from commit af0f00bc52f79d9395adfe0575b0dbe353e18bbe)
(cherry picked from commit 439f90da8e4c1cfa1acfe36b5ea8a6c5bae6139f)
(cherry picked from commit b241f93267646a6501e3a5fb14521f05e38a2ae9)
"
openstack%2Fcinder~master~I11c0932c546d8edd0e6009c4e2668f50ac2008c1,openstack/cinder,master,,I11c0932c546d8edd0e6009c4e2668f50ac2008c1,VMAX doc - add manage and unmanage section,MERGED,2017-11-06 11:32:00.000000000,2018-02-25 14:35:51.000000000,2017-12-24 23:18:18.000000000,121,0,0,517926,c25be040faa835a0084a39af7e36d8101fe24145,31,25,1,1,12670,Helen Walsh,walshh2,"VMAX doc - add manage and unmanage section

Adding manage and unmanage section

Change-Id: I11c0932c546d8edd0e6009c4e2668f50ac2008c1
Closes-Bug: #1729013
"
openstack%2Fcinder~master~I988370d702d87acde534670575d599159b48c58b,openstack/cinder,master,only_ignore_deleting_missing_backup_exception_when_file_not_exist,I988370d702d87acde534670575d599159b48c58b,Improve deleting-missing-backup exception handling,MERGED,2017-10-30 09:04:06.000000000,2018-02-25 14:35:50.000000000,2017-11-07 13:40:37.000000000,5,2,1,516219,851b60d89d38b67b17930699fbc1f21ef0cf3aaf,68,36,3,1,25169,Xiaojun Liao,wwba,"Improve deleting-missing-backup exception handling

When deleting missing backup, OSError could be checked to make
sure that the actual error was that the file does not exist.

Change-Id: I988370d702d87acde534670575d599159b48c58b
Signed-off-by: Xiaojun Liao <xiaojunliao85@gmail.com>
"
openstack%2Fcinder~master~Ic9e724fcda83fea384406f45f792f7a2d4b979bb,openstack/cinder,master,bp/smbfs-fixed-images,Ic9e724fcda83fea384406f45f792f7a2d4b979bb,SMBFS: add fixed image support,MERGED,2017-10-24 13:13:46.000000000,2018-02-25 14:35:48.000000000,2017-11-22 19:35:47.000000000,80,21,0,514659,54c2787132396a73a45682133f66777ba1eb2085,137,39,6,5,26415,Alexandru Muresan,amuresan,"SMBFS: add fixed image support

The SMBFS driver currently supports only dynamic vhd/x images.

This change will allow configuring the driver to use fixed images
using the 'nas_volume_prov_type' config option.

Note that fixed images will always be zeroed out. We recommend
placing the images on ReFS/SSD backed storage.

Implements: blueprint smbfs-fixed-images

Change-Id: Ic9e724fcda83fea384406f45f792f7a2d4b979bb
"
openstack%2Fcinder~master~I970443c16028d4d3e6bed648c2e188fe65a158fa,openstack/cinder,master,,I970443c16028d4d3e6bed648c2e188fe65a158fa,Remove unused print_function imports,MERGED,2017-11-02 15:07:17.000000000,2018-02-25 14:35:47.000000000,2017-11-03 06:59:16.000000000,0,4,0,517344,7ec31c90c12d0e1eb7cc8b5522dbc37a5e661b36,52,37,1,2,4523,Eric Harney,eharney,"Remove unused print_function imports

This is not needed in these files.

TrivialFix

Change-Id: I970443c16028d4d3e6bed648c2e188fe65a158fa
"
openstack%2Fcinder~master~Ia0f426a257bbaf3c1512c716619fdaa646a9e19c,openstack/cinder,master,,Ia0f426a257bbaf3c1512c716619fdaa646a9e19c,ScaleIO: Update CI Wiki name,MERGED,2017-11-01 13:01:14.000000000,2018-02-25 14:35:46.000000000,2017-11-02 16:48:04.000000000,1,1,0,516986,5e9e1d5f924a26024ae869cdf239241904e0f91f,37,29,1,1,25033,Eric Young,tssgery,"ScaleIO: Update CI Wiki name

The ScaleIO CI Wiki has been renamed to account for the
Dell EMC merger and accompanying branding changes.

Change-Id: Ia0f426a257bbaf3c1512c716619fdaa646a9e19c
"
openstack%2Fcinder~master~I59849d0b5b1ec6636ad1e1af004277fcfa319473,openstack/cinder,master,bug/1659568,I59849d0b5b1ec6636ad1e1af004277fcfa319473,Update setup instructions,MERGED,2017-10-27 01:49:47.000000000,2018-02-25 14:35:42.000000000,2017-11-03 13:29:55.000000000,6,2,6,515564,38e5e7376b797fe3654c3e60591c65b9e0968352,110,37,7,1,25376,zhuangzejian,smartu3,"Update setup instructions

Add python3-dev instructions for Ubuntu16.04.
Verified thos packages in new version and drop Ubuntu12.04 tag.

Change-Id: I59849d0b5b1ec6636ad1e1af004277fcfa319473
Close-Bug: #1659568
"
openstack%2Fcinder~master~Ibc8b1c5a967d05b3e52f992a1e76e74c9120e3f1,openstack/cinder,master,bug/1728457,Ibc8b1c5a967d05b3e52f992a1e76e74c9120e3f1,Use total reserved quota value instead of partial,MERGED,2017-10-31 05:26:20.000000000,2018-02-25 14:35:16.000000000,2017-11-01 14:27:36.000000000,5,3,1,516515,ead1cee88b14de487537f528b0c5631407d320a0,92,37,3,1,24131,Abhishek Sharma M,abhi.sharma,"Use total reserved quota value instead of partial

While reserving snapshot we reserve gigabytes too. In case of
group snapshot we reserve the total gigabytes but in case of an
exception we print just the last volume gb info which needs to be
changed.

Change-Id: Ibc8b1c5a967d05b3e52f992a1e76e74c9120e3f1
Closes-Bug: 1728457
"
openstack%2Fcinder~driverfixes%2Focata~I1f0adaa8e25cd3ec74084b22bbe1573b92713959,openstack/cinder,driverfixes/ocata,bug/1661154,I1f0adaa8e25cd3ec74084b22bbe1573b92713959,Dell EMC PS: Optimize parsing of capacity info from backend,MERGED,2017-10-23 15:46:17.000000000,2018-02-25 14:34:59.000000000,2017-11-03 02:36:47.000000000,14,5,1,514364,9a0a74c30f0954627f77223ec36a4927751aaf8b,52,20,5,2,10379,Rajini Karthik,rajinir,"Dell EMC PS: Optimize parsing of capacity info from backend

The backend api returns large amounts of information and
times out when there are lots of volumes. Accelerated the
process by terminating the parsing after the capacity info
is retrieved.

Closes Bug: #1661154

Change-Id: I1f0adaa8e25cd3ec74084b22bbe1573b92713959
(cherry picked from commit a9a0c2ee2e973d0594f2707d64846e882e179c94)
"
openstack%2Fcinder~master~Ib3dbc781ed4710c5c2453e4454421f23997c4402,openstack/cinder,master,bug/1727960,Ib3dbc781ed4710c5c2453e4454421f23997c4402,DS8K: update replication_status in generic group APIs,MERGED,2017-10-30 09:08:55.000000000,2018-02-25 14:34:58.000000000,2017-11-29 01:11:48.000000000,61,25,0,516221,26633df36006b7ed6054d936290683afc035da95,56,40,1,2,26422,Peng Wang,wangpeng,"DS8K: update replication_status in generic group APIs

In create_group and create_group_from_src, DS8K driver forgot to update
replication_status of group and its volumes if their type have enabled
replication, this patch tries to fix them.

Change-Id: Ib3dbc781ed4710c5c2453e4454421f23997c4402
Closes-Bug: 1727960
"
openstack%2Fcinder~driverfixes%2Fnewton~Id5122dd9be973000831598fddc9e6f084ec2b7db,openstack/cinder,driverfixes/newton,backport-compatibility-issue-fix-to-N,Id5122dd9be973000831598fddc9e6f084ec2b7db,Fix a compatibility issue after Huawei driver upgrade,MERGED,2017-09-07 01:05:52.000000000,2018-02-25 14:34:53.000000000,2017-10-28 14:10:13.000000000,3,3,1,501503,6c5bb4ddda01d0f563609ad878dfe1499635770c,47,20,3,1,16203,zengyingzhe,zengyingzhe,"Fix a compatibility issue after Huawei driver upgrade

Previously Huawei driver changed the storing place for it's private
data, if upgrade to this new version driver, and there's already an
existing volume created by old driver, there's a compatibility issue
of getting hypermetro_id property, which will result deleting volume
failed while there's no hypermetro configuration exist.

This patch fixes this issue.

Change-Id: Id5122dd9be973000831598fddc9e6f084ec2b7db
(cherry picked from commit 083dfbbc8109924786ecc9f0c96559aa22041d4f)
(cherry picked from commit 96d6dae34f7f4696553928ac30b50f9d44e944f3)
(cherry picked from commit 18814a478d348acc65503ca1a6d31a07a63dbbb0)
"
openstack%2Fcinder~stable%2Fpike~I5b31082296f5bff5089d0f42a62d44bb009d177d,openstack/cinder,stable/pike,feature/fix-fz-bug,I5b31082296f5bff5089d0f42a62d44bb009d177d,Move 'zoning_mode' back to DEFAULT section,MERGED,2017-10-24 08:09:03.000000000,2018-02-25 14:34:51.000000000,2017-10-27 05:11:39.000000000,3,2,0,514555,85a963a5c68a12efe7a7251689028e0b2bd398a9,68,22,4,1,24952,Vivek Soni,sonivi,"Move 'zoning_mode' back to DEFAULT section

We moved 'zoning_mode' option to 'backend_defaults'
section since patch: [1]. But it has two issues:

1. It can not work because we still fetch the value
from the default section [2].
2. From the view of our current design. It's only
used in our framework code, which means it still can
not work if we overwrite the default value in one
specific backend section, such as:

[backend_defaults]
zoning_mode=fabric
[lvmbackend_1]
zoning_mode=other_value

Move this option back to DEFAULT section until we
need to.

Closes-Bug: #1724418

[1]: https://review.openstack.org/#/c/453654/
[2]: https://github.com/openstack/cinder/blob/master/cinder/zonemanager/utils.py#L56

Change-Id: I5b31082296f5bff5089d0f42a62d44bb009d177d
(cherry picked from commit 34287e3fa351db5e5b00cd0cf1affac07d9e6d34)
"
openstack%2Fcinder~driverfixes%2Fnewton~Iee27c0368522c90525a4b8ad757f9fb89dc293a0,openstack/cinder,driverfixes/newton,backport-migration-issue-to-N,Iee27c0368522c90525a4b8ad757f9fb89dc293a0,Fix a migration issue of Huawei driver,MERGED,2017-10-26 06:20:53.000000000,2018-02-25 14:34:45.000000000,2017-10-28 14:10:11.000000000,17,12,0,515287,83307e743b07928306b2a22fb0033289c08a59f4,17,13,1,2,16203,zengyingzhe,zengyingzhe,"Fix a migration issue of Huawei driver

While migrating volume crossing backends by the host-based way,
after data copying is done, Huawei driver's update_migrated_volume
method doesn't return the provider_location property, which
results old and new volumes' provider_locations aren't swapped as
expected, afterwards, while deleting the old volume, new volume's
provider_location will be used and the if-volume-exist-check fails
because it verifies the new volume's LUN ID actually on the old
backend, which certainly doesn't exist.

This patch fixes this issue.

Change-Id: Iee27c0368522c90525a4b8ad757f9fb89dc293a0
(cherry picked from commit 011daa9b463043a15f9e97986ecce6233ac72de5)
(cherry picked from commit f811487fca78d934b19baeb3e8aba3439d7e9db2)
"
openstack%2Fcinder~master~Ib255407f9bf384935b232e8aa3941c22e91eefef,openstack/cinder,master,DellSCPS_ciwiki,Ib255407f9bf384935b232e8aa3941c22e91eefef,Dell EMC: Update PS and SC CI wiki names,MERGED,2017-10-25 18:16:41.000000000,2018-02-25 14:34:43.000000000,2017-10-27 02:49:15.000000000,3,3,3,515159,8f8b7ee8b139c5c8d2c2cdcf344b3125bba1e842,56,36,2,3,10379,Rajini Karthik,rajinir,"Dell EMC: Update PS and SC CI wiki names

Updated the new thrid party CI systems wiki names

Change-Id: Ib255407f9bf384935b232e8aa3941c22e91eefef
"
openstack%2Fcinder~stable%2Fpike~I945300cac84658bbd25182ba615645af881920f8,openstack/cinder,stable/pike,bug/1724929,I945300cac84658bbd25182ba615645af881920f8,ScaleIO Driver - include snap usage in provisioned capacity,MERGED,2017-10-24 23:25:12.000000000,2018-02-25 14:34:38.000000000,2017-10-30 22:35:04.000000000,4,0,0,514860,a36d041c2afa2549f50e7674a054d096af10b9f1,29,17,2,2,25033,Eric Young,tssgery,"ScaleIO Driver - include snap usage in provisioned capacity

Provisioned capacity of storage pools was not correctly accounting
for space used by snapshots.

Change-Id: I945300cac84658bbd25182ba615645af881920f8
Closes-Bug: #1724929
(cherry picked from commit 64180530c14e1d0829788eda1ccb0efc938fbd8e)
"
openstack%2Fcinder~driverfixes%2Focata~I81dc6f1ac5855b21c10572797fd45a6b38641112,openstack/cinder,driverfixes/ocata,,I81dc6f1ac5855b21c10572797fd45a6b38641112,"Revert ""Tests: Fail if oslo.versionedobjects issues Invalid UUID warnings""",MERGED,2017-10-25 15:40:56.000000000,2018-02-25 14:34:37.000000000,2017-10-26 02:41:21.000000000,0,12,0,515111,a4d87d68013f8c56684ec3e315da89d658a23386,18,13,1,1,4523,Eric Harney,eharney,"Revert ""Tests: Fail if oslo.versionedobjects issues Invalid UUID warnings""

This is currently causing unit test failures since
pymysql _show_warnings calls
    warnings.warn(err.Warning(*w[1:3]), stacklevel=4)
and this code assumes that the warnings are strings.

This reverts commit ed6d50bed642b01d005563866ab9f211632cff5b.

Change-Id: I81dc6f1ac5855b21c10572797fd45a6b38641112
(cherry picked from commit cc6c5b10867544ec0e2cbc73802ec8ee6213bc7a)
"
openstack%2Fcinder~master~I17537742a4c1421f2bd0561d2c48c5ae56d89026,openstack/cinder,master,remove-builds,I17537742a4c1421f2bd0561d2c48c5ae56d89026,Remove doc/build before running docs job,MERGED,2017-10-17 06:58:02.000000000,2018-02-25 14:34:35.000000000,2017-10-27 00:19:44.000000000,1,1,2,512507,b7048784b1bb152e69ab195dfa76c1e7a376b1f7,56,27,3,1,25456,junboli,junboli,"Remove doc/build before running docs job

Clear doc/build directory before running docs job may better guarantee
each building output the newest docs.

Change-Id: I17537742a4c1421f2bd0561d2c48c5ae56d89026
"
openstack%2Fcinder~master~I81dc6f1ac5855b21c10572797fd45a6b38641112,openstack/cinder,master,,I81dc6f1ac5855b21c10572797fd45a6b38641112,"Revert ""Tests: Fail if oslo.versionedobjects issues Invalid UUID warnings""",MERGED,2017-10-23 19:46:33.000000000,2018-02-25 14:34:14.000000000,2017-10-24 14:19:46.000000000,0,12,0,514442,cc6c5b10867544ec0e2cbc73802ec8ee6213bc7a,37,29,1,1,4523,Eric Harney,eharney,"Revert ""Tests: Fail if oslo.versionedobjects issues Invalid UUID warnings""

This is currently causing unit test failures since
pymysql _show_warnings calls
    warnings.warn(err.Warning(*w[1:3]), stacklevel=4)
and this code assumes that the warnings are strings.

This reverts commit ed6d50bed642b01d005563866ab9f211632cff5b.

Change-Id: I81dc6f1ac5855b21c10572797fd45a6b38641112
"
openstack%2Fcinder~master~I862ec2d06c169562aa8bbc95ab202cd5eb88440d,openstack/cinder,master,infinidat,I862ec2d06c169562aa8bbc95ab202cd5eb88440d,INFINIDAT: add support for overprovisioning,MERGED,2017-09-05 12:05:28.000000000,2018-02-25 14:33:42.000000000,2017-10-26 14:37:03.000000000,20,2,2,500783,88080cb45c1aaadae3aa284384ce595ff4a9a067,168,44,5,3,22683,Arnon Yaari,arnony,"INFINIDAT: add support for overprovisioning

The driver reports max_over_subscription_ratio as defined by the user
in the cinder configuration file, in addition to whether the volumes
are thin-provisioned or not. This allows overprovisioning in
thin-provisioned volumes in InfiniBox.

Change-Id: I862ec2d06c169562aa8bbc95ab202cd5eb88440d
"
openstack%2Fcinder~master~I597971a29ec61a1bf8c991b2715ec7644b2e2692,openstack/cinder,master,bp/policy-in-code,I597971a29ec61a1bf8c991b2715ec7644b2e2692,Add policy documentation and sample file,MERGED,2017-10-16 07:01:43.000000000,2018-02-25 14:33:41.000000000,2017-10-26 05:54:09.000000000,58,21,6,512187,988f79479e012ea5378f4c154a041f6000785a43,89,31,5,13,23083,TommyLike,TommyLike,"Add policy documentation and sample file

This patch adds documentation and sample
file for default policy in code feature.

Change-Id: I597971a29ec61a1bf8c991b2715ec7644b2e2692
Partial-Implements: blueprint policy-in-code
"
openstack%2Fcinder~stable%2Fpike~I4c154b15991fd624d91bd3e3472d25c714fb8525,openstack/cinder,stable/pike,bug/1722769-stable/pike,I4c154b15991fd624d91bd3e3472d25c714fb8525,DS8000 ConsistencyGroup failed to update group with volumes,MERGED,2017-10-19 10:55:08.000000000,2018-02-25 14:33:39.000000000,2017-10-29 23:08:51.000000000,1,1,0,513350,388fb6b87dbfdabfc090622fc128cbc1275f1c52,18,13,1,1,20050,MonicaJoshi,MonicaJoshi,"DS8000 ConsistencyGroup failed to update group with volumes

While adding a volume to ConsistencyGroup the failed with TypeError: sequence
item 0: expected string, tuple found.  This could have happened if the driver
did not find the specified LSS pairs matching that of the available volume
pools.  The driver intended to throw an error message with available_lss_pairs
but failed to concatinate the data to the error message with TypeError
exception.

The proposed fix attempts to address this issue by simplifying the
concat of available_lss_pairs as string and then adding to error message.

Closes-bug: #1722769

Change-Id: I4c154b15991fd624d91bd3e3472d25c714fb8525
(cherry picked from commit 75a1849c9854cd5f8d366de6087e50eff9b595e4)
"
openstack%2Fcinder~master~I149a9de82fc1003b88e0c0852a0b64634f0c622e,openstack/cinder,master,bug/1540750,I149a9de82fc1003b88e0c0852a0b64634f0c622e,"Add index for reservations on (deleted, uuid)",MERGED,2016-02-02 07:34:19.000000000,2018-02-25 14:33:38.000000000,2017-10-18 22:10:03.000000000,42,0,2,275047,12819a1b6d78f253f795e7992b93ebfb8347e884,156,69,5,3,11676,wuyuting,wuyuting,"Add index for reservations on (deleted, uuid)

The query for uuid_reservations currently does a full table scan.
This adds an index so frequent invocations of uuid does not bog
down the database.

Change-Id: I149a9de82fc1003b88e0c0852a0b64634f0c622e
Closes-Bug: #1540750
"
openstack%2Fcinder~stable%2Fpike~I1946dc0ad9cb7a68072a39816fa9fa224c2eb6a5,openstack/cinder,stable/pike,bug/1692775,I1946dc0ad9cb7a68072a39816fa9fa224c2eb6a5,Run backup compression on native thread,MERGED,2017-10-18 12:30:41.000000000,2018-02-25 14:33:36.000000000,2017-10-18 21:50:29.000000000,49,4,0,513016,439f90da8e4c1cfa1acfe36b5ea8a6c5bae6139f,12,7,1,4,9535,Gorka Eguileor,Gorka,"Run backup compression on native thread

Backup data compression is a CPU bound operation that will not yield to
other greenthreads, so given enough simultaneous backup operations they
will lead to other threads' starvation.

This is really problematic for DB connections, since starvation will
lead to connections getting dropped with errors such as ""Lost connection
to MySQL server during query"".

Detailed information on why these connections get dropped can be found
in comment ""[31 Aug 2007 9:21] Magnus Blåudd"" on this MySQL bug [1].

These DB issues may result in backups unnecessary ending in an ""error""
state.

This patch fixes this by moving the compression to a native thread so
the cooperative multitasking in Cinder Backup can continue switching
threads.

[1] https://bugs.mysql.com/bug.php?id=28359

Closes-Bug: #1692775
Closes-Bug: #1719580
Change-Id: I1946dc0ad9cb7a68072a39816fa9fa224c2eb6a5
(cherry picked from commit af0f00bc52f79d9395adfe0575b0dbe353e18bbe)
"
openstack%2Fcinder~master~Id66d3f0fe36cf7c32ef3875bf5fcb1c7a4678273,openstack/cinder,master,bp/remotefs-revert-snapshot,Id66d3f0fe36cf7c32ef3875bf5fcb1c7a4678273,RemoteFS: revert snapshot support,MERGED,2017-10-06 08:33:06.000000000,2018-02-25 14:33:35.000000000,2017-11-15 12:56:18.000000000,191,6,12,510016,413664d11ca002c49a41c9d2e2efa85afeaca791,162,45,7,5,26415,Alexandru Muresan,amuresan,"RemoteFS: revert snapshot support

This change implements the 'revert_to_snapshot' method at the remotefs
base driver level in a generic way. This should work right away with
most (if not all) remotefs based drivers.

Note that we only consider the case in which the latest snapshot is
being reverted (the Cinder API won't allow reverting volumes to other
snapshots anyway, at least for the time being).

The RemoteFS based drivers (e.g. NFS driver, SMB driver) use COW images
(e.g. qcow2, differencing vhdx) in order to provide volume snapshot
functionality. Reverting a volume to its latest snapshot is a trivial
operation in this case and can be achived by simply cleaning up (e.g.
recreating) the latest image from chain.

In order to avoid breaking drivers, the 'revert_to_snapshot' method
is implemented in a mixin that may be inherited by any RemoteFS based
driver.

Implements: blueprint remotefs-revert-snapshot

Change-Id: Id66d3f0fe36cf7c32ef3875bf5fcb1c7a4678273
"
openstack%2Fcinder~master~I4b8d99966f387f51c1125ba72c1ce149229a8bc0,openstack/cinder,master,flashsystem_hostmap,I4b8d99966f387f51c1125ba72c1ce149229a8bc0,FlashSystem: Add CMMVC6045E CLI error for multi-host mapping,MERGED,2017-10-12 23:20:50.000000000,2018-02-25 14:33:33.000000000,2017-10-27 03:54:29.000000000,72,13,2,511645,421837ab4a3244022ad8292ad1ef0de37e9de532,67,28,3,2,27059,John Cates,jccates,"FlashSystem: Add CMMVC6045E CLI error for multi-host mapping

Add CMMVC6045E to list of CLI error codes indicating a multi-host
map was attempted without the '-force' parameter. Re-raise on
match failure to avert spurious success when an unexcepted CLI
error is emitted. Add good and bad-path testing for multi-host
map to test_flashsystem_map_vdisk_to_host

Change-Id: I4b8d99966f387f51c1125ba72c1ce149229a8bc0
Closes-Bug: #1723188
"
openstack%2Fcinder~master~I04b188d1300979b3b4b070781c6c2105f638b649,openstack/cinder,master,bug/1706729,I04b188d1300979b3b4b070781c6c2105f638b649,NEC driver: Never use target info in migration_status,MERGED,2017-10-13 07:06:53.000000000,2018-02-25 14:33:31.000000000,2017-10-20 20:28:44.000000000,75,124,1,511737,a638f483fb41df4f4acc0b0f42d289ba711333e5,74,32,3,2,23885,Shunei Shiono,s-shiono,"NEC driver: Never use target info in migration_status

NEC driver uses target info in migration_status at volume creation.
The target info will be deleted from migration_status in future
cinder version. This patch change the driver not to use target info
in migration_status.

Change-Id: I04b188d1300979b3b4b070781c6c2105f638b649
Partial-Bug: #1706729
"
openstack%2Fcinder~driverfixes%2Fnewton~Ie927d2ee5f1f1a61d8309049ea7630f73f614cc5,openstack/cinder,driverfixes/newton,bug/1659600,Ie927d2ee5f1f1a61d8309049ea7630f73f614cc5,Dell EMC SC: Delete doesn't account for migration,MERGED,2017-10-16 16:27:44.000000000,2018-02-25 14:33:14.000000000,2017-10-30 19:46:40.000000000,46,11,0,512349,9cbe5748674cf897be09df92b174f87669fbc67a,17,13,1,4,9535,Gorka Eguileor,Gorka,"Dell EMC SC: Delete doesn't account for migration

The function delete_volume is unaware of migration. The volume object
sent down to delete_volume from retype with migration is a mix of the new
and old volumes. In addition to this the Dell EMC API function delete_volume
doesn't validate provider_id to ensure it is for the current back end.

Both of thse are fixed by this patch.

Change-Id: Ie927d2ee5f1f1a61d8309049ea7630f73f614cc5
Closes-Bug: #1659600
(cherry picked from commit 0a36a89bc8caac67777eda8dbbe344c52dc424c3)
"
openstack%2Fcinder~master~I1946dc0ad9cb7a68072a39816fa9fa224c2eb6a5,openstack/cinder,master,bug/1692775,I1946dc0ad9cb7a68072a39816fa9fa224c2eb6a5,Run backup compression on native thread,MERGED,2017-09-26 11:59:36.000000000,2018-02-25 14:32:56.000000000,2017-10-17 18:08:26.000000000,49,4,7,507510,af0f00bc52f79d9395adfe0575b0dbe353e18bbe,142,48,4,4,9535,Gorka Eguileor,Gorka,"Run backup compression on native thread

Backup data compression is a CPU bound operation that will not yield to
other greenthreads, so given enough simultaneous backup operations they
will lead to other threads' starvation.

This is really problematic for DB connections, since starvation will
lead to connections getting dropped with errors such as ""Lost connection
to MySQL server during query"".

Detailed information on why these connections get dropped can be found
in comment ""[31 Aug 2007 9:21] Magnus Blåudd"" on this MySQL bug [1].

These DB issues may result in backups unnecessary ending in an ""error""
state.

This patch fixes this by moving the compression to a native thread so
the cooperative multitasking in Cinder Backup can continue switching
threads.

[1] https://bugs.mysql.com/bug.php?id=28359

Closes-Bug: #1692775
Closes-Bug: #1719580
Change-Id: I1946dc0ad9cb7a68072a39816fa9fa224c2eb6a5
"
openstack%2Fcinder~master~I75d4ca19f87fe1930cf54b554b7e232632a4a21c,openstack/cinder,master,switch_to_stestr,I75d4ca19f87fe1930cf54b554b7e232632a4a21c,Switch from ostestr to stestr,MERGED,2017-09-29 21:44:37.000000000,2018-02-25 14:32:47.000000000,2017-10-15 22:00:51.000000000,8,5,3,508624,f93bc791bf0e788873dbdeaaa4f429b4f12f20e0,80,31,6,2,2243,John Griffith,john-griffith,"Switch from ostestr to stestr

This change just updates the tox.ini file to call stestr directly
instead of going through ostestr.

For more background you can read the ML posting:
    https://goo.gl/TFvcxy

So now you won't need `--n` to run single tests, and you can also
supply regex directly without even the `--`.  For example:
  `tox -epy27 $regex`

Change-Id: I75d4ca19f87fe1930cf54b554b7e232632a4a21c
"
openstack%2Fcinder~master~I4c24cd397f513648e2c2214fc4f87cf5367233ac,openstack/cinder,master,bp/disco-driver-update-option-name,I4c24cd397f513648e2c2214fc4f87cf5367233ac,Update configuration names in ITRI DISCO volume driver,MERGED,2017-05-02 07:47:32.000000000,2018-02-25 14:32:45.000000000,2017-10-13 18:24:57.000000000,36,6,10,461665,1a3f91662c383f105a74638c84655689ab5eac60,420,62,21,4,19576,Guy Kim,Guy,"Update configuration names in ITRI DISCO volume driver

This commit is to update and deprecate the name of some configuration
names:

* ""san_api_port"" is new config option added in san driver
* ""rest_ip"" is marked as deprecated and will be replaced with ""san_ip""
* ""disco_src_api_port"" is marked as deprecated and will be replaced with
  ""san_ssh_port""

It also includes the changes in the unit tests.

Change-Id: I4c24cd397f513648e2c2214fc4f87cf5367233ac
Implements: blueprint disco-driver-update-option-name
"
openstack%2Fcinder~master~I183ed48e3d66a45864a17bb9785745c64aefa626,openstack/cinder,master,openstack/requirements,I183ed48e3d66a45864a17bb9785745c64aefa626,Updated from global requirements,MERGED,2017-10-10 20:47:35.000000000,2018-02-25 14:32:44.000000000,2017-10-13 18:25:19.000000000,3,3,0,511028,186d7f5a7550fa5c45f63e0fd00e1b142684385f,98,34,6,2,11131,OpenStack Proposal Bot,proposal-bot,"Updated from global requirements

Change-Id: I183ed48e3d66a45864a17bb9785745c64aefa626
"
openstack%2Fcinder~master~Idf27d5fd09365374330ad0d4c0448f68f3cc03e8,openstack/cinder,master,policy-and-docs-in-code,Idf27d5fd09365374330ad0d4c0448f68f3cc03e8,[policy in code] Add support for qos and quota resources,MERGED,2017-09-28 09:02:58.000000000,2018-02-25 14:32:42.000000000,2017-10-15 16:54:41.000000000,253,55,3,508091,5a099de01a275e10426ef2b6e2c87836a2130b7b,96,34,5,9,23083,TommyLike,TommyLike,"[policy in code] Add support for qos and quota resources

This patch adds policy in code support for qos, quota,
quota class resources and depends on the group&group
snapshot patch.

[1]: https://review.openstack.org/#/c/507812/

Change-Id: Idf27d5fd09365374330ad0d4c0448f68f3cc03e8
Partial-Implements: blueprint policy-in-code
"
openstack%2Fcinder~master~Id6bee9e7d0da8ead224a04f86fe79ddfb5b286cf,openstack/cinder,master,bp/generic-backup-implementation,Id6bee9e7d0da8ead224a04f86fe79ddfb5b286cf,Add ability to specify backup driver via class name,MERGED,2017-06-26 09:54:51.000000000,2018-02-25 14:32:40.000000000,2017-10-13 04:45:47.000000000,56,24,4,477472,de2ffaff36e3713e3862b15816f59c4d3dd8abca,321,57,12,4,1736,Ivan Kolodyazhny,e0ne,"Add ability to specify backup driver via class name

This patch also deprecates backup driver initialization using module
name.

Change-Id: Id6bee9e7d0da8ead224a04f86fe79ddfb5b286cf
Related-Blueprint: generic-backup-implementation
"
openstack%2Fcinder~stable%2Fpike~I41697632d48f7cbcbe008867671f8196b5543c94,openstack/cinder,stable/pike,bug/1702291-stable/pike,I41697632d48f7cbcbe008867671f8196b5543c94,ibm-storage: enable FC zonning to all ports,MERGED,2017-10-10 17:30:23.000000000,2018-02-25 14:32:39.000000000,2017-10-12 20:17:51.000000000,40,14,0,510962,cbdcc242fd7985716ae984d53d583c483119014a,20,16,1,2,14532,Gerald McBrearty,gfm,"ibm-storage: enable FC zonning to all ports

During 'initialize_connection' we rely on the storage ability to know
which hosts can access it. This is in some cases not accurate. So we
need to enable hosts to connect to all the storage FC ports.

Change-Id: I41697632d48f7cbcbe008867671f8196b5543c94
Closes-Bug: #1702291
(cherry picked from commit 6d3d64c6bbafb57a8b34554d4baef115cc17d962)
"
openstack%2Fcinder~master~I861d61dd11f982a8a54b57b6a6c895e6ebe399c0,openstack/cinder,master,bug/1720063,I861d61dd11f982a8a54b57b6a6c895e6ebe399c0,VNX: Fix issue when creating without type,MERGED,2017-09-28 06:45:37.000000000,2018-02-25 14:32:38.000000000,2017-10-19 20:08:28.000000000,27,20,6,508064,5345f8cb9c8ec416aa5d764ea5ea47e3ff4d8d1d,203,45,5,2,10628,Peter Wang,peter_wang,"VNX: Fix issue when creating without type

When creating a volume without type, a error will be thrown:

AttributeError: 'NoneType' object has no attribute 'qos_specs'

This issue was introduced in qos patch:
https://review.openstack.org/#/c/441786/

Change-Id: I861d61dd11f982a8a54b57b6a6c895e6ebe399c0
Closes-bug: #1720063
"
openstack%2Fcinder~master~I2099b804a2043078e50a5a9e14c1497861576f61,openstack/cinder,master,bug/1720147,I2099b804a2043078e50a5a9e14c1497861576f61,Kaminario K2: Support duplicated FQDN in network,MERGED,2017-09-28 14:14:18.000000000,2018-02-25 14:32:09.000000000,2017-10-11 18:52:07.000000000,46,3,0,508167,baa8626eac9c975b719c03274d42b54ce3de74fe,119,43,2,3,9535,Gorka Eguileor,Gorka,"Kaminario K2: Support duplicated FQDN in network

The Kaminario K2 driver uses the FQDN of the node that is doing the
attach as an unique identifier to map the volume.

The problem is that the FQDN is not always unique, there are
environments where the same FQDN can be found in different systems, and
in those cases if both try to attach volumes the second system will
fail.

One example of this happening would be on a QA environment where you are
creating VMs and they all have names like controller-0.localdomain and
compute-0.localdomain.

This patch adds a configuration option to the K2 driver called
`unique_fqdn_network` to support these kind of environments.

Closes-Bug: #1720147
Change-Id: I2099b804a2043078e50a5a9e14c1497861576f61
"
openstack%2Fcinder~master~I2f9ee172306bf5a99575e0cb6f5eac0ea87b0483,openstack/cinder,master,fix-doc,I2f9ee172306bf5a99575e0cb6f5eac0ea87b0483,Switch base to the latest in doc link address,MERGED,2017-09-09 15:15:52.000000000,2018-02-25 14:31:54.000000000,2017-10-31 03:58:22.000000000,6,6,0,502249,dbb60106e75550b21d08f781de69fbcdf5eec9d1,76,35,3,6,25456,junboli,junboli,"Switch base to the latest in doc link address

Although we had some effort to fix these before, it still left lots
of outdated link address, this patch is to fix them all.

Change-Id: I2f9ee172306bf5a99575e0cb6f5eac0ea87b0483
"
openstack%2Fcinder~master~I93d5610013c17c5344de27d7f3ed5d5b89ba83ee,openstack/cinder,master,,I93d5610013c17c5344de27d7f3ed5d5b89ba83ee,Remove API check is_valid_body,MERGED,2017-10-03 20:38:22.000000000,2018-02-25 14:31:52.000000000,2017-10-10 04:24:07.000000000,28,64,0,509283,79d8f87ea679afab17347a6af828eef4b52e8e13,67,38,3,6,11904,Sean McGinnis,SeanM,"Remove API check is_valid_body

This boolean check was kept around for compatibility for the v1
API. New APIs use (or should use) the assert_valid_body call that
throws a valid exception for missing body elements.

Now that the v1 API has been removed, this removes is_valid_body
and makes sure all remaining instances to the assert call.

Change-Id: I93d5610013c17c5344de27d7f3ed5d5b89ba83ee
"
openstack%2Fcinder~master~I23867aa98f68298beb5db4558c66c1ffd4e7d6f1,openstack/cinder,master,ci_unsupported,I23867aa98f68298beb5db4558c66c1ffd4e7d6f1,Remove Hitachi volume drivers,MERGED,2017-09-26 23:45:37.000000000,2018-02-25 14:31:51.000000000,2017-10-10 14:15:41.000000000,6,18996,2,507709,55d726e5c366834a4dc3131326e9bd3850a6e22f,126,42,5,35,11904,Sean McGinnis,SeanM,"Remove Hitachi volume drivers

Hitachi has decided to provide their drivers out of tree [1]. The
drivers were marked as unsupported in-tree in the Pike release and
are now being removed.

[1] http://lists.openstack.org/pipermail/openstack/2017-March/018812.html

Change-Id: I23867aa98f68298beb5db4558c66c1ffd4e7d6f1
Closes-bug: #1652864
Closes-bug: #1671966
Closes-bug: #1677688
Closes-bug: #1677923
Closes-bug: #1645738
"
openstack%2Fcinder~master~I935990d09f1374a8789b2a0dad8e8a334aa39abc,openstack/cinder,master,ci_unsupported,I935990d09f1374a8789b2a0dad8e8a334aa39abc,Remove Violin volume drivers,MERGED,2017-09-06 16:03:26.000000000,2018-02-25 14:31:49.000000000,2017-10-08 03:19:08.000000000,1,4428,0,501334,46ee7ebdeb5bd5017c2e11a9c20fe5c160c76f36,135,44,3,15,11904,Sean McGinnis,SeanM,"Remove Violin volume drivers

These drivers were marked as deprecated and unsupported in Pike due to
lack of CI. This has not changed and they will now be removed.

Change-Id: I935990d09f1374a8789b2a0dad8e8a334aa39abc
"
openstack%2Fcinder~stable%2Fpike~I1e82bf9d0b6cc0fb1d1fc2dd8b8ccc59aea3f73f,openstack/cinder,stable/pike,bug/1706060,I1e82bf9d0b6cc0fb1d1fc2dd8b8ccc59aea3f73f,RBD: Fix stats reporting,MERGED,2017-09-06 15:31:27.000000000,2018-02-25 14:31:48.000000000,2017-10-06 13:19:44.000000000,196,83,0,501316,8d7f37e810d3228d8b79e4add1a383abe516d9bb,44,26,2,3,9535,Gorka Eguileor,Gorka,"RBD: Fix stats reporting

Current RBD code is incorrectly reporting the stats of the pool in the
following ways:

- `provisioned_capacity_gb` contains physical space used by cinder created
  volumes.
- `free_capacity_gb` is not taking into account that pools can have quota
  restrictions and they should be used as the reference for the free capacity.
- `total_capacity` dynamically changes, which means that there is no way to
  have a fixed over provisioning capacity.

This patch fixes the stats reporting making sure we return the right
values in `provisioned_capacity_gb` and `free_capacity_gb`, and allows
us to use a static calculation of the `total_capacity` using
`report_dynamic_total_capacity` configuration option.

We don't report `allocated_capacity_gb` because this is something that
is calculated by the Cinder core code and should not be reported by
drivers, even if it's not currently working as expected [1][2].

[1] https://bugs.launchpad.net/cinder/+bug/1712549
[2] https://bugs.launchpad.net/cinder/+bug/1706057

Change-Id: I1e82bf9d0b6cc0fb1d1fc2dd8b8ccc59aea3f73f
Closes-Bug: #1706060
(cherry picked from commit 8469109016bcfd5806e230202e1996a8ba649535)
Conflicts:
	cinder/tests/unit/volume/drivers/test_rbd.py
	cinder/volume/drivers/rbd.py
"
openstack%2Fcinder~master~I7d7c4f7d9f9cc94d9ef4e0d5d430513cb3581f16,openstack/cinder,master,use_refresh,I7d7c4f7d9f9cc94d9ef4e0d5d430513cb3581f16,Cleanup some todo's for refresh(),MERGED,2017-10-04 21:17:22.000000000,2018-02-25 14:31:46.000000000,2017-10-05 05:56:11.000000000,8,12,0,509640,250a529cfd3fe9b232a8d47e7d3419853fb2127a,33,29,1,2,11904,Sean McGinnis,SeanM,"Cleanup some todo's for refresh()

There were some TODO tags in the code to switch to using object refresh()
calls once that was available. We have that now, so clean up and switch a
few instances to call refresh instead of fetching a new object.

Change-Id: I7d7c4f7d9f9cc94d9ef4e0d5d430513cb3581f16
"
openstack%2Fcinder~driverfixes%2Focata~Ic4c7fd66858039db3f9d09a0babd5601b25a95e3,openstack/cinder,driverfixes/ocata,bug/1718762-driverfixes/ocata,Ic4c7fd66858039db3f9d09a0babd5601b25a95e3,Brocade: Add HTTP connection cleanup,MERGED,2017-10-04 19:51:33.000000000,2018-02-25 14:31:45.000000000,2017-10-28 03:05:01.000000000,5,1,0,509614,516b56ee13024e638338d92453cfbe8169f116e5,31,16,1,1,8757,Angela Smith,asmith_brcd,"Brocade: Add HTTP connection cleanup

Method for get device mapping opens
connection to the switch but does not
close the connection.  Add finally
block to close the session.

Closes Bug: #1718762

Change-Id: Ic4c7fd66858039db3f9d09a0babd5601b25a95e3
"
openstack%2Fcinder~master~Id5e59fce2ea5958bfcd4fbadb609f8f6cad42aa8,openstack/cinder,master,bug/1714503,Id5e59fce2ea5958bfcd4fbadb609f8f6cad42aa8,VMAX driver - remove WLP stats,MERGED,2017-09-01 13:46:11.000000000,2018-02-25 14:31:43.000000000,2017-10-04 23:46:01.000000000,16,138,1,500056,635e892cc8e7541e83697792c9f45d056460c845,94,44,3,4,12670,Helen Walsh,walshh2,"VMAX driver - remove WLP stats

Workload Planner(WLP) headroom calculations are not always accurate
for All Flash arrays. Because WLP is generally always enabled on
Unisphere, it is best use SRP calculations instead.

Change-Id: Id5e59fce2ea5958bfcd4fbadb609f8f6cad42aa8
Closes-Bug: #1714503
"
openstack%2Fcinder~master~I651699e42c28c05fc8fd71cfeef54d98839c1a29,openstack/cinder,master,isoformat_date,I651699e42c28c05fc8fd71cfeef54d98839c1a29,Generate create_at date in usage in isoformat for backups/snapshots,MERGED,2017-10-03 13:08:47.000000000,2018-02-25 14:31:29.000000000,2017-10-19 20:08:02.000000000,9,6,0,509169,ba8dc73cd2964fe81553e76df7bdf7d88d9a70ed,42,28,1,3,25568,Luis Pigueiras,lpigueiras,"Generate create_at date in usage in isoformat for backups/snapshots

Change the format of the dates when generating notifications
for snapshots and backups. This was generating a format problem
when inserting events into Elasticsearch via Panko, due to an invalid
format (YYYY-MM-DD HH:mm:ssZ to YYYY-MM-DDTHH:mm:ssZ)

Change-Id: I651699e42c28c05fc8fd71cfeef54d98839c1a29
"
openstack%2Fcinder~master~I008cd9089568c5ba084f9c1dacb1ab6e47fc7362,openstack/cinder,master,cisco-fc-zm-unsupported,I008cd9089568c5ba084f9c1dacb1ab6e47fc7362,Mark Cisco FC ZM driver as unsupported,MERGED,2017-09-28 19:20:23.000000000,2018-02-25 14:31:16.000000000,2017-10-27 21:28:02.000000000,18,0,0,508275,c92c428233df7b42bea05bf5468771c07fa8e51b,76,31,1,2,7198,Jay Bryant,jsbryant,"Mark Cisco FC ZM driver as unsupported

The Cisco Fibre Channel Zone Manager CI has not run
successfully during the required period:

Checking name: Cisco CI
  first seen: 2017-02-14 06:07:46 (226 days, 11:04:34 old)
  last seen: 2017-03-03 16:52:40 (209 days, 0:19:40 old)
  last success: 2017-02-23 17:09:46 (217 days, 0:02:34 old)
  Job cisco_zm_cinder 48% success out of 250 comments S=122, F=128
      last success: 2017-02-23 17:09:46 (217 days, 0:02:34 old)

Per Cinder's non-compliance policy, this patch marks the driver
as unsupported and deprecated.  The driver will be removed in
the next cycle if the problem is not corrected.

Change-Id: I008cd9089568c5ba084f9c1dacb1ab6e47fc7362
"
openstack%2Fcinder~master~Iccf87ee22c4e8dce03067fc3435aea1bbb33f61e,openstack/cinder,master,,Iccf87ee22c4e8dce03067fc3435aea1bbb33f61e,Reserve 5 migrations for DB backports,MERGED,2018-02-22 16:53:02.000000000,2018-02-25 14:31:08.000000000,2018-02-23 04:07:04.000000000,110,0,0,547068,139bb49770586a87f485f7a1038b76ad2c6d9a1c,43,33,1,5,4523,Eric Harney,eharney,"Reserve 5 migrations for DB backports

Reserve 5 database migrations in case we need to
backport changes to the stable/queens branch.

Change-Id: Iccf87ee22c4e8dce03067fc3435aea1bbb33f61e
"
openstack%2Fcinder~stable%2Fqueens~I117319ac12991e4b46170fe71d18a65ea4c98556,openstack/cinder,stable/queens,bug/1750074,I117319ac12991e4b46170fe71d18a65ea4c98556,Cinder logs rabbitmq password on connection log,MERGED,2018-02-17 19:15:18.000000000,2018-02-25 14:30:41.000000000,2018-02-20 22:32:38.000000000,1,0,0,545622,ca9bf2d1c56605a565ffc468bb91fb5d58ef5ce9,56,18,3,1,11269,Marga Millet,marga,"Cinder logs rabbitmq password on connection log

Cinder displays rabbitmq password if debug is enabled.

Closes-Bug: 1750074
Change-Id: I117319ac12991e4b46170fe71d18a65ea4c98556
(cherry picked from commit 919dd16a35ef2d0fd2ee4911398ba7830c02c6fd)
"
openstack%2Fcinder~master~I53e94a827c3ba31c7322e6faecfcc8ebf4a05b4a,openstack/cinder,master,add_multiattach_capability_to_solidfire,I53e94a827c3ba31c7322e6faecfcc8ebf4a05b4a,Add multiattach reporting to SolidFire,MERGED,2018-02-20 03:41:25.000000000,2018-02-25 14:30:21.000000000,2018-02-20 10:36:02.000000000,1,0,0,546023,0ab4bbccb83b0c6ab80ddb809239a7747981e43a,42,27,1,1,2243,John Griffith,john-griffith,"Add multiattach reporting to SolidFire

Wonders never cease!  Multiattach has landed, the cow jumped over
the moon and they put Humpty Dumpty back together again!

This change just addes multiattach=True to the SolidFire driver
now that everything has in fact landed.

Change-Id: I53e94a827c3ba31c7322e6faecfcc8ebf4a05b4a
"
openstack%2Fcinder~master~Id5a961c66a62e289a96daa7437374768ef407bb6,openstack/cinder,master,545978,Id5a961c66a62e289a96daa7437374768ef407bb6,Tests: Fix 3par tests with hash randomization,MERGED,2018-02-19 20:39:52.000000000,2018-02-25 14:30:15.000000000,2018-02-22 00:30:39.000000000,14,4,0,545978,91f19a8b75d7f95911e4762f7aeee984ba317f48,46,27,2,1,4523,Eric Harney,eharney,"Tests: Fix 3par tests with hash randomization

""fcwwns"" does not have a deterministic order -- account
for this in the unit test.

Change-Id: Id5a961c66a62e289a96daa7437374768ef407bb6
"
openstack%2Fcinder~master~I599b585444cbd51182d9f17fddd97bd91637e1e3,openstack/cinder,master,bug/1348818,I599b585444cbd51182d9f17fddd97bd91637e1e3,Tests: Fix NetApp tests with hash randomization,MERGED,2018-02-19 18:26:08.000000000,2018-02-25 14:30:12.000000000,2018-02-20 11:01:27.000000000,10,2,0,545949,3b13d77a263d787fce7d6e627ceda9e38fde2236,26,22,1,2,4523,Eric Harney,eharney,"Tests: Fix NetApp tests with hash randomization

Values in initiator target maps are ordered randomly depending
on the hash seed used -- account for this in unit tests.

Partial-Bug: #1715915

Change-Id: I599b585444cbd51182d9f17fddd97bd91637e1e3
"
openstack%2Fcinder~master~I4977ad687150b5a1d6f09a961fca4db5d768ef71,openstack/cinder,master,,I4977ad687150b5a1d6f09a961fca4db5d768ef71,Fix find -delete race in tox,MERGED,2018-02-19 18:08:09.000000000,2018-02-25 14:29:49.000000000,2018-02-20 00:35:19.000000000,1,1,0,545940,0368192a1f74f91c59739bab82dab1fddcd87c44,30,20,1,1,4523,Eric Harney,eharney,"Fix find -delete race in tox

If you launch py35 and py27 envs from the same
directory simultaneously, the find -delete commands
here will race against each other and cause a
failure.

Set the find option to ignore readdir races.

Change-Id: I4977ad687150b5a1d6f09a961fca4db5d768ef71
"
openstack%2Fcinder~master~I49a5e61345ce7c90a527367ae69a28ac04295865,openstack/cinder,master,use_correct_oslodb_fixtures,I49a5e61345ce7c90a527367ae69a28ac04295865,Use oslo_db.sqlalchemy.test_fixtures,MERGED,2018-02-19 15:52:44.000000000,2018-02-25 14:29:47.000000000,2018-02-19 22:42:58.000000000,26,7,0,545860,97bc3cb0c30ac8d6f394ce1dd5c04d1df425e908,32,20,3,1,11816,mike_mp@zzzcomputing.com,zzzeek,"Use oslo_db.sqlalchemy.test_fixtures

The change in Iaf77db73e368aee0d09b4c8e76f180f394f1aa37
makes use of oslo_db.tests.*, which was not the intent of the
deprecations added to oslo_db in
I0163e637ffef6d45d2573ebe29b5438911d01fce.   Make use of the
newer fixtures in oslo_db.sqlalchemy.test_fixtures which is
what was intended to supersede oslo_db.sqlalchemy.test_base.

Change-Id: I49a5e61345ce7c90a527367ae69a28ac04295865
"
openstack%2Fcinder~master~I68f78dc37973a5f29f4ef110b4ff08716f2288be,openstack/cinder,master,bug/1749953,I68f78dc37973a5f29f4ef110b4ff08716f2288be,Tests: Fix python version check,MERGED,2018-02-16 19:44:34.000000000,2018-02-25 14:29:33.000000000,2018-02-16 23:44:21.000000000,2,1,0,545441,3f0ccb746270e86bde9daeb61534e50b062f074e,28,23,1,1,4523,Eric Harney,eharney,"Tests: Fix python version check

This version check assumes that there will
never be a version of Python 3 after 3.5...

Related-Bug: #1749953

Change-Id: I68f78dc37973a5f29f4ef110b4ff08716f2288be
"
openstack%2Fcinder~driverfixes%2Fnewton~I5c6ad150543213acfd0c78dbbdb1dc1584d22d26,openstack/cinder,driverfixes/newton,bug/1632333,I5c6ad150543213acfd0c78dbbdb1dc1584d22d26,NetApp ONTAP: Copy offload bugfix,MERGED,2018-02-09 10:39:36.000000000,2018-02-25 14:28:58.000000000,2018-02-20 15:13:23.000000000,141,172,0,542771,5840e0e654e4c87e3d673b2a25c199e84a4af80c,54,19,5,4,10058,Erlon R. Cruz,sombrafam,"NetApp ONTAP: Copy offload bugfix

When 'NetApp NFS Copy Offload' tool is configured to download Glance
images, these images are downloaded twice because the tool is doing
the job after Cinder has already done it.
This patch fixes the bug by executing the copy offload tool inside the
clone_image function instead of using the copy_image_to_volume.

Closes-bug: #1632333
Depends-on: https://review.openstack.org/542773

Change-Id: I5c6ad150543213acfd0c78dbbdb1dc1584d22d26
(cherry-picked from commit c27173bad69da4889a5237cf2becc14bb6fc578a)
"
openstack%2Fcinder~master~I0a350c94ed4637c59b82dfad3926714451e37abb,openstack/cinder,master,remove_mapping,I0a350c94ed4637c59b82dfad3926714451e37abb,Remove legacy driver name mappings,MERGED,2018-02-14 22:00:31.000000000,2018-02-25 14:28:50.000000000,2018-02-20 11:02:17.000000000,0,24,0,544708,f01c5c96a7d388f6575716cac08b85c9a5aea051,48,35,1,1,11904,Sean McGinnis,SeanM,"Remove legacy driver name mappings

We have several drivers that were renamed in Ocata, and one
(Dell EMC SC Series) that was renamed in Pike. Since this
has been over two releases, we can now remove the legacy
name mapping for these drivers.

Change-Id: I0a350c94ed4637c59b82dfad3926714451e37abb
"
openstack%2Fcinder~stable%2Fqueens~If65300e0686ee5a0977e27380369d1638cd36e7e,openstack/cinder,stable/queens,bp/multi-attach-v3-attach,If65300e0686ee5a0977e27380369d1638cd36e7e,Enable multiattach capability for the zfssa driver,MERGED,2018-02-14 17:27:26.000000000,2018-02-25 14:28:48.000000000,2018-02-15 05:38:39.000000000,1,0,0,544561,b5ba21cd7bbd09880a216d12a871d413fbd84130,23,19,1,1,7198,Jay Bryant,jsbryant,"Enable multiattach capability for the zfssa driver

Enable multiattach capability for the zfssa driver.

Related to blueprint multi-attach-v3-attach

Change-Id: If65300e0686ee5a0977e27380369d1638cd36e7e
(cherry picked from commit 228015300fea1173c35e357ff48af69c7857bc94)
"
openstack%2Fcinder~stable%2Fqueens~I4a59ed298ba2542dcb4d6787b47085749a34244e,openstack/cinder,stable/queens,rebase-logs-queens,I4a59ed298ba2542dcb4d6787b47085749a34244e,Improve logs on scheduler,MERGED,2018-02-13 12:17:18.000000000,2018-02-25 14:28:35.000000000,2018-02-19 22:43:02.000000000,33,7,0,543913,525191ab0f6e6a472d18505820400cf56e2e3dd1,25,20,1,2,10058,Erlon R. Cruz,sombrafam,"Improve logs on scheduler

Scheduler decisions still not easy to track due lacking of information
about backends and pools. This adds more verbose information on that
so we can have a better means to help debug problems.

TrivialFix

Change-Id: I4a59ed298ba2542dcb4d6787b47085749a34244e
(cherry picked from commit 9c4cd4a2d75d36145f68e08d3aa28f9a45a68f48)
"
openstack%2Fcinder~master~I3c27fa7aa3e4649bad4627bfd8847005baa639af,openstack/cinder,master,cinder,I3c27fa7aa3e4649bad4627bfd8847005baa639af,Fix grammar error,MERGED,2018-02-11 03:25:51.000000000,2018-02-25 14:28:26.000000000,2018-02-22 00:29:55.000000000,1,1,1,543163,baa697f99825ce2fdd516ef72726449f06882892,36,30,1,1,27566,xulei,xuleibj,"Fix grammar error

modify 'a' to 'an'.

Change-Id: I3c27fa7aa3e4649bad4627bfd8847005baa639af
"
openstack%2Fcinder~master~I399215f4d3d95232cca79c742154ee44c3ca49c8,openstack/cinder,master,zanata/translations,I399215f4d3d95232cca79c742154ee44c3ca49c8,Imported Translations from Zanata,MERGED,2018-02-09 06:48:59.000000000,2018-02-25 14:28:16.000000000,2018-02-09 08:05:18.000000000,833,5,0,542632,37cf609ec63b13211c4f02bb99646ac3a66b0c29,32,24,1,3,11131,OpenStack Proposal Bot,proposal-bot,"Imported Translations from Zanata

For more information about this automatic import see:
https://docs.openstack.org/i18n/latest/reviewing-translation-import.html

Change-Id: I399215f4d3d95232cca79c742154ee44c3ca49c8
"
openstack%2Fcinder~stable%2Fqueens~Icbe0036410d7fa15b5b567d3c4a2429aafc6e391,openstack/cinder,stable/queens,create-queens,Icbe0036410d7fa15b5b567d3c4a2429aafc6e391,Update UPPER_CONSTRAINTS_FILE for stable/queens,MERGED,2018-02-08 17:27:02.000000000,2018-02-25 14:28:07.000000000,2018-02-13 14:51:47.000000000,3,3,0,542337,5546b519397e5c41503bbc7be51b1af15d8fdea7,27,18,1,1,22816,OpenStack Release Bot,release,"Update UPPER_CONSTRAINTS_FILE for stable/queens

The new stable upper-constraints file is only available
after the openstack/requirements repository is branched.
This will happen around the RC1 timeframe.

Recheck and merge this change once the requirements
repository has been branched.

The CI system will work with this patch before the requirements
repository is branched because zuul configues the job to run
with a local copy of the file and defaults to the master branch.
However, accepting the patch will break the test configuration
on developers' local systems, so please wait until after the
requirements repository is branched to merge the patch.

Change-Id: Icbe0036410d7fa15b5b567d3c4a2429aafc6e391
"
openstack%2Fcinder~stable%2Fpike~I987ff6f27c30c1ed53f6d6b592f3877f1f8c8ae2,openstack/cinder,stable/pike,zuulv3-projects,I987ff6f27c30c1ed53f6d6b592f3877f1f8c8ae2,Zuul: Remove project name,MERGED,2018-02-08 01:40:34.000000000,2018-02-25 14:28:04.000000000,2018-02-08 05:09:01.000000000,0,1,0,541975,7f4c4ae7f3aec433345136a777b2e91b076ec9dc,23,19,1,1,1,James E. Blair,corvus,"Zuul: Remove project name

Zuul no longer requires the project-name for in-repo configuration.
Omitting it makes forking or renaming projects easier.

Change-Id: I987ff6f27c30c1ed53f6d6b592f3877f1f8c8ae2
"
openstack%2Fcinder~master~I1a1920d141c8c32a8fb30bc6f73e955a1a1c5150,openstack/cinder,master,deprecate_hosts_api,I1a1920d141c8c32a8fb30bc6f73e955a1a1c5150,Deprecate Cinder Hosts API/Extension,MERGED,2018-02-07 16:41:19.000000000,2018-02-25 14:28:01.000000000,2018-02-08 00:09:22.000000000,14,0,1,541787,74746b3407684df6a6e687ce502ffdc7c57f44ab,54,36,3,2,2243,John Griffith,john-griffith,"Deprecate Cinder Hosts API/Extension

This was added a long long long long time ago, but it was never
fully implemented and is not used anywhere.  It might be worth
resurrecting and having, but it should probably be a first class
API rather than an extension, and if nothing else it would be good
if we want this to create a spec and have a real plan on it's
implementation and usage.

Bottom line, it's not used anywhere and the implementation is not
complete.  We could probably remove it safely, but let's deprecate
it and fast track removal and possible replacement next cycle.

Change-Id: I1a1920d141c8c32a8fb30bc6f73e955a1a1c5150
"
openstack%2Fcinder~master~Ia9cc9e20c3b333a054c90f07e952b61dfad8529e,openstack/cinder,master,bug/1743800,Ia9cc9e20c3b333a054c90f07e952b61dfad8529e,Api-ref: add 'all_tenants' API query option,MERGED,2018-01-19 00:17:24.000000000,2018-02-25 14:27:39.000000000,2018-02-07 05:29:41.000000000,31,1,0,535527,ba9eaf27aff1a17f0cf3234302b44c7cfc9d5dbf,61,32,2,15,22299,lihaijing,lihaijing,"Api-ref: add 'all_tenants' API query option

Cinder REST API allows one to use a special query parameter
named ""all_tenants"" to list resources from all projects (tenants)
through the REST API:

`/v3/{project_id}/volumes/detail?all_tenants=1`

However, this option is hardly documented anywhere besides
`/v3/{project_id}/volumes/summary`. So add them.

Change-Id: Ia9cc9e20c3b333a054c90f07e952b61dfad8529e
Closes-Bug: #1743800
"
openstack%2Fcinder~master~Id923e4c8cd5c79fbcf0599b8c0ba9fb6492c5ac0,openstack/cinder,master,fix_lvm_type,Id923e4c8cd5c79fbcf0599b8c0ba9fb6492c5ac0,Correct lvm_type default value in config doc,MERGED,2018-02-05 09:29:38.000000000,2018-02-25 14:27:29.000000000,2018-02-05 14:23:05.000000000,1,1,0,540787,4c6b91b44fe827aaf10b70d11162de07a357c0a7,29,23,1,1,25111,Dou Rui Yuan,rydou,"Correct lvm_type default value in config doc

According to code the default value of lvm_type should be ""auto"".

Change-Id: Id923e4c8cd5c79fbcf0599b8c0ba9fb6492c5ac0
"
openstack%2Fcinder~master~Idfb68b5ddd7aca8642016e392fec6efd169c1ea2,openstack/cinder,master,bp/multi-attach-volume,Idfb68b5ddd7aca8642016e392fec6efd169c1ea2,Add the nova-multiattach job to the check/gate queues,MERGED,2018-01-10 23:45:11.000000000,2018-02-25 14:26:46.000000000,2018-02-03 01:44:28.000000000,2,0,0,532695,939387799f9f88b5dd989e090fa0d6d9b95ccde0,126,47,2,1,6873,Matt Riedemann,mriedem,"Add the nova-multiattach job to the check/gate queues

The nova-multiattach job is defined in the nova repo
but we also need to run it against Cinder changes.

For now the job just runs the tempest compute API tests
since that's the only place in Tempest that has multiattach
testing right now and it will save some time in the CI run.

Change-Id: Idfb68b5ddd7aca8642016e392fec6efd169c1ea2
Depends-On: I51adbbdf13711e463b4d25c2ffd4a3123cd65675
"
openstack%2Fcinder~master~I88e9dad5cf36621c4b86acc7b7e972850e061119,openstack/cinder,master,bp/windows-smb-backup,I88e9dad5cf36621c4b86acc7b7e972850e061119,SMBFS: fix creating volume from snapshot,MERGED,2018-01-31 16:43:58.000000000,2018-02-25 14:26:32.000000000,2018-02-21 14:16:26.000000000,230,77,0,539593,8aa2f5a5b65d6b40ab297e6b6e5c840f86af7960,56,39,1,4,8543,Lucian Petrut,plucian,"SMBFS: fix creating volume from snapshot

In some cases, attempting to create a volume from an in-use snapshot
fails because of Hyper-V locks.

The reason is that in order to locate the backing image that needs
to be *cloned*, we may need to query the currently attached image,
which is not allowed.

In order to avoid this, we're going to store the backing file
information in the DB using the snapshot object metadata field,
at the same time preserving backwards compatibility.

Note that we cannot rely on model changes passed to the manager as
snapshots are used internally in a few cases in which the manager
would not expect snapshot object changes. Also, when deleting
snapshots, we're updating the metadata for more recent snapshots
as the backing file changes.

Fake volume/snapshot object usage throughout the smbfs driver unit
tests had to be updated due to the object changes performed by it.

Change-Id: I88e9dad5cf36621c4b86acc7b7e972850e061119
Closes-Bug: #1694635
"
openstack%2Fcinder~master~I62eeabf084ca8e63562bd10ac82066424ea61205,openstack/cinder,master,typo,I62eeabf084ca8e63562bd10ac82066424ea61205,Fix the typo in api_conditional_updates.rst,MERGED,2018-01-31 05:47:58.000000000,2018-02-25 14:26:18.000000000,2018-02-02 05:51:46.000000000,1,1,1,539419,317b1cc00266e5471c675d97d8013c20488cc029,51,29,3,1,27346,chenxiangui,chenxiangui,"Fix the typo in api_conditional_updates.rst

Fix a typo in api_conditional_updates.rst. It should be 'instead of what
is in' not 'instead of what is is'.

Change-Id: I62eeabf084ca8e63562bd10ac82066424ea61205
"
openstack%2Fcinder~master~Ic4afdd0d248e043107d92b8e42f7630d211cd302,openstack/cinder,master,bug/1746218,Ic4afdd0d248e043107d92b8e42f7630d211cd302,[VNX] `initiator_target_map` is None,MERGED,2018-01-31 08:02:11.000000000,2018-02-25 14:26:17.000000000,2018-02-07 23:55:37.000000000,2,1,0,539445,547bafcdb8716836310c77c15d10fb0a1356ad15,40,36,1,1,18742,Ryan Liang,RyanLiang,"[VNX] `initiator_target_map` is None

The value of `initiator_target_map` in FC target data returned by VNX is
None, which causes os-brick throwing exception. The fix is removing the
key `initiator_target_map` from the target data dict when its value is
None.

Change-Id: Ic4afdd0d248e043107d92b8e42f7630d211cd302
Closes-Bug: #1746218
"
openstack%2Fcinder~stable%2Fpike~I67ac11276715290839c39fc1d0e333c61a38c461,openstack/cinder,stable/pike,bug/1692775,I67ac11276715290839c39fc1d0e333c61a38c461,backup: set default swiftclient log level to WARN,MERGED,2018-01-26 12:17:52.000000000,2018-02-25 14:25:10.000000000,2018-02-04 00:34:45.000000000,9,0,0,538230,112ee583e0c4b6364e99fe15c00d82ec50ca0d6d,42,19,1,1,9535,Gorka Eguileor,Gorka,"backup: set default swiftclient log level to WARN

Similar to change I0857cecd7d8ab0ee7e3e9bd6e15f4987ede4d653, the
swift backup driver cannot be logging stuff while in a thread during
read and write operations. swiftclient logs requests and responses
at DEBUG level, which can cause a thread switch and break the backup
operation.

This sets a default log level of WARN for swiftclient for the
cinder-backup service.

Change-Id: I67ac11276715290839c39fc1d0e333c61a38c461
Closes-Bug: #1745168
(cherry picked from commit e4989c103ff23cbf937faa8cc12c39e9720f9fd7)
"
openstack%2Fcinder~stable%2Fpike~I1f1d9c0d6e3f04f1ecd5ef7c5d813005ee116409,openstack/cinder,stable/pike,bug/1692775,I1f1d9c0d6e3f04f1ecd5ef7c5d813005ee116409,Run backup-restore operations on native thread,MERGED,2018-01-23 23:08:29.000000000,2018-02-25 14:25:09.000000000,2018-02-04 18:23:52.000000000,104,39,0,537003,60bd878c3761b69311ef2732d37aaeeb3929a8e3,78,23,3,6,9535,Gorka Eguileor,Gorka,"Run backup-restore operations on native thread

During huge backup file read write operations holds the CPU which
leads to thread starvation, and cause cinder backup service to
report down, as DB operations are impacted.
Proposed changes are to run CPU and file sensitive operations like
read, write, compress, decompress on a native thread.

Change-Id: I1f1d9c0d6e3f04f1ecd5ef7c5d813005ee116409
Closes-Bug: #1692775
Co-Authored-By: Gorka Eguileor <geguileo@redhat.com>
(cherry picked from commit dd556fa755adca195e7df82477ae6400f693af14)
"
openstack%2Fcinder~stable%2Fpike~I0857cecd7d8ab0ee7e3e9bd6e15f4987ede4d653,openstack/cinder,stable/pike,bug/1692775,I0857cecd7d8ab0ee7e3e9bd6e15f4987ede4d653,Remove logging on Swift backup obj writer,MERGED,2018-01-25 10:44:37.000000000,2018-02-25 14:24:55.000000000,2018-02-03 20:30:39.000000000,17,7,0,537840,a1084c237a8b025353abaf586c05672840b6ec6d,70,22,1,2,9535,Gorka Eguileor,Gorka,"Remove logging on Swift backup obj writer

Since change I1f1d9c0d6e3f04f1ecd5ef7c5d813005ee116409 we are running
parts of the backups on native threads, which due to an eventlet bug [1]
have bad interactions with greenthreads, so we have to avoid any logging
when executing code in a native thread.

This patch removes the MD5 logging on the SwiftObjectWriter close
method and adds comments and docstring referring to this limitation.

[1] https://github.com/eventlet/eventlet/issues/432

Closes-Bug: #1745168
Change-Id: I0857cecd7d8ab0ee7e3e9bd6e15f4987ede4d653
(cherry picked from commit c6cb84bd63135d62ccd7ed9b23b245c41e9f105c)
"
openstack%2Fcinder~stable%2Fpike~I35834a43298b5287d5cd3c37baa82903bdffda12,openstack/cinder,stable/pike,bug/1743462,I35834a43298b5287d5cd3c37baa82903bdffda12,Fix: Propagate OS global request ID,MERGED,2018-01-24 09:42:33.000000000,2018-02-25 14:24:46.000000000,2018-02-06 21:16:20.000000000,1,0,0,537326,d9b38a4b23c21b92ed1c3a86a6201bd94c644c3d,26,17,1,1,9535,Gorka Eguileor,Gorka,"Fix: Propagate OS global request ID

Cinder doesn't propagate global request IDs internally, so any external
request that comes with it will have it logged at the API service and
then we'll lose this information in all the other services.

We are properly serializing this information on our RPC calls, but we
are not reconstructing the Context properly on the receiving end.

This patch ensures that the ""global_request_id"" field from the context
is properly added on RPC reception.

Closes-Bug: #1743462
Change-Id: I35834a43298b5287d5cd3c37baa82903bdffda12
(cherry picked from commit 28ada504af4084f72f3503d77806075e7ad509b0)
"
openstack%2Fcinder~stable%2Fpike~Idbfeeb2604bc84dc0a17c633b782000d94665bbe,openstack/cinder,stable/pike,bug/1692775,Idbfeeb2604bc84dc0a17c633b782000d94665bbe,Fix compression related tests,MERGED,2018-01-23 23:08:29.000000000,2018-02-25 14:24:13.000000000,2018-02-01 08:58:59.000000000,36,10,0,537002,96d0e2755d3c4b9251c7500e2d358bfc484345ad,37,19,1,3,9535,Gorka Eguileor,Gorka,"Fix compression related tests

Tests for chunked backup drivers are using a randomly generated file to
test the compression, which means that in most cases due to the
randomization the generated file is bigger than the original one, so we
end up doing a non compressed backup, which defeats the purpose of the
tests.  More so when you want to test the decompression, since the
backup won't be compressed and there won't be any decompression.

To fix this we generate, for those cases, a simple file that can always
be effectively compressed.

Change-Id: Idbfeeb2604bc84dc0a17c633b782000d94665bbe
(cherry picked from commit 8f3dfd7299a46be106d5b571c442a79986d66883)
"
openstack%2Fcinder~master~I67bc72891d5aec0161e20b2eefeedbe3a401e7c1,openstack/cinder,master,infinidat,I67bc72891d5aec0161e20b2eefeedbe3a401e7c1,INFINIDAT: support force detach,MERGED,2018-01-23 11:30:29.000000000,2018-02-25 14:24:12.000000000,2018-01-31 02:38:44.000000000,50,14,3,536778,1d24144959e42fafc604c9a3d4e16c048dbe0148,64,39,2,2,22683,Arnon Yaari,arnony,"INFINIDAT: support force detach

terminate_connection should support the case where ""connector"" is
None (force detach), in which case all volume connections should
be detached.

Change-Id: I67bc72891d5aec0161e20b2eefeedbe3a401e7c1
"
openstack%2Fcinder~master~Id4f77020a70acd8eb9df513d43f86d9fe78f7e22,openstack/cinder,master,,Id4f77020a70acd8eb9df513d43f86d9fe78f7e22,Run doc8 first,MERGED,2018-01-15 22:57:07.000000000,2018-02-25 14:24:09.000000000,2018-01-24 05:19:47.000000000,1,1,0,533814,12b6ccc8040268c72104243e1b620cfd1a91912a,66,34,2,1,4523,Eric Harney,eharney,"Run doc8 first

For ""tox -e docs"", run doc8 first.

doc8 runs much faster than sphinx builds and
will provide quick feedback on syntax issues.

Change-Id: Id4f77020a70acd8eb9df513d43f86d9fe78f7e22
"
openstack%2Fcinder~master~Id02130e9af8bdf90a712968916017d05c3213c32,openstack/cinder,master,bug/1463525,Id02130e9af8bdf90a712968916017d05c3213c32,RBD: Support encrypted volumes,MERGED,2018-01-17 15:20:25.000000000,2018-02-25 14:24:03.000000000,2018-01-25 05:12:20.000000000,227,16,22,534811,fcb45b439ba039fd88c332fd912949d52cfe290f,177,50,8,5,4523,Eric Harney,eharney,"RBD: Support encrypted volumes

When creating an encrypted RBD volume, initialize
LUKS on the volume using the volume's encryption key.

This is required because os-brick only handles this
step for volumes that attach via block devices.

This requires qemu-img 2.10.

Co-Authored-By: Lee Yarwood <lyarwood@redhat.com>
Related-Bug: #1463525
Implements: blueprint libvirt-qemu-native-luks
Change-Id: Id02130e9af8bdf90a712968916017d05c3213c32
"
openstack%2Fcinder~master~I7fc3ccd24cd9e95cb4fa1d70658fe064cae3a38a,openstack/cinder,master,536254,I7fc3ccd24cd9e95cb4fa1d70658fe064cae3a38a,Remove extra spaces of the volume creation request body,MERGED,2018-01-22 08:47:52.000000000,2018-02-25 14:23:52.000000000,2018-01-22 13:43:54.000000000,2,2,0,536254,23b56315b1e3f9ac7e8ab016c49ed3d4abf661f3,35,25,2,2,26458,Brin Zhang,zhangbailin,"Remove extra spaces of the volume creation request body

Change-Id: I7fc3ccd24cd9e95cb4fa1d70658fe064cae3a38a
"
openstack%2Fcinder~master~I0aba3760cd8f22dd0b19a45ecde06919af4a2447,openstack/cinder,master,bug/1744021,I0aba3760cd8f22dd0b19a45ecde06919af4a2447,"3PAR: fix volume migration for ""in-use"" volume.",MERGED,2018-01-18 10:56:58.000000000,2018-02-25 14:23:46.000000000,2018-01-19 10:26:25.000000000,40,5,0,535288,27176ea58c08c126d1cfd28a453ff8ff95497107,60,34,1,2,21407,Kushal Wathore,kwathore,"3PAR: fix volume migration for ""in-use"" volume.

3par driver does not support cross protocol level
“In use” volume migration, for such cases we are returning
False and then after that cinder framework takes care of
same.

But we were doing same for same protocol level and
Hence volume migration was failing.

This patch resolve this issue and if same protocol level
“in use” volume migration case is there then 3par
driver takes care of such migration.

Change-Id: I0aba3760cd8f22dd0b19a45ecde06919af4a2447
Closes-Bug: #1744021
"
openstack%2Fcinder~master~I1c719e6858426416b56357d2f071584209757a78,openstack/cinder,master,bug/1721583,I1c719e6858426416b56357d2f071584209757a78,Storwize: Use passed volume names in migrate,MERGED,2018-01-15 18:23:15.000000000,2018-02-25 14:23:44.000000000,2018-02-02 05:35:54.000000000,24,3,6,533754,22b73784ae4463b335456902c3cbf40acdc6e263,81,36,3,2,12802,Carl Pecinovsky,carl-sky,"Storwize: Use passed volume names in migrate

For the storwize driver, update_migrated_volume() impl, the
original and temporary volume names were generated from a
configuration template value, rather than using the names of
the volumes passed. This only works if the storwize driver
created the original volume, but breaks down if it originated
elsewhere.
Make a small change to use the passed in volume name properties
instead. Add a couple asserts to the test cases.

Change-Id: I1c719e6858426416b56357d2f071584209757a78
Closes-Bug: #1721583
"
openstack%2Fcinder~master~Ia77d9d1a3aa4b54a08912584164739f851188784,openstack/cinder,master,fix/glance-client-tests,Ia77d9d1a3aa4b54a08912584164739f851188784,Fix glance create client unit tests,MERGED,2018-01-16 12:54:19.000000000,2018-02-25 14:23:39.000000000,2018-01-17 17:38:32.000000000,2,0,0,534291,1b9a2deaa5c366b11542dc69a03d5aaa1d2e6885,26,20,1,1,9535,Gorka Eguileor,Gorka,"Fix glance create client unit tests

If tests test_create_glance_client_with_protocol_http and
test_create_glance_client_with_protocol_https from
cinder.tests.unit.image.test_glance.TestGlanceImageServiceClient are run
one after the other (regardless of the order) it will result in an
error: ""AssertionError: Expected 'load_from_options' to be called once.
Called 0 times."".

The reason is that in cinder/image/glance.py we cache the session in
variable _SESSION, so the first test will set it and the second one will
reuse it and won't call the load_from_options method.

This patch solves this issue by resetting the caching variable in the
tests.

TrivialFix

Change-Id: Ia77d9d1a3aa4b54a08912584164739f851188784
"
openstack%2Fcinder~master~Idbfeeb2604bc84dc0a17c633b782000d94665bbe,openstack/cinder,master,bug/1692775,Idbfeeb2604bc84dc0a17c633b782000d94665bbe,Fix compression related tests,MERGED,2018-01-16 12:18:59.000000000,2018-02-25 14:23:11.000000000,2018-01-18 16:56:10.000000000,36,10,0,534261,8f3dfd7299a46be106d5b571c442a79986d66883,27,21,1,3,9535,Gorka Eguileor,Gorka,"Fix compression related tests

Tests for chunked backup drivers are using a randomly generated file to
test the compression, which means that in most cases due to the
randomization the generated file is bigger than the original one, so we
end up doing a non compressed backup, which defeats the purpose of the
tests.  More so when you want to test the decompression, since the
backup won't be compressed and there won't be any decompression.

To fix this we generate, for those cases, a simple file that can always
be effectively compressed.

Change-Id: Idbfeeb2604bc84dc0a17c633b782000d94665bbe
"
openstack%2Fcinder~master~I3187a9f5b4aaf6b6b3e11f8c1f109c2e21ee88fc,openstack/cinder,master,infinidat_multiattach,I3187a9f5b4aaf6b6b3e11f8c1f109c2e21ee88fc,INFINIDAT: add missing connection_info params,MERGED,2018-01-14 10:39:28.000000000,2018-02-25 14:23:09.000000000,2018-01-18 06:45:37.000000000,35,11,12,533400,dfcb18a5fee85c67e944cfed50608869aca9c5bb,81,37,2,2,26968,Amit O,amito,"INFINIDAT: add missing connection_info params

Always add target_portals, target_iqns and target_luns to
connection_info to support iSCSI multipath.

Change-Id: I3187a9f5b4aaf6b6b3e11f8c1f109c2e21ee88fc
"
openstack%2Fcinder~master~I14497ed20c6938c0c9662fc94d641ecaf65e984a,openstack/cinder,master,modify_volume,I14497ed20c6938c0c9662fc94d641ecaf65e984a,modify volume spelling errors,MERGED,2018-01-16 09:04:45.000000000,2018-02-25 14:23:05.000000000,2018-01-19 14:37:52.000000000,3,3,0,534199,1cfd567449a2210d101c9db7c910a6ce5f9d2268,45,30,2,1,27361,Yandy Sun,sunyandi,"modify volume spelling errors

Change-Id: I14497ed20c6938c0c9662fc94d641ecaf65e984a
"
openstack%2Fcinder~master~Id30547f430fcd63d639651ab9a987bb40c304e39,openstack/cinder,master,,Id30547f430fcd63d639651ab9a987bb40c304e39,Tests: Fix Storpool tests hash randomization failure,MERGED,2018-01-15 21:28:21.000000000,2018-02-25 14:23:02.000000000,2018-01-19 11:40:45.000000000,8,5,0,533802,adfb4050e509d50c29057170f16d1d8b8be332eb,38,24,1,1,4523,Eric Harney,eharney,"Tests: Fix Storpool tests hash randomization failure

Dicts are unordered types, these unit tests will
fail when Python 3 hash randomization is enabled.

Needed-By: I4c7396f9d8e58ac8420754503f8ed60cd7473426
Change-Id: Id30547f430fcd63d639651ab9a987bb40c304e39
"
openstack%2Fcinder~master~I35834a43298b5287d5cd3c37baa82903bdffda12,openstack/cinder,master,bug/1743462,I35834a43298b5287d5cd3c37baa82903bdffda12,Fix: Propagate OS global request ID,MERGED,2018-01-15 21:00:47.000000000,2018-02-25 14:23:01.000000000,2018-01-18 06:45:42.000000000,1,0,0,533793,28ada504af4084f72f3503d77806075e7ad509b0,44,28,1,1,9535,Gorka Eguileor,Gorka,"Fix: Propagate OS global request ID

Cinder doesn't propagate global request IDs internally, so any external
request that comes with it will have it logged at the API service and
then we'll lose this information in all the other services.

We are properly serializing this information on our RPC calls, but we
are not reconstructing the Context properly on the receiving end.

This patch ensures that the ""global_request_id"" field from the context
is properly added on RPC reception.

Closes-Bug: #1743462
Change-Id: I35834a43298b5287d5cd3c37baa82903bdffda12
"
openstack%2Fcinder~stable%2Fpike~I2d4b7530b2d249ca193f7d0e87d529c9eb2dc25d,openstack/cinder,stable/pike,bug/1737181,I2d4b7530b2d249ca193f7d0e87d529c9eb2dc25d,3PAR: Update CHAP on host record when volume is migrated to new compute host,MERGED,2018-01-15 06:22:54.000000000,2018-02-25 14:22:56.000000000,2018-02-02 03:40:58.000000000,70,16,0,533503,0daf88152bca5198e740eaf006b8a2cc3e632bfd,27,18,1,2,24299,Govardhan Chintha,chinthagovardhan,"3PAR: Update CHAP on host record when volume is migrated to new compute host

When the nova instances are migrated from one compute host to another,
during the new VLUN creation step, the host record created on 3PAR has
the old chap credentials, but the volume metadata contains the newly
generated CHAP credentials. This fix will ensure the CHAP authentication
credentials on volume metadata and the host record on 3PAR are in sync
when the nova instances are live migrated.

Closes-Bug: #1737181

Change-Id: I2d4b7530b2d249ca193f7d0e87d529c9eb2dc25d
(cherry picked from commit bfc8c849df043d7695c70a5e90e5b95e93ce0728)
"
openstack%2Fcinder~driverfixes%2Focata~I3b775da8c5e862def54e9d44d7b157cf17a07a24,openstack/cinder,driverfixes/ocata,bug/1726284-driverfixes/ocata,I3b775da8c5e862def54e9d44d7b157cf17a07a24,Unity: Fix duplicate hosts created with same name,MERGED,2018-01-15 01:47:30.000000000,2018-02-25 14:22:53.000000000,2018-01-18 18:40:25.000000000,73,39,0,533441,eb6d440fe5a94254b7ac9391aa8f3d81b264a484,26,15,1,4,10628,Peter Wang,peter_wang,"Unity: Fix duplicate hosts created with same name

In some circumstance, there is a race condition in querying/creating
Unity host thus multiple hosts with same name were created.

This issue stops any further attach/detach operation.

This patch leverage the DSL in cinder to avoid above race condition.

Change-Id: I3b775da8c5e862def54e9d44d7b157cf17a07a24
Closes-bug: #1726284
(cherry picked from commit d8dd30f16b8712385b2f0d43c4d0a45f5fe4be41)
(cherry picked from commit 85bc7559fb3b8c8ff3d508b3ef54bc4ba4a0591f)
"
openstack%2Fcinder~stable%2Fpike~I8ed58ca2d6f4b95801cb19db1f2f2b4d846a06bf,openstack/cinder,stable/pike,bug/1742992,I8ed58ca2d6f4b95801cb19db1f2f2b4d846a06bf,nimble : remove unsupported from release notes,MERGED,2018-01-12 17:34:48.000000000,2018-02-25 14:22:41.000000000,2018-01-12 20:57:18.000000000,0,13,1,533253,6da81fbfcabf402409d6bc9c6967fe49808d2ccf,14,10,1,1,16668,Raunak Kumar,rkumar,"nimble : remove unsupported from release notes

the release notes has marked nimble as unsupported although it is
supported. revert the file

Change-Id: I8ed58ca2d6f4b95801cb19db1f2f2b4d846a06bf
Closes-Bug: 1742992
"
openstack%2Fcinder~master~Idec99b206f6e27b853175432dcba174f3fa400d0,openstack/cinder,master,bug/1742917,Idec99b206f6e27b853175432dcba174f3fa400d0,VMAX driver - retype fix where workload is None,MERGED,2018-01-12 12:24:30.000000000,2018-02-25 14:22:25.000000000,2018-01-22 01:57:41.000000000,16,1,0,533170,1034f54c33e04d1bf70f20fd1dbfa7b57cdc40e1,45,33,2,2,12670,Helen Walsh,walshh2,"VMAX driver - retype fix where workload is None

The issue occurs when workload is 'None', because the code expects
uppercase 'NONE'. This fix rectifies this.

Change-Id: Idec99b206f6e27b853175432dcba174f3fa400d0
Partial-Bug: #1742917
"
openstack%2Fcinder~master~I058f315f3ae48847165c82b124db566a77e3adbb,openstack/cinder,master,bug/1742709,I058f315f3ae48847165c82b124db566a77e3adbb,VMAX driver - QOS settings incorrectly applied on Default storage group,MERGED,2018-01-11 16:49:30.000000000,2018-02-25 14:22:23.000000000,2018-01-22 01:57:22.000000000,32,0,0,532911,567564cae8fc3b931088b385963a49648574b7b0,79,34,3,2,22021,Unana Okpoyo,UnanaOkpoyo,"VMAX driver - QOS settings incorrectly applied on Default storage group

When a VMAX volume is created, host IO limits are incorrectly applied
on the storage group. When the volume is attached to an instance, host
IO limits are applied to the new storage group leaving limits set in
two places. Host IO limits should only be set on the storage group
associated with the instance.

Change-Id: I058f315f3ae48847165c82b124db566a77e3adbb
Closes-bug: 1742709
"
openstack%2Fcinder~driverfixes%2Fmitaka~I02f79a1ccc1af29e1f843e94c0618c8e4962bdae,openstack/cinder,driverfixes/mitaka,bug/1692775,I02f79a1ccc1af29e1f843e94c0618c8e4962bdae,Fix backup compression unit tests,MERGED,2017-11-07 11:54:00.000000000,2018-02-25 14:22:21.000000000,2018-01-18 04:52:24.000000000,3,3,0,518308,771016611551d148327fe310d92471ceccf2476d,47,16,3,3,9535,Gorka Eguileor,Gorka,"Fix backup compression unit tests

Cinder backup tests for compression were incorrectly testing the size of
the compression data, instead of testing against the compressed data
they were checking the tuple (algorithm, compressed_data).

This patches fixes those tests.

Depends-On: Iaae29d3a48da3e849e558894a2d707be90294551
Change-Id: I02f79a1ccc1af29e1f843e94c0618c8e4962bdae
(cherry picked from commit fd671c77cd93e8a5a5bafbee7f24564fb780a044)
(cherry picked from commit 9d0658febea9a81e54afd62f37a6a9dfe3135797)
(cherry picked from commit 0f20809828e5d56b4b22861d49dde485abf2c1dc)
(cherry picked from commit ec7005ff9162bd64504cb5b50541a26893e60312)
Conflicts:
	cinder/tests/unit/backup/drivers/test_backup_nfs.py
	cinder/tests/unit/test_backup_google.py
	cinder/tests/unit/test_backup_swift.py
"
openstack%2Fcinder~driverfixes%2Fmitaka~Id2ea1a7612f6d5709ba9be95fb28126d299b687e,openstack/cinder,driverfixes/mitaka,532556,Id2ea1a7612f6d5709ba9be95fb28126d299b687e,Tests: Fix NetApp NFS/SSC unit tests,MERGED,2018-01-11 20:39:40.000000000,2018-02-25 14:22:20.000000000,2018-01-12 20:39:38.000000000,3,3,1,532969,7adb1ca73a32946abcc022aa597e9ecaeab48d34,26,10,4,2,4523,Eric Harney,eharney,"Tests: Fix NetApp NFS/SSC unit tests

This accounts for a change introduced by
    8955ba NetApp: Refresh directory before waiting

And fixes an incorrect mock parameter.

Change-Id: Id2ea1a7612f6d5709ba9be95fb28126d299b687e
"
openstack%2Fcinder~master~I9f1f39b30d43dc16a474febcf6549cf1901732ec,openstack/cinder,master,bug/1741191,I9f1f39b30d43dc16a474febcf6549cf1901732ec,Fix: validation error if the optional parameter's value is None,MERGED,2018-01-05 04:36:35.000000000,2018-02-25 14:22:18.000000000,2018-01-15 11:04:26.000000000,200,9,20,531289,05cd2c1b8dfe2d0a24285645c7393bf0864ab4a9,246,51,8,8,18288,Yu Zhang,ivyzhang,"Fix: validation error if the optional parameter's value is None

1. Snapshot: option name in create/update/manage snapthot is optianal
which type is name_allow_zero_min_length and should allow null.
2. Backup: option name in create/update/restore backup is optional
which type is name_allow_zero_min_length and should allow null.
3. Backup: snapshot_id in create backup or volume_id in restore backup
is optional, set its type to uuid_allow_null.
4. Group_snapshot: option name in create group-snapshot is optional, and
should allow null.

Change-Id: I9f1f39b30d43dc16a474febcf6549cf1901732ec
Closes-bug: 1741191
Co-Authored-By: yatin <ykarel@redhat.com>
"
openstack%2Fcinder~driverfixes%2Fmitaka~Ib06f6e09fdb0ee49fe76481c63dc8d0e744faeac,openstack/cinder,driverfixes/mitaka,532556,Ib06f6e09fdb0ee49fe76481c63dc8d0e744faeac,Fix the Mitaka failed UTs of Huawei driver,MERGED,2018-01-11 12:23:18.000000000,2018-02-25 14:22:01.000000000,2018-01-12 05:56:58.000000000,146,196,0,532803,75f8742d9675b47204c2b48d92ece45fed33d1a8,19,8,3,1,16203,zengyingzhe,zengyingzhe,"Fix the Mitaka failed UTs of Huawei driver

Change-Id: Ib06f6e09fdb0ee49fe76481c63dc8d0e744faeac
"
openstack%2Fcinder~driverfixes%2Fmitaka~I95d7aac7ac452aee8cd0ef14f52dc1558b000030,openstack/cinder,driverfixes/mitaka,532556,I95d7aac7ac452aee8cd0ef14f52dc1558b000030,Improve TestCase.mock_object method,MERGED,2018-01-10 15:35:36.000000000,2018-02-25 14:21:59.000000000,2018-01-12 05:56:54.000000000,21,26,0,532556,e6a173395a734c0bdb034db7b380a715bea67188,19,10,2,3,4523,Eric Harney,eharney,"Improve TestCase.mock_object method

Our current mock_object method in TestCase does not behave as one would
expect, as keyword arguments will not work since the method is creating
the Mock object itself when one is not provided and the call to
mock.patch.object with provided keyword arguments will fail.

This forces the callers to create a mock.Mock object to pass the keyword
arguments.

This patch modifies mock_object method to properly accept keyword
arguments, resulting in:

- Consistent behavior with mock.patch.object and
  cinder.test.TestCase.pach methods.
- Increased readability for many cases in our tests since
    self.mock_object(os.path, 'exists', mock.Mock(return_value=False))
  becomes
    self.mock_object(os.path, 'exists', return_value=False)
- Reduction of lines of codes for existing and new tests.

While preserving behavior used in most of our tests, so all existing
method calls will still work except those passing new_attr argument as
keyword argument.

Change-Id: I95d7aac7ac452aee8cd0ef14f52dc1558b000030
(cherry picked from commit efa39bfd494b8510faf96c9402b9d91ecb13c4ac)
"
openstack%2Fcinder~driverfixes%2Fmitaka~I5f2193ff7afc7942dadb402cdd7245c981f23773,openstack/cinder,driverfixes/mitaka,532556,I5f2193ff7afc7942dadb402cdd7245c981f23773,Fix netapp driverfixes/mitaka unit tests,MERGED,2018-01-10 15:35:36.000000000,2018-02-25 14:21:57.000000000,2018-01-12 05:56:46.000000000,2,1,0,532555,3c530a18d0c8ad173b28fc60bee56f628a9ab07c,21,11,2,2,4523,Eric Harney,eharney,"Fix netapp driverfixes/mitaka unit tests

Adjust mock assertions to match mock 2.0.

Add netapp_api.EOBJECTNOTFOUND from
    294ee65bd NetApp cDOT: Add cheesecake replication support
to fix failures from patch
    394e1a2b3 NetApp: block drivers fail when volume missing.

Change-Id: I5f2193ff7afc7942dadb402cdd7245c981f23773
"
openstack%2Fcinder~driverfixes%2Focata~I894f7c48129ba503e01e8216ebb90a50fad97e98,openstack/cinder,driverfixes/ocata,503711,I894f7c48129ba503e01e8216ebb90a50fad97e98,Tests: Fix unit test failures due to space check,MERGED,2017-12-13 08:09:45.000000000,2018-02-25 14:21:53.000000000,2018-01-12 05:29:37.000000000,14,4,0,527626,d9fede50512d960b7dacf5ff294162e3c9a0f95e,28,15,2,1,4523,Eric Harney,eharney,"Tests: Fix unit test failures due to space check

These tests can fail depending on the available space
where the unit tests are run.

This was fixed by bc52ae4219 in Pike.

Change-Id: I894f7c48129ba503e01e8216ebb90a50fad97e98
"
openstack%2Fcinder~driverfixes%2Fnewton~Ie6ec59b4f6d31cb72e37f25f5347c815fee5af48,openstack/cinder,driverfixes/newton,bug/1739651,Ie6ec59b4f6d31cb72e37f25f5347c815fee5af48,StorageCenter: Fix volume mapping for API v3.1,MERGED,2018-01-11 17:35:09.000000000,2018-02-25 14:21:46.000000000,2018-01-18 18:40:28.000000000,32,14,0,532921,9680e90a446936fa79dbdbdd504f4d03bc2f9256,17,12,1,2,9535,Gorka Eguileor,Gorka,"StorageCenter: Fix volume mapping for API v3.1

Volume attachment fails on StorageCenter API v3.1 because the backend
instead of returning wwn or WWN as the key in the controller port it
returns wWN, thus preventing the driver from finding the mapping.

This patch adds support to any combination of upper and lower case of
the WWN key.

Closes-Bug: #1739651
Change-Id: Ie6ec59b4f6d31cb72e37f25f5347c815fee5af48
(cherry picked from commit b50e08bcd8618d9b7935b0245d8b764912c919be)
(cherry picked from commit 0652a58069af9e908d12dd1f1fac8b6a8a8c6c2a)
(cherry picked from commit 6e4a924fe28e66afc122e22beb4d404d4aab738a)
"
openstack%2Fcinder~stable%2Fpike~Ie6ec59b4f6d31cb72e37f25f5347c815fee5af48,openstack/cinder,stable/pike,bug/1739651,Ie6ec59b4f6d31cb72e37f25f5347c815fee5af48,StorageCenter: Fix volume mapping for API v3.1,MERGED,2018-01-11 17:22:50.000000000,2018-02-25 14:21:43.000000000,2018-01-16 21:47:24.000000000,32,14,0,532916,0652a58069af9e908d12dd1f1fac8b6a8a8c6c2a,23,16,1,2,9535,Gorka Eguileor,Gorka,"StorageCenter: Fix volume mapping for API v3.1

Volume attachment fails on StorageCenter API v3.1 because the backend
instead of returning wwn or WWN as the key in the controller port it
returns wWN, thus preventing the driver from finding the mapping.

This patch adds support to any combination of upper and lower case of
the WWN key.

Closes-Bug: #1739651
Change-Id: Ie6ec59b4f6d31cb72e37f25f5347c815fee5af48
(cherry picked from commit b50e08bcd8618d9b7935b0245d8b764912c919be)
"
openstack%2Fcinder~master~Ib46101124699c40f6a6faf36aac0459473ef029d,openstack/cinder,master,remove-unused-variable-execute-in-ceph-backup-driver,Ib46101124699c40f6a6faf36aac0459473ef029d,Remove unused '_execute' variable in ceph backup driver.,ABANDONED,2018-01-11 14:47:48.000000000,2018-02-25 14:21:39.000000000,,2,11,0,532839,3d4cee8625b2b2ae081b743c8a23939260051edf,51,33,2,2,13157,Zhao Chao,zhaochao,"Remove unused '_execute' variable in ceph backup driver.

Ceph backup driver was changing to pipe in the commit
d384d28e1c2c7c3ce0bd676fb1c2bdb8a2d98a03, but leaving the '_execute'
variable never be used, this change removes it.

Change-Id: Ib46101124699c40f6a6faf36aac0459473ef029d
Signed-off-by: Zhao Chao <zhaochao1984@gmail.com>
"
openstack%2Fcinder~stable%2Fpike~Ia0261e83171a1a13374b447303e3a61863fa22c2,openstack/cinder,stable/pike,bug/1724958-stable/pike,Ia0261e83171a1a13374b447303e3a61863fa22c2,Fix manage_existing API behaving wrongly with storage pools,MERGED,2018-01-11 09:38:08.000000000,2018-02-25 14:21:35.000000000,2018-01-17 10:28:25.000000000,6,1,0,532781,a91fad79608da9c43cbf0cd662fb0b3565f4432a,26,16,1,1,23083,TommyLike,TommyLike,"Fix manage_existing API behaving wrongly with storage pools

When the requested host specifies a pool, Cinder needs to
validate that specified pool in the scheduler
and assign the 'host' attribute appropriately.

Closes-Bug: 1724958
Change-Id: Ia0261e83171a1a13374b447303e3a61863fa22c2
(cherry picked from commit 3c7f1762959d53c05f6d37c66908a78e3b822535)
"
openstack%2Fcinder~stable%2Fpike~Idf10bfb8f5e738d7698233b7bdeaf45bef8914e2,openstack/cinder,stable/pike,bug/1738800,Idf10bfb8f5e738d7698233b7bdeaf45bef8914e2,Add admin ctxt to request qos_specs in SolidFire,MERGED,2017-12-20 18:34:09.000000000,2018-02-25 14:21:30.000000000,2018-01-18 23:13:59.000000000,7,1,0,529395,d65bf82dda640c2149212ffd83c36303cf5b86fa,82,21,3,1,2243,John Griffith,john-griffith,"Add admin ctxt to request qos_specs in SolidFire

We used to be able to call qos_specs_get without admin context,
however something has changed and this now fails at the object
layer in base:get_by_id.  This means that now if one uses QoS-Specs
with SolidFire and attempts to retype to another QoS Spec type,
the call will fail with no response data due to a policy/permissions
error.

It turns out that the qos_specs.py api call will let you either
pass in a context or pass in None and it implicitly gets an admin
context.  I prefer explicit behaviors, so add an explicit get admin
context in the SF driver for this call.

Change-Id: Idf10bfb8f5e738d7698233b7bdeaf45bef8914e2
Closes-Bug: #1738800
(cherry picked from commit 3b016538ca6843bdd8cb6b06fc5e86d254d045f2)
"
openstack%2Fcinder~stable%2Fpike~Icbe86473243871996483fdc96c079b8861bac2e5,openstack/cinder,stable/pike,bug/1739995,Icbe86473243871996483fdc96c079b8861bac2e5,Validate volume status again when snapshot created,MERGED,2018-01-03 16:45:15.000000000,2018-02-25 14:20:21.000000000,2018-01-27 01:36:37.000000000,57,11,0,530964,78cd77edef1a08f0472b8df0409adebb9b12e865,63,21,1,7,4523,Eric Harney,eharney,"Validate volume status again when snapshot created

In a multitask environment, the volume can be deleted
after the snapshot record is created. Add the validation
right after the creation to avoid undeletable snapshot.

Closes-Bug: #1739995

Change-Id: Icbe86473243871996483fdc96c079b8861bac2e5
(cherry picked from commit 7ccfb2c8d94824321d4bfca7266c5d72674c061f)
Conflicts:
	cinder/tests/unit/api/v3/test_snapshots.py
	cinder/tests/unit/volume/test_volume.py
"
openstack%2Fcinder~master~I9869ea08afe3c8f8f1f63bb2ead7f63388580937,openstack/cinder,master,bp/json-schema-validation,I9869ea08afe3c8f8f1f63bb2ead7f63388580937,V2/V3 jsonschema validation: snapshots,MERGED,2017-11-17 07:40:04.000000000,2018-02-25 14:19:33.000000000,2018-01-03 02:20:49.000000000,125,94,5,520991,94460b64fb06814e18a4459e365cf207b730210b,250,44,13,6,26541,Neha Alhat,nehaalhat,"V2/V3 jsonschema validation: snapshots

This patch adds jsonschema validation for below Snapshots API's
* POST /v3/{project_id}/snapshots
* PUT  /v3/{project_id}/snapshots/{snapshot_id}
* POST /v2/{project_id}/snapshots
* PUT  /v2/{project_id}/snapshots/{snapshot_id}

Note: For create API 'volume_id' parameter is required, if user
passes 'volume_id' as null, the existing behavior is it returns
""itemNotFound""(404) error response. If we restrict user to accept
volume_id in uuid format only in schema validation then in that case,
if user passes 'volume_id' as null it will raise BadRequest(400)
which will not match existing behavior and also tempest test case[1]
will fail in this case. Also on master if user passes 'metadata' as
null then it is accepted. To maintain consistency we are allowing
'volume_id' and 'metadata' to be null in schema.

Made changes to unit tests to pass body as keyword argument as wsgi
calls action method [2] and passes body as keyword argument.

[1] https://github.com/openstack/tempest/blob/master/tempest/api/volume/test_volumes_snapshots_negative.py#L42
[2] https://github.com/openstack/cinder/blob/master/cinder/api/openstack/wsgi.py#L997
Partial-Implements: bp json-schema-validation

Change-Id: I9869ea08afe3c8f8f1f63bb2ead7f63388580937
"
openstack%2Fcinder~stable%2Fpike~I2a84ae99d71c3551814197917d114057430858b7,openstack/cinder,stable/pike,bug/1738409-stable/pike,I2a84ae99d71c3551814197917d114057430858b7,Add thin provisioning package to install guide,MERGED,2017-12-28 14:10:28.000000000,2018-02-25 14:19:30.000000000,2018-01-08 02:23:37.000000000,3,2,1,530360,8518fe30685fd3a47c3f4372b67bd27d28ee19b2,43,20,1,3,11904,Sean McGinnis,SeanM,"Add thin provisioning package to install guide

Our installation guide walks through configuring storage nodes
using the LVM driver. LVM now defaults to thinly provisioned,
which requires thing-provisioning-tools to be installed on the
host. So by default, our instructions will result in failure
when we attempt to perform thin provision operations.

This adds mention of installing the required package for each
platform's instructions to get the necessary tools installed.

It also adds device-mapper-persistent-data to bindep for Red
Hat based platforms to get those thin provisioning tools that
were previously missing for these platforms.

Tools appear to be installed by default on Suse platforms.

Change-Id: I2a84ae99d71c3551814197917d114057430858b7
Closes-bug: #1738409
Closes-bug: #1740262
(cherry picked from commit 78fa04624d8ab07203a028b256e7001c1ce18679)
"
openstack%2Fcinder~master~I2c79d7d64b5f3c48a147410d93ae687ac0eb3cdc,openstack/cinder,master,bug/fix_force_delete_error,I2c79d7d64b5f3c48a147410d93ae687ac0eb3cdc,Update 'force' parameter for volume delete API,MERGED,2017-11-28 08:31:33.000000000,2018-02-25 14:19:23.000000000,2017-12-29 00:21:56.000000000,8,8,1,523344,c1adb7746132d6e7425c0a1bca7de970a7dde9db,59,36,2,1,23083,TommyLike,TommyLike,"Update 'force' parameter for volume delete API

Parameter 'force' is used in the path rather than
body, update the document.

Change-Id: I2c79d7d64b5f3c48a147410d93ae687ac0eb3cdc
"
openstack%2Fcinder~master~Ie93c608b40968f07cbb17ec40cd22e52120fd396,openstack/cinder,master,bug/1739988,Ie93c608b40968f07cbb17ec40cd22e52120fd396,Adding all docs into index.rst of administration docs,MERGED,2017-12-25 03:12:02.000000000,2018-02-25 14:19:06.000000000,2017-12-26 02:31:09.000000000,17,0,0,529997,c862e5d9349d7058374d738ec6a2cab29576a592,28,24,1,1,8846,Hao Wang,sxmatch,"Adding all docs into index.rst of administration docs

There is only four docs ref in index.rst of administration
docs. It's not convenient for users to look for other
administration docs.

This patch will add all other docs into it.

Change-Id: Ie93c608b40968f07cbb17ec40cd22e52120fd396
Closes-Bug: #1739988
"
openstack%2Fcinder~master~Idb0e5c7c6c6d7f8626b6867eada0d537589011da,openstack/cinder,master,attach,Idb0e5c7c6c6d7f8626b6867eada0d537589011da,Bump up the API microversion in cinder.rc,MERGED,2017-12-22 14:18:10.000000000,2018-02-25 14:19:01.000000000,2017-12-22 17:04:42.000000000,1,1,0,529835,3ffdcaeb4ce78d27cd21d0e5069b1f841b8fd021,30,26,1,1,6491,xing-yang,xing-yang,"Bump up the API microversion in cinder.rc

This patch bumps up the Cinder API microversion to 3.44 in
cinder.rc. This is required for the new attachment API to
support local-attach.

Change-Id: Idb0e5c7c6c6d7f8626b6867eada0d537589011da
"
openstack%2Fcinder~master~I6c214ec868d907ae8edb7546c5f939b0522b20ba,openstack/cinder,master,bp/hpe3par-replication-group,I6c214ec868d907ae8edb7546c5f939b0522b20ba,HPE 3PAR - Implement Tiramisu feature on 3PAR,MERGED,2017-12-15 13:17:57.000000000,2018-02-25 14:18:58.000000000,2017-12-22 17:22:20.000000000,1957,84,77,528266,3da071994b76346a823e3bd1b5aa9582e7163cd0,211,43,10,4,21407,Kushal Wathore,kwathore,"HPE 3PAR - Implement Tiramisu feature on 3PAR

In Tiramisu, a group construct is used to manage the group
of volumes to be replicated together for the ease of management.
This patch adds this support to the HPE 3PAR driver.

Change-Id: I6c214ec868d907ae8edb7546c5f939b0522b20ba
Implements: blueprint hpe3par-replication-group
"
openstack%2Fcinder~master~Ie6ec59b4f6d31cb72e37f25f5347c815fee5af48,openstack/cinder,master,bug/1739651,Ie6ec59b4f6d31cb72e37f25f5347c815fee5af48,StorageCenter: Fix volume mapping for API v3.1,MERGED,2017-12-21 18:18:32.000000000,2018-02-25 14:18:56.000000000,2017-12-23 18:26:26.000000000,32,14,0,529669,b50e08bcd8618d9b7935b0245d8b764912c919be,38,35,1,2,9535,Gorka Eguileor,Gorka,"StorageCenter: Fix volume mapping for API v3.1

Volume attachment fails on StorageCenter API v3.1 because the backend
instead of returning wwn or WWN as the key in the controller port it
returns wWN, thus preventing the driver from finding the mapping.

This patch adds support to any combination of upper and lower case of
the WWN key.

Closes-Bug: #1739651
Change-Id: Ie6ec59b4f6d31cb72e37f25f5347c815fee5af48
"
openstack%2Fcinder~stable%2Fpike~I263c3f5201ac76773a9c962ec958f02f601c6adc,openstack/cinder,stable/pike,bug/1722736-stable/pike,I263c3f5201ac76773a9c962ec958f02f601c6adc,Raise PolicyNotAuthorized exception on consistency Group snapshot,MERGED,2017-12-21 04:24:25.000000000,2018-02-25 14:18:53.000000000,2018-01-17 05:15:45.000000000,36,5,0,529466,33740139c53a7ca0ae910da90e5f2f756225675f,46,23,1,2,20050,MonicaJoshi,MonicaJoshi,"Raise PolicyNotAuthorized exception on consistency Group snapshot

In role based access control test case, a consistencyGroup snapshot
delete when attempted by Non-admin role/user does not return
an informative policy not authorized message.

The proposed fix catches the PolicyNotAuthorized exception
explicitly to raise the appropriate message and error code
to the caller method, includes a new unit test case.

Closes-bug:#1722736

Change-Id: I263c3f5201ac76773a9c962ec958f02f601c6adc
(cherry picked from commit 3f86310b44105b53846820d262d82091cf58f8f0)
"
openstack%2Fcinder~master~I92b42600b71fbdfe1b84046c59ab485f333be889,openstack/cinder,master,bug/1737452,I92b42600b71fbdfe1b84046c59ab485f333be889,NEC driver: add automatic configuration of SAN access control.,MERGED,2017-12-21 00:08:41.000000000,2018-02-25 14:18:32.000000000,2017-12-29 00:21:52.000000000,152,16,0,529430,d4dd162bcddba85dee5920e147e0b9ce189be276,38,33,1,5,23885,Shunei Shiono,s-shiono,"NEC driver: add automatic configuration of SAN access control.

NEC driver user has to register WWPNs or an initiator name of every
node to storage. This is inconvenient for the user.
This patch enables NEC driver to configure SAN access control
automatically.

Change-Id: I92b42600b71fbdfe1b84046c59ab485f333be889
Closes-Bug: #1737452
"
openstack%2Fcinder~master~Ib51c051ab458167c8244587e14edad2ca493a926,openstack/cinder,master,bug/1685012,Ib51c051ab458167c8244587e14edad2ca493a926,NFS: Fix nas_secure auto mode permissions failure,MERGED,2017-04-20 20:02:42.000000000,2018-02-25 14:18:29.000000000,2017-12-20 16:25:59.000000000,8,0,0,458645,76cb3a46a1545aae20562ae7615be1a3ee528c52,130,55,3,1,4523,Eric Harney,eharney,"NFS: Fix nas_secure auto mode permissions failure

When nas_secure_file_operations/permissions is set
to auto, a failure to write the secure indicator file
will result in the driver running with the secure
option set to ""true"".  This causes the driver to fail,
because it then can't write any other files in
unprivileged mode, either.

In ""auto"" mode, this should result in the driver
running with secure mode disabled.

Closes-Bug: #1685012

Change-Id: Ib51c051ab458167c8244587e14edad2ca493a926
"
openstack%2Fcinder~master~I6a2fbb7bd4b37b081296c71f714a23d4901a9d2a,openstack/cinder,master,fix_doc_string_error,I6a2fbb7bd4b37b081296c71f714a23d4901a9d2a,Trivialfix -- Fix spacing in docstring,MERGED,2017-12-19 18:22:46.000000000,2018-02-25 14:18:22.000000000,2017-12-20 02:42:54.000000000,1,1,0,529129,632fdb76eca526e4f1cc32985606947adc8f8b11,22,18,1,1,7198,Jay Bryant,jsbryant,"Trivialfix -- Fix spacing in docstring

Found a poorly formatted docstring while going
through code.  Fixing it here.

Change-Id: I6a2fbb7bd4b37b081296c71f714a23d4901a9d2a
"
openstack%2Fcinder~stable%2Fpike~I35db18f36f86683f2ab16694c9787c908251a382,openstack/cinder,stable/pike,bug/1703954,I35db18f36f86683f2ab16694c9787c908251a382,Fix create encrypted volume from image,MERGED,2017-12-19 12:11:44.000000000,2018-02-25 14:18:14.000000000,2018-01-16 19:55:11.000000000,45,0,0,529045,cfe0cf93d7de384f81597214336c8d0d92dca233,53,22,1,2,9535,Gorka Eguileor,Gorka,"Fix create encrypted volume from image

If we run two create encrypted volume from image serially (waiting for
one operation to complete before the making the next request) the first
operation succeeds while the second one will fail during the attach
phase.

The failure we see in the logs indicate that OS-Brick is unable to get
the WWN from the connected volume.

In reality the failure to attach the volume on the second operation is
caused by a failed cleanup of the first create, even if there's no error
in the logs.

The reason why OS-Brick didn't correctly do the cleanup of the first
volume is because didn't know that it was attaching an encrypted volume
and returned a real path (ie: /dev/sdf) that then go overwritten by the
unencrypted device mapper.

The solution is letting OS-Brick know that it's an encrypted volume
during the attachment phase so it will return a symlink to the real
device instead of the real device itself.

The manager's ""initialize_connection"" does this correctly, but the
method creating the volume from an image doesn't use the method of that
class and calls the driver's ""initialize_connection"" method instead,
which is missing the ""encrypted"" field.

Closes-Bug: #1703954
Change-Id: I35db18f36f86683f2ab16694c9787c908251a382
(cherry picked from commit 3b01eb78ce1c1ce388521f8122b3d6b8f2686fda)
"
openstack%2Fcinder~master~I2fb8317361ca574c49eb39e0b7735c7592126dc6,openstack/cinder,master,typos_in_doc,I2fb8317361ca574c49eb39e0b7735c7592126dc6,Fix some typos in cinder doc,MERGED,2017-12-19 06:38:31.000000000,2018-02-25 14:17:54.000000000,2017-12-19 16:27:43.000000000,6,6,0,528968,0cd71ceb55252eee99fbeb0903da77c5b2f7e205,29,25,1,6,20190,zhufl,zhufl,"Fix some typos in cinder doc

There are some typos in cinder doc,
  contirbute(contribute)
  ReplicationsSatus(ReplicationStatus)
  soure(source)
  specificed(specified)
  priviledged(privileged)
  overriden(overridden)

This is to fix them.

Change-Id: I2fb8317361ca574c49eb39e0b7735c7592126dc6
"
openstack%2Fcinder~master~Icc286d529609165e5f14cb506342660d7bc2ae9f,openstack/cinder,master,bug/1737609,Icc286d529609165e5f14cb506342660d7bc2ae9f,Fix volume image metadata endpoints returning None,MERGED,2017-12-14 02:31:14.000000000,2018-02-25 14:17:50.000000000,2017-12-20 17:07:37.000000000,56,2,3,527838,b5f6c2864f5ca829854af5c12f37a3d49ccc9d5f,64,37,2,3,23186,Felipe Monteiro,felipe.monteiro,"Fix volume image metadata endpoints returning None

This commit fixes the following volume image metadata
endpoints returning None following policy enforcement
failure:

  * ``os-set_image_metadata``
  * ``os-unset_image_metadata``

The endpoints will now correctly raise a 403 Forbidden
instead.

The kwarg `fatal=False` was dropped from
`context.authorize` for these APIs because the kwarg
is only useful when adding additional information to
the response body (if the user is authorized).

This commit:

  * makes the fix for the two endpoints above
  * adds unit tests for validating the new, correct
    behavior (as a side note, policy overriding
    in tests can be more easily accomplished via
    adoption of something like [0])

Also note that since the default policy rule
for these endpoints is ""admin_or_owner"" Tempest
doesn't validate this behavior by default.

[0] https://github.com/openstack/nova/blob/e599b13e4940fb9654f0e0c0f43077a6979eaabe/nova/tests/unit/policy_fixture.py#L30

Change-Id: Icc286d529609165e5f14cb506342660d7bc2ae9f
Closes-Bug: #1737609
"
openstack%2Fcinder~master~I55dc417060d9226c2f120a16b031a79839d483d3,openstack/cinder,master,fix_groups,I55dc417060d9226c2f120a16b031a79839d483d3,NetApp E-Series: Fix broken generic volume groups,MERGED,2017-12-18 18:25:43.000000000,2018-02-25 14:17:48.000000000,2018-01-18 06:45:30.000000000,12,0,0,528782,443dfd9d8c464ba18d2fcd5c3b3fc10602923fde,54,33,1,2,16821,Michael Price,michael.price,"NetApp E-Series: Fix broken generic volume groups

The Generic Volume Groups functionality is currently broken in the
E-Series driver because it is not defining/removing a back-end
consistency group when creating/deleting a generic group.

This patch adds an implementation method in the respective E-Series
drivers to utilize the underlying CG functionality.

Closes-Bug: #1706777
Change-Id: I55dc417060d9226c2f120a16b031a79839d483d3
"
openstack%2Fcinder~stable%2Focata~I7506fa36962404c80f1cc9c6370693728e5393a7,openstack/cinder,stable/ocata,bug/1731518,I7506fa36962404c80f1cc9c6370693728e5393a7,Disallow unmanaging encrypted volumes,MERGED,2017-12-18 16:51:33.000000000,2018-02-25 14:17:47.000000000,2017-12-29 00:21:54.000000000,18,0,0,528758,dd727943d060e9e32ad7a4390337560b8ced1529,18,14,1,3,4523,Eric Harney,eharney,"Disallow unmanaging encrypted volumes

Unmanaging encrypted volumes is problematic because
unmanage assumes that you will be able to manage the
volume again for later use, but, we have no mechanism
currently to keep track of the encryption key which
would be required for using an encrypted volume again.

While this may work out ok when using the conf_key
manager, this patch does not distinguish between conf_key
and barbican deployments.

* The Ocata backport skips the async error message for
  this event due to refactoring of the messages system,
  to minimize risk.

Closes-Bug: #1731518
Change-Id: I7506fa36962404c80f1cc9c6370693728e5393a7
(cherry picked from commit de584713d993e3fb3f68cf2ee8ce37186a9276d5)
Conflicts:
	cinder/volume/api.py
(cherry picked from commit 30ca90ffcc5be2cf2854a97cf55d54f98046cda5)
Conflicts:
	cinder/message/message_field.py
        cinder/tests/unit/api/contrib/test_volume_unmanage.py
	cinder/tests/unit/volume/test_volume.py
"
openstack%2Fcinder~stable%2Fpike~If39a81bbea26c14604b151a51d8e2bbe1bb2f110,openstack/cinder,stable/pike,bug/1738292,If39a81bbea26c14604b151a51d8e2bbe1bb2f110,Switch to oslo_db retry decorator,MERGED,2017-12-16 04:47:39.000000000,2018-02-25 14:17:45.000000000,2018-01-09 22:14:47.000000000,23,41,0,528442,82c9d001606c50e9647464ee8619ce1bc060ddff,97,24,2,1,11904,Sean McGinnis,SeanM,"Switch to oslo_db retry decorator

Our sqlalchemy code uses a custom retry decorator that does not
limit the number of retries. Since this code was written, oslo_db
now has a retry decorator better used for this purpose that limits
the number of retry attempts.

Closes-bug: #1738292
(cherry picked from commit 3aae507a2a90c522e78760e53d2c525d3c6b1f88)

Conflicts:
  cinder/db/sqlalchemy/api.py

Change-Id: If39a81bbea26c14604b151a51d8e2bbe1bb2f110
"
openstack%2Fcinder~master~Ibf71696740129c254f0c065679fe6422bfa2c633,openstack/cinder,master,bug/1729782,Ibf71696740129c254f0c065679fe6422bfa2c633,Storwize: disable creating volume with non cg_snapshot group_id,MERGED,2017-11-03 07:40:12.000000000,2018-02-25 14:17:44.000000000,2017-12-22 14:55:32.000000000,93,11,6,517561,b03a23618122ee8abf596a471da326bfcb9e1710,159,50,6,3,11186,yixuan zhang,yixuanzhang,"Storwize: disable creating volume with non cg_snapshot group_id

Currently, creating a volume with replication group_id, the volume
creates successfully, but it isn't added to storwize replication group.
Creating a volume with hyperswap group_id has the same problem.
Since adding a volume to a replication group immediately follow the
volume creation may be failed on storwize, this patch disables creating
volume with non cg_snapshot group_id.

Change-Id: Ibf71696740129c254f0c065679fe6422bfa2c633
Closes-Bug:  1729782
"
openstack%2Fcinder~master~I2d4b7530b2d249ca193f7d0e87d529c9eb2dc25d,openstack/cinder,master,bug/1737181,I2d4b7530b2d249ca193f7d0e87d529c9eb2dc25d,3PAR: Update CHAP on host record when volume is migrated to new compute host,MERGED,2017-12-12 14:40:07.000000000,2018-02-25 14:17:42.000000000,2017-12-28 23:49:42.000000000,70,16,6,527417,bfc8c849df043d7695c70a5e90e5b95e93ce0728,123,42,6,2,24299,Govardhan Chintha,chinthagovardhan,"3PAR: Update CHAP on host record when volume is migrated to new compute host

When the nova instances are migrated from one compute host to another,
during the new VLUN creation step, the host record created on 3PAR has
the old chap credentials, but the volume metadata contains the newly
generated CHAP credentials. This fix will ensure the CHAP authentication
credentials on volume metadata and the host record on 3PAR are in sync
when the nova instances are live migrated.

Closes-Bug: #1737181

Change-Id: I2d4b7530b2d249ca193f7d0e87d529c9eb2dc25d
"
openstack%2Fcinder~master~I96946f736d7263f80f7ad24f8cbbc9a09eb3cc63,openstack/cinder,master,bug/fix_shared_targets,I96946f736d7263f80f7ad24f8cbbc9a09eb3cc63,Add 'shared_targets' only when it doesn't exist,MERGED,2017-12-18 06:22:19.000000000,2018-02-25 14:17:39.000000000,2017-12-28 00:17:46.000000000,2,4,0,528638,3a5432e14c18852758afdf92b913c93906808e3e,34,29,1,1,23083,TommyLike,TommyLike,"Add 'shared_targets' only when it doesn't exist

Add existence check before actually create it.

Change-Id: I96946f736d7263f80f7ad24f8cbbc9a09eb3cc63
"
openstack%2Fcinder~master~I083fc23eab6f712264919a250c6fb57cc0f6a11b,openstack/cinder,master,bug/1732155,I083fc23eab6f712264919a250c6fb57cc0f6a11b,Use defusedxml for XML parsing,MERGED,2017-12-16 23:45:19.000000000,2018-02-25 14:17:16.000000000,2017-12-19 01:07:51.000000000,15,20,4,528516,4137c33922051546d45b6c9aa730433a401e3df1,48,29,1,8,11904,Sean McGinnis,SeanM,"Use defusedxml for XML parsing

The built-in xml module has some vulnerabilities to several known
XML attacks. While the chances of this are limited with the way
it is being used by some of the volume drivers, it is still a
security risk that has been identified and has a mostly painless
way to be mitigated with the defusedxml package [1].

There are still some drivers performing XML parsing that are not
covered by this patch. They need closer analysis to see how to
best switch to the defusedxml equivalents.

This patch covers the instances where it was a mostly drop in and
replace from the native xml functionality to the defusedxml
alternatives.

[1] https://github.com/tiran/defusedxml/blob/master/README.md

Change-Id: I083fc23eab6f712264919a250c6fb57cc0f6a11b
Partial-bug: #1732155
"
openstack%2Fcinder~master~Ie4e7d339103ec946ec2a011ad795db4511a7f388,openstack/cinder,master,nas_ip,Ie4e7d339103ec946ec2a011ad795db4511a7f388,Remove deprecated 'pybasedir' config option,MERGED,2017-12-15 15:03:32.000000000,2018-02-25 14:17:07.000000000,2017-12-26 02:55:39.000000000,5,1,0,528302,b8a553dfedc9fb2667945cf7b158c64edd05a05e,42,26,2,2,1736,Ivan Kolodyazhny,e0ne,"Remove deprecated 'pybasedir' config option

'pybasedir' was deprecated four years ago and now it's safe to be removed.

Change-Id: Ie4e7d339103ec946ec2a011ad795db4511a7f388
"
openstack%2Fcinder~master~I6dc86ebb326b6d88c20f6f2eb56bf57150536c54,openstack/cinder,master,nas_ip,I6dc86ebb326b6d88c20f6f2eb56bf57150536c54,Remove deprecated 'netapp_eseries_host_type' config option,MERGED,2017-12-15 15:03:32.000000000,2018-02-25 14:17:05.000000000,2017-12-26 02:36:10.000000000,5,1,0,528301,93b4b27dccf5a317ceb12880ab48e39bc4c2b24c,59,30,2,2,1736,Ivan Kolodyazhny,e0ne,"Remove deprecated 'netapp_eseries_host_type' config option

'netapp_eseries_host_type' was deprecated three years ago and now it's safe
to be removed.

Change-Id: I6dc86ebb326b6d88c20f6f2eb56bf57150536c54
"
openstack%2Fcinder~master~I6fc27f8df7b5bb4d045cfdad7a6d6a96775d43b7,openstack/cinder,master,nas_ip,I6fc27f8df7b5bb4d045cfdad7a6d6a96775d43b7,Remove deprecated 'nas_ip' config option,MERGED,2017-12-15 15:03:32.000000000,2018-02-25 14:17:04.000000000,2017-12-21 04:58:29.000000000,6,2,1,528299,d3d53eeb84b417f83db5995bd4640b768d6763bf,74,34,2,2,1736,Ivan Kolodyazhny,e0ne,"Remove deprecated 'nas_ip' config option

'nas_ip' was deprecated during Liberty and now it's safe to be removed.

Change-Id: I6fc27f8df7b5bb4d045cfdad7a6d6a96775d43b7
"
openstack%2Fcinder~master~I72e2bd3e780b1dfbc4a3716bfd370ea8d0e28e96,openstack/cinder,master,bug/1730375,I72e2bd3e780b1dfbc4a3716bfd370ea8d0e28e96,Fixes creation of mirrored volumes due to wrong type,MERGED,2017-11-06 12:24:25.000000000,2018-02-25 14:17:02.000000000,2017-12-16 02:30:28.000000000,1,1,2,517939,5643f60b4d45feb4e135997c43dcd8035cd50856,57,33,4,1,27220,Antony Cleave,antony.cleave,"Fixes creation of mirrored volumes due to wrong type

new verions of lvcreate change the default mirror format to RAID1
vs the old style (mirror). Cinder expects the old style mirror as
--mirrorlog mirrored is specified and this is only supported on the
mirror type, not raid1.

To fix this add --type=mirror to the lvcreate syntax when
lvm_mirrors is > 0 and -m is specified.

Closes-bug: #1730375

Change-Id: I72e2bd3e780b1dfbc4a3716bfd370ea8d0e28e96
"
openstack%2Fcinder~master~I2a84ae99d71c3551814197917d114057430858b7,openstack/cinder,master,bug/1738409,I2a84ae99d71c3551814197917d114057430858b7,Add thin provisioning package to install guide,MERGED,2017-12-15 19:08:45.000000000,2018-02-25 14:17:00.000000000,2017-12-17 23:09:02.000000000,3,2,2,528372,78fa04624d8ab07203a028b256e7001c1ce18679,33,25,1,3,11904,Sean McGinnis,SeanM,"Add thin provisioning package to install guide

Our installation guide walks through configuring storage nodes
using the LVM driver. LVM now defaults to thinly provisioned,
which requires thing-provisioning-tools to be installed on the
host. So by default, our instructions will result in failure
when we attempt to perform thin provision operations.

This adds mention of installing the required package for each
platform's instructions to get the necessary tools installed.

It also adds device-mapper-persistent-data to bindep for Red
Hat based platforms to get those thin provisioning tools that
were previously missing for these platforms.

Tools appear to be installed by default on Suse platforms.

Change-Id: I2a84ae99d71c3551814197917d114057430858b7
Closes-bug: #1738409
"
openstack%2Fcinder~master~I4504a68c83e1e2110c27e62376968cfa1950cf46,openstack/cinder,master,bp/use-service-tokens,I4504a68c83e1e2110c27e62376968cfa1950cf46,Add service_token for cinder-glance interaction,MERGED,2017-12-08 07:44:09.000000000,2018-02-25 14:16:40.000000000,2017-12-22 13:00:43.000000000,121,53,0,526611,826b72ea09a5a5703d732c2abd18b8e8a92b982b,63,38,4,3,26463,Niraj Singh,nirajsingh,"Add service_token for cinder-glance interaction

Service token will be passed along with user token to communicate
with services when dealing with long running tasks like Create
image by volume and Create volume by image.

Change-Id: I4504a68c83e1e2110c27e62376968cfa1950cf46
Implements: blueprint use-service-tokens
"
openstack%2Fcinder~master~If39a81bbea26c14604b151a51d8e2bbe1bb2f110,openstack/cinder,master,bug/1738292,If39a81bbea26c14604b151a51d8e2bbe1bb2f110,Switch to oslo_db retry decorator,MERGED,2017-12-14 22:42:05.000000000,2018-02-25 14:16:28.000000000,2017-12-16 01:40:14.000000000,23,41,0,528107,3aae507a2a90c522e78760e53d2c525d3c6b1f88,45,30,1,1,11904,Sean McGinnis,SeanM,"Switch to oslo_db retry decorator

Our sqlalchemy code uses a custom retry decorator that does not
limit the number of retries. Since this code was written, oslo_db
now has a retry decorator better used for this purpose that limits
the number of retry attempts.

Change-Id: If39a81bbea26c14604b151a51d8e2bbe1bb2f110
Closes-bug: #1738292
"
openstack%2Fcinder~master~Ica1f0e06adf0afcf740aad8cdc8d133ada1760c8,openstack/cinder,master,bug/1737724,Ica1f0e06adf0afcf740aad8cdc8d133ada1760c8,Store host connector in volume_attachment.connector column,MERGED,2017-12-14 04:41:31.000000000,2018-02-25 14:16:24.000000000,2017-12-15 18:50:29.000000000,122,27,1,527852,7875f1419923b60c630d31527f6371ea556e98e6,66,35,2,10,6873,Matt Riedemann,mriedem,"Store host connector in volume_attachment.connector column

The attachment_specs table's key and value columns are strict
strings, which means things like a wwpns list value for a fibrechannel
connector can't get stored there and results in a DB error during
attach with the new volume attach flow in Nova.

The attachment_specs table is arguably not the best way to store
this data, which is just a dict like the connection_info.

A better way to store this is as a serialized json blob on the
volume_attachment record itself.

This patch adds the database migration to add the column and
an online data migration routine to migrate existing attachment_specs
entries when a volume attachment object is loaded from the database.

The volume manager attachment_update flow is changed to store
new connector attachments in the volume_attachment table directly.

An online data migration hook for the CLI will be added in a follow
up change.

Change-Id: Ica1f0e06adf0afcf740aad8cdc8d133ada1760c8
Closes-Bug: #1737724
"
openstack%2Fcinder~master~I5c6ad150543213acfd0c78dbbdb1dc1584d22d26,openstack/cinder,master,bug/1632333,I5c6ad150543213acfd0c78dbbdb1dc1584d22d26,NetApp ONTAP: Copy offload bugfix,MERGED,2017-12-13 19:16:57.000000000,2018-02-25 14:16:23.000000000,2017-12-15 19:17:05.000000000,136,168,1,527762,c27173bad69da4889a5237cf2becc14bb6fc578a,54,30,2,4,14865,Adriano Freires Rosso,adriano_rosso,"NetApp ONTAP: Copy offload bugfix

When 'NetApp NFS Copy Offload' tool is configured to download Glance
images, these images are downloaded twice because the tool is doing
the job after Cinder has already done it.
This patch fixes the bug by executing the copy offload tool inside the
clone_image function instead of using the copy_image_to_volume.

Closes-bug: #1632333

Change-Id: I5c6ad150543213acfd0c78dbbdb1dc1584d22d26
"
openstack%2Fcinder~master~I893dd735fe44089667ac802c0122019c14f30d1c,openstack/cinder,master,bug/1723430,I893dd735fe44089667ac802c0122019c14f30d1c,Cleanup XtremIO IG cleanup note,MERGED,2017-12-13 21:54:02.000000000,2018-02-25 14:16:20.000000000,2017-12-14 01:59:24.000000000,4,2,0,527795,645bda4f48482f27e7d71776af02561004069315,25,21,1,1,11904,Sean McGinnis,SeanM,"Cleanup XtremIO IG cleanup note

Minor issues with the release note for change
I4f6a9676d4ee7e1c4456879b5f1ed9ec20bb7f48 that
were not worth holding up that patch.

Change-Id: I893dd735fe44089667ac802c0122019c14f30d1c
"
openstack%2Fcinder~stable%2Fpike~I7506fa36962404c80f1cc9c6370693728e5393a7,openstack/cinder,stable/pike,bug/1731518,I7506fa36962404c80f1cc9c6370693728e5393a7,Disallow unmanaging encrypted volumes,MERGED,2017-12-13 15:24:07.000000000,2018-02-25 14:16:19.000000000,2017-12-18 16:14:19.000000000,56,3,1,527715,30ca90ffcc5be2cf2854a97cf55d54f98046cda5,34,20,1,6,4523,Eric Harney,eharney,"Disallow unmanaging encrypted volumes

Unmanaging encrypted volumes is problematic because
unmanage assumes that you will be able to manage the
volume again for later use, but, we have no mechanism
currently to keep track of the encryption key which
would be required for using an encrypted volume again.

While this may work out ok when using the conf_key
manager, this patch does not distinguish between conf_key
and barbican deployments.

Closes-Bug: #1731518
Change-Id: I7506fa36962404c80f1cc9c6370693728e5393a7
(cherry picked from commit de584713d993e3fb3f68cf2ee8ce37186a9276d5)
Conflicts:
	cinder/volume/api.py
"
openstack%2Fcinder~stable%2Fpike~I64ff9c25dbea7950ca87f226c6628a730f9e3c0e,openstack/cinder,stable/pike,bug/1735650-stable/pike,I64ff9c25dbea7950ca87f226c6628a730f9e3c0e,Removed gb quota decrement in grp snapshot delete,MERGED,2017-12-13 05:28:07.000000000,2018-02-25 14:16:15.000000000,2017-12-13 22:11:25.000000000,7,11,0,527581,c11a447439aa96ff8e942160997307ab50fa5b74,20,17,1,3,24131,Abhishek Sharma M,abhi.sharma,"Removed gb quota decrement in grp snapshot delete

Before https://review.openstack.org/#/c/517725/, when capturing
a vm we used to reserve gb quota twice. So then i changed the
code such that we should only increment/reserve the gb quota
once, i.e., when creating the group snapshot (not while creating
volumes). Hence we no longer need to decerment gb quota when we
delete the group snapshot (initially we decremented because we
incremented twice).

Change-Id: I64ff9c25dbea7950ca87f226c6628a730f9e3c0e
Closes-Bug: 1735650
(cherry picked from commit 5c8b528f4cd0c21ccb4531db80a2f692ac03c026)
"
openstack%2Fcinder~master~Ieafaae5ccb5a23b4d3ad37b8e7eee40484346cfc,openstack/cinder,master,fix-api-ref-v3-reverting-error-response-codes-404,Ieafaae5ccb5a23b4d3ad37b8e7eee40484346cfc,Keep v3 api-ref error response code 404 for reverting,MERGED,2017-12-13 03:07:31.000000000,2018-02-25 14:14:42.000000000,2017-12-13 05:53:51.000000000,1,1,0,527567,be3ed99428f8638095710f6aa94f967d43e6c157,24,18,1,1,25169,Xiaojun Liao,wwba,"Keep v3 api-ref error response code 404 for reverting

Client can still receive the 404/NotFound when attempting
the fetch of the volume.

Change-Id: Ieafaae5ccb5a23b4d3ad37b8e7eee40484346cfc
Signed-off-by: Xiaojun Liao <xiaojunliao85@gmail.com>
"
openstack%2Fcinder~master~Ie0ac535a6892e5fc62aa6f29fab869fc44f2e57,openstack/cinder,master,bp/json-schema-validation,Ie0ac535a6892e5fc62aa6f29fab869fc44f2e57,V3 jsonschema validation: Group type specs,MERGED,2017-11-16 04:08:47.000000000,2018-02-25 14:14:10.000000000,2017-12-14 17:17:23.000000000,64,34,0,520285,73f8fbad27c8339191f80464fdf0b07d4c496545,110,42,3,3,24645,Pooja Jadhav,poojajadhav,"V3 jsonschema validation: Group type specs

This patch adds jsonschema validation for below Group type specs API's
* POST /v3/{project_id}/group_types/{group_type_id}/group_specs
* PUT  /v3/{project_id}/group_types/{group_type_id}/group_specs/{spec_id}

Made changes to unit tests to pass body as keyword argument as wsgi
calls action method [1] and passes body as keyword argument.

[1] https://github.com/openstack/cinder/blob/master/cinder/api/openstack/wsgi.py#L997

Partial-Implements: bp json-schema-validation
Change-Id: Ie0ac535a6892e5fc62aa6f29fab869fc44f2e57
"
openstack%2Fcinder~master~I0bdf23e371ff8469080982553cb1ffd8a64c9e2d,openstack/cinder,master,bug/1736854,I0bdf23e371ff8469080982553cb1ffd8a64c9e2d,Don't raise 'NotAuthorized' inside when soft authorization,MERGED,2017-12-07 09:39:08.000000000,2018-02-25 14:14:04.000000000,2017-12-14 00:59:34.000000000,9,19,4,526327,e805dcad93c349dbf3cf02be83076a27199c9828,115,43,10,4,23083,TommyLike,TommyLike,"Don't raise 'NotAuthorized' inside when soft authorization

Using try/except block when performing soft
authorization is less efficient and will lead to
lots of confusing error messages, pass 'fatal'
parameter directly to inner authorize function.

Change-Id: I0bdf23e371ff8469080982553cb1ffd8a64c9e2d
Closes-Bug: #1736854
"
openstack%2Fcinder~master~I8234083107207b9ebc0849947e8de92b5cf3e36e,openstack/cinder,master,bug/1673662,I8234083107207b9ebc0849947e8de92b5cf3e36e,Change ssh_utils parameter to correctly sends keepalive packets,MERGED,2017-12-12 05:48:44.000000000,2018-02-25 14:14:02.000000000,2017-12-30 00:28:25.000000000,0,8,0,527309,fca5fb9acf6f1fe1aafa8cee94a39918abaa4b27,40,30,1,1,23885,Shunei Shiono,s-shiono,"Change ssh_utils parameter to correctly sends keepalive packets

The current implementation of ssh_utils never sends keepalive packets.
In ssh_utils.SSHPool, the socket timeout parameter is set to None
intending to keep ssh connections open.
However, when the parameter is set to None, ssh_utils does not run the
code to compare idle duration and keepalive interval.

This patch reverts the socket timeout parameter to default (0.1 sec).
The ssh_utils compares them every 0.1 seconds, and sends a keepalive
packet if idle duration > keepalive interval (= self.conn_timeout).

Change-Id: I8234083107207b9ebc0849947e8de92b5cf3e36e
Closes-Bug: #1673662
"
openstack%2Fcinder~master~I64ff9c25dbea7950ca87f226c6628a730f9e3c0e,openstack/cinder,master,bug/1735650,I64ff9c25dbea7950ca87f226c6628a730f9e3c0e,Removed gb quota decrement in grp snapshot delete,MERGED,2017-12-04 06:42:34.000000000,2018-02-25 14:13:54.000000000,2017-12-12 22:09:48.000000000,7,11,1,525071,5c8b528f4cd0c21ccb4531db80a2f692ac03c026,64,39,2,3,24131,Abhishek Sharma M,abhi.sharma,"Removed gb quota decrement in grp snapshot delete

Before https://review.openstack.org/#/c/517725/, when capturing
a vm we used to reserve gb quota twice. So then i changed the
code such that we should only increment/reserve the gb quota
once, i.e., when creating the group snapshot (not while creating
volumes). Hence we no longer need to decerment gb quota when we
delete the group snapshot (initially we decremented because we
incremented twice).

Change-Id: I64ff9c25dbea7950ca87f226c6628a730f9e3c0e
Closes-Bug: 1735650
"
openstack%2Fcinder~master~I18b890ab1a73e0e7e9e626c7f896486fdd1f6d75,openstack/cinder,master,bug/1737551,I18b890ab1a73e0e7e9e626c7f896486fdd1f6d75,Fix available space checking for image conversion,MERGED,2017-12-11 14:08:41.000000000,2018-02-25 14:13:30.000000000,2017-12-12 21:16:23.000000000,1,1,2,527097,66cc0d2429bddf0c983c6969a70b5cd1ea41e086,41,29,2,1,1736,Ivan Kolodyazhny,e0ne,"Fix available space checking for image conversion

Cinder checks if there is enough free space to convert image from qcow
to raw format before uploading it into the volume. This patch fixes
the issue when we try to compare GiB to KiB.

Change-Id: I18b890ab1a73e0e7e9e626c7f896486fdd1f6d75
Closes-Bug: #1737551
"
openstack%2Fcinder~master~Iae006115e46e20fb354d1db8a09ff4df9810aa44,openstack/cinder,master,bp/qnap-support-qes-200,Iae006115e46e20fb354d1db8a09ff4df9810aa44,QNAP: Add support for QES 2.0.0,MERGED,2017-12-11 06:24:57.000000000,2018-02-25 14:13:27.000000000,2017-12-14 00:59:27.000000000,14,8,0,526994,5c32be5a6de64f3a853924c2e82fb1d99acde712,45,32,1,2,26134,Chris Yang,chrisyang,"QNAP: Add support for QES 2.0.0

This patch do the following change to the QNAP Cinder driver:
1. Add support for QNAP QES firmware 2.0.0.

Change-Id: Iae006115e46e20fb354d1db8a09ff4df9810aa44
Implements: blueprint qnap-support-qes-200
"
openstack%2Fcinder~master~I038684acc488fb1ddba0daff348a23ebf45083da,openstack/cinder,master,bug/1736676,I038684acc488fb1ddba0daff348a23ebf45083da,Fix test case in test_volume_unicode.py,MERGED,2017-12-06 08:25:24.000000000,2018-02-25 14:13:25.000000000,2017-12-12 00:56:57.000000000,7,1,3,525981,141b5c6229505836f53a0ee49e532d3326e73e60,77,40,2,1,23081,Jeremy Zhang,jeremy.zhang,"Fix test case in test_volume_unicode.py

The test case `test_snapshot_create_volume_description_non_ascii_code`
in test_volume_unicode.py breaks the CI job [1], as the test case makes
a wrong assumption that the 'descrption' of snapshot will be inherited
from source volume. This patch aims to fix it.

[1] legacy-tempest-dsvm-full-devstack-plugin-ceph

Change-Id: I038684acc488fb1ddba0daff348a23ebf45083da
Closes-Bug: #1736676
"
openstack%2Fcinder~master~Ice0c38dc95a6a40f41ee77e453ec42376bb367d6,openstack/cinder,master,bug/1729258,Ice0c38dc95a6a40f41ee77e453ec42376bb367d6,VMAX Doc - clarification and typo fixes,MERGED,2017-11-10 16:11:57.000000000,2018-02-25 14:13:23.000000000,2017-12-24 23:18:20.000000000,161,158,3,518956,4813583b6f9848e82e74d948fdc17904e6125f68,133,41,7,1,12670,Helen Walsh,walshh2,"VMAX Doc - clarification and typo fixes

Fixing formating in setup section for clarification and other
minor typo fixes

Change-Id: Ice0c38dc95a6a40f41ee77e453ec42376bb367d6
Closes-Bug: #1729258
"
openstack%2Fcinder~stable%2Fpike~I6330ed31dc9336c9d3d09c2d43c8f4913744e9a2,openstack/cinder,stable/pike,bug/1683228-stable/pike,I6330ed31dc9336c9d3d09c2d43c8f4913744e9a2,Fix for volume from image snapshot free space issue,MERGED,2017-12-08 08:26:09.000000000,2018-02-25 14:13:22.000000000,2017-12-09 06:26:12.000000000,78,2,0,526622,4320c7874cff3b56c1af6dcd45a11e15195237ba,21,16,1,2,25435,Tadas Ustinavičius,seitan,"Fix for volume from image snapshot free space issue

create_from_image() function checks for free space in conversion path
(by default /var/lib/cinder/conversion) even if cinder is creating
volume from image snapshot.

If /var/lib/cinder/conversion has less free space than the size of the
image volume is created from, exception will be thrown by
check_available_space() function in image_utils module.

This patch checks if cinder is configured with
allowed_direct_url_schemes = cinder
If so, cinder should not check free space in conversion path because
volume is created from image snapshot.

Closes-Bug: #1683228
Change-Id: I6330ed31dc9336c9d3d09c2d43c8f4913744e9a2
(cherry picked from commit 30bb0dfbe77efcfcb2330f1758d229310e52ff74)
"
openstack%2Fcinder~master~Ic4c8f29bef2c82550d6d6f03f8fa1dc80696f56e,openstack/cinder,master,bug/1732557,Ic4c8f29bef2c82550d6d6f03f8fa1dc80696f56e,Fix create from snapshot and source volume,MERGED,2017-12-08 03:23:56.000000000,2018-02-25 14:13:20.000000000,2017-12-11 04:29:08.000000000,250,95,3,526581,39816f9ff31738a3deceeeddafcc8d6fb05ac6b3,46,39,1,5,16643,Goutham Pacha Ravi,gouthamr,"Fix create from snapshot and source volume

A regression was introduced in
I970c10f9b50092b659fa2d88bd6a02f6c69899f2
on backends supporting storage pools. By extracting the
'host@backend' out of the host attr from a parent volume,
the scheduler may attempt to put volumes into other pools
belonging to the backend.

Many backends cannot clone across storage pools,
or create storage volumes from snapshots from other
storage pools.

Change-Id: Ic4c8f29bef2c82550d6d6f03f8fa1dc80696f56e
Closes-Bug: #1732557
"
openstack%2Fcinder~master~I325aa997c65472a0e9e0b3356f27d1732aab3b5f,openstack/cinder,master,snapshot-test-check,I325aa997c65472a0e9e0b3356f27d1732aab3b5f,Check snapshot flag for test_snapshot_create_volume_description_non_ascii_code,MERGED,2017-12-07 20:18:02.000000000,2018-02-25 14:13:16.000000000,2017-12-11 23:59:43.000000000,3,0,0,526502,57f701d63ab6c8a68b767d497e521a1b1b276886,37,31,1,1,6873,Matt Riedemann,mriedem,"Check snapshot flag for test_snapshot_create_volume_description_non_ascii_code

Tempest config allows disabling running any tests for volume snapshots
because of storage backends that don't support snapshot, so we need
to not run any tests which create snapshots when Tempest has been
configured otherwise.

Change-Id: I325aa997c65472a0e9e0b3356f27d1732aab3b5f
"
openstack%2Fcinder~master~Ib1ba622c83f3819f9b6c8ea18749b891a60bd12c,openstack/cinder,master,bug/1736907,Ib1ba622c83f3819f9b6c8ea18749b891a60bd12c,Storwize: fix group creation restrict rules,MERGED,2017-12-07 09:58:03.000000000,2018-02-25 14:12:14.000000000,2017-12-25 17:23:11.000000000,133,52,0,526331,c678114b3174a96c372035e3442c47271ebeb171,69,43,2,2,17045,xiaoqin,xiaoqin,"Storwize: fix group creation restrict rules

The following conditions should be denied for group creation:
1. Mixed group types are configured. For example,
both consistent_group_snapshot_enabled and
consistent_group_replication_enabled are set.
2. group_replication_enabled is set.
3. consistent_group_replication_enabled is set with non-replication
volume type.
4. consistent_group_replication_enabled is set with different
replication volume types.

Closes-Bug: #1736907
Change-Id: Ib1ba622c83f3819f9b6c8ea18749b891a60bd12c
"
openstack%2Fcinder~stable%2Fpike~Ic94cbc50d5761c7fc67d2973bed70c70cf6bf769,openstack/cinder,stable/pike,bug/1732812,Ic94cbc50d5761c7fc67d2973bed70c70cf6bf769,nimble: handle unicode strings in volume create,MERGED,2017-12-06 18:35:04.000000000,2018-02-25 14:11:46.000000000,2017-12-11 21:13:07.000000000,57,3,0,526143,369cb8ac51ff9233ebe23ca7108562fa15d77f7f,28,21,1,2,16668,Raunak Kumar,rkumar,"nimble: handle unicode strings in volume create

currently nimble cinder driver doesn't handle unicode strings
for display_name and display_description

Change-Id: Ic94cbc50d5761c7fc67d2973bed70c70cf6bf769
Closes-Bug: 1732812
(cherry picked from commit 23ac0ab4edd38b91b0c21d5c9e81cd1a7bdddc55)
"
openstack%2Fcinder~master~I4f6a9676d4ee7e1c4456879b5f1ed9ec20bb7f48,openstack/cinder,master,bug/1723430,I4f6a9676d4ee7e1c4456879b5f1ed9ec20bb7f48,XtremIO: optional clean IG with no mappings,MERGED,2017-10-26 12:45:23.000000000,2018-02-25 14:11:45.000000000,2017-12-14 00:59:06.000000000,52,5,12,515392,b2c35cbffd95699a1a9c9d1599803f1ec7994352,260,52,8,3,11418,Shay Halsband,shyh,"XtremIO: optional clean IG with no mappings

Optionally remove the IG and initiators after unmapping the last volume.

closes-bug: #1723430
Change-Id: I4f6a9676d4ee7e1c4456879b5f1ed9ec20bb7f48
"
openstack%2Fcinder~master~Ia0792a6a70d74416b7ef593141efbd167aeb1fa5,openstack/cinder,master,trival_fix,Ia0792a6a70d74416b7ef593141efbd167aeb1fa5,TrivialFix: Delete word ‘I’ in admin/blockstorage-backup-disks.rst,MERGED,2017-12-06 01:54:04.000000000,2018-02-25 14:11:43.000000000,2017-12-14 00:29:42.000000000,1,1,1,525846,b49b3368d7d36003b98676463511cab63b5ca097,44,33,2,1,25388,liuyamin,liuyamin,"TrivialFix: Delete word ‘I’ in admin/blockstorage-backup-disks.rst

Change-Id: Ia0792a6a70d74416b7ef593141efbd167aeb1fa5
"
openstack%2Fcinder~master~I5823547c88edb4a1cc9ea5a51c9bf301daf41257,openstack/cinder,master,bug/1734252,I5823547c88edb4a1cc9ea5a51c9bf301daf41257,Fix TypeError for workers cleanup api incase of invalid resource_type value,MERGED,2017-12-01 09:00:02.000000000,2018-02-25 14:11:42.000000000,2017-12-23 17:52:09.000000000,5,3,4,524530,72b96ee9dfca05e75a23784e4b86c9947797aa3d,73,39,2,1,26541,Neha Alhat,nehaalhat,"Fix TypeError for workers cleanup api incase of invalid resource_type value

Workers cleanup API fails to build exception message if invalid resource_type
value other than ['snapshot', 'volume'] is passed and raises TypeError
which gets wrapped into BadRequest at wsgi level.

This patch modifies exception message to fix TypeError issue.

Closes-Bug: #1734252
Change-Id: I5823547c88edb4a1cc9ea5a51c9bf301daf41257
"
openstack%2Fcinder~master~Ib9ad406d933f6491c5e9fbd46dd3c7d6bb07e45b,openstack/cinder,master,bug/1727963,Ib9ad406d933f6491c5e9fbd46dd3c7d6bb07e45b,DS8K: don't swap role after failover group,MERGED,2017-10-31 08:26:49.000000000,2018-02-25 14:11:40.000000000,2017-12-11 21:24:26.000000000,82,8,0,516551,77865be7b01bfa536eaae66a46cc9e2472de58de,117,46,3,2,26422,Peng Wang,wangpeng,"DS8K: don't swap role after failover group

After group failed over, DS8K driver should not run failback in
replication target to swap the role of primary volume and secondary
volume which will fetch the changes in secondary volume to primary
volume.

Change-Id: Ib9ad406d933f6491c5e9fbd46dd3c7d6bb07e45b
Closes-Bug: 1727963
"
openstack%2Fcinder~master~I615d12dfdced3230d3a4195e0323cf3ed9a04e6b,openstack/cinder,master,openstack/requirements,I615d12dfdced3230d3a4195e0323cf3ed9a04e6b,Updated from global requirements,MERGED,2017-11-12 17:23:48.000000000,2018-02-25 14:11:38.000000000,2017-12-06 10:49:31.000000000,8,8,0,519088,42f98148a4dfd4070d159fd815ab16f62ceed08d,340,43,24,2,11131,OpenStack Proposal Bot,proposal-bot,"Updated from global requirements

Change-Id: I615d12dfdced3230d3a4195e0323cf3ed9a04e6b
"
openstack%2Fcinder~master~I6330ed31dc9336c9d3d09c2d43c8f4913744e9a2,openstack/cinder,master,bug/1683228,I6330ed31dc9336c9d3d09c2d43c8f4913744e9a2,Fix for volume from image snapshot free space issue,MERGED,2017-11-30 20:07:21.000000000,2018-02-25 14:11:36.000000000,2017-12-06 10:49:35.000000000,78,2,2,524331,30bb0dfbe77efcfcb2330f1758d229310e52ff74,106,40,4,2,25435,Tadas Ustinavičius,seitan,"Fix for volume from image snapshot free space issue

create_from_image() function checks for free space in conversion path
(by default /var/lib/cinder/conversion) even if cinder is creating
volume from image snapshot.

If /var/lib/cinder/conversion has less free space than the size of the
image volume is created from, exception will be thrown by
check_available_space() function in image_utils module.

This patch checks if cinder is configured with
allowed_direct_url_schemes = cinder
If so, cinder should not check free space in conversion path because
volume is created from image snapshot.

Closes-Bug: #1683228
Change-Id: I6330ed31dc9336c9d3d09c2d43c8f4913744e9a2
"
openstack%2Fcinder~master~I3b581e1b880cf08dd7400db8d77bad8b8fa3b716,openstack/cinder,master,,I3b581e1b880cf08dd7400db8d77bad8b8fa3b716,INFINIDAT: change CI_WIKI_NAME,MERGED,2017-12-04 10:05:14.000000000,2018-02-25 14:11:18.000000000,2017-12-06 10:49:28.000000000,1,1,0,525121,2c1e27564a5a615a255d5a22494c0e1aefea576f,38,31,1,1,26968,Amit O,amito,"INFINIDAT: change CI_WIKI_NAME

As we now support more than one OpenStack project,
our CI name should be more general than INFINIDAT_CINDER_CI.
Changed to: INFINIDAT_CI.

Change-Id: I3b581e1b880cf08dd7400db8d77bad8b8fa3b716
"
openstack%2Fcinder~master~I9fc41a426b29fad4f4d42a584325f0465a20effe,openstack/cinder,master,non_ascii,I9fc41a426b29fad4f4d42a584325f0465a20effe,Add test for volume create with non-ascii characters,MERGED,2017-12-03 07:11:09.000000000,2018-02-25 14:11:05.000000000,2017-12-05 02:47:17.000000000,11,0,12,524946,a323becd5c1c07283203b8cf97cb53dea9dd64ca,63,29,3,1,19262,Liron Kuchlani,lkuchlan,"Add test for volume create with non-ascii characters

This test was uploaded since there was a bug [1] while creating
a volume snapshot if the description of the parent volume contains
non-ascii code.

[1] https://bugzilla.redhat.com/show_bug.cgi?id=1383899

Change-Id: I9fc41a426b29fad4f4d42a584325f0465a20effe
"
openstack%2Fcinder~master~I810b6cb6bba2d95cc5bb477d6e2968ac1734c96b,openstack/cinder,master,bp/policy-in-code,I810b6cb6bba2d95cc5bb477d6e2968ac1734c96b,Add cg policies and clean up old policy handling,MERGED,2017-12-01 21:36:02.000000000,2018-02-25 14:11:04.000000000,2017-12-13 04:31:03.000000000,70,90,0,524733,9fe72de4b690bc5c964c12715581128830c667d5,61,31,3,8,11904,Sean McGinnis,SeanM,"Add cg policies and clean up old policy handling

This completes the ""policy-in-code"" work for Cinder by removing
the old policy.json handling. It also adds new in-code checks to
the legacy consistency group code for completeness.

Change-Id: I810b6cb6bba2d95cc5bb477d6e2968ac1734c96b
Depends-on: I364e401227fe43e2bacf8a799e10286ee445f835
Implements: bp policy-in-code
"
openstack%2Fcinder~master~I3419e628d42eddfe19c55cd72e7b9469e9fccc94,openstack/cinder,master,bug/1732462,I3419e628d42eddfe19c55cd72e7b9469e9fccc94,VNX: Fix cloning failure when system is busy,MERGED,2017-11-15 08:11:54.000000000,2018-02-25 14:11:02.000000000,2018-01-05 21:13:23.000000000,10,9,4,520006,552d6fd33a4a2534eea6ca71765ab9936f5920b7,126,43,5,3,10628,Peter Wang,peter_wang,"VNX: Fix cloning failure when system is busy

In newton, the 30s wait was removed due to refactor, in this case,
If the session hasn't started in the VNX, the driver would perform
unexpected rollback for the migration.

Adding a wait will make sure the session is started on the VNX thus
cloning can succeed.

Change-Id: I3419e628d42eddfe19c55cd72e7b9469e9fccc94
Closes-bug: #1732462
"
openstack%2Fcinder~master~Ibd18c5f6c772f7265175a63ed2b598fcc3c87bc1,openstack/cinder,master,add_shared_targets_info_to_volume_view,Ibd18c5f6c772f7265175a63ed2b598fcc3c87bc1,Add shared_targets and service_uuid to volumes,MERGED,2017-12-01 18:29:08.000000000,2018-02-25 14:11:00.000000000,2017-12-02 13:05:51.000000000,30,5,0,524697,677f130dde4ca7ddf99cc4e4cae1def3491e3912,34,30,1,6,2243,John Griffith,john-griffith,"Add shared_targets and service_uuid to volumes

This adds the last bits to the shared_targets and service_uuid
additions to volumes.  The object and db models are already
updated and this change simply introduces API MV 3.48 to
expose the new fields to the Volume view.

These fields are intended to be used for identifying if the
back end device serving a volume is using shared targets, and
provides the service_uuid to be used as a suggested/unique
handle for locking.

Change-Id: Ibd18c5f6c772f7265175a63ed2b598fcc3c87bc1
"
openstack%2Fcinder~master~I34e53ac72cbda9d8264e48e50f5a84ca09b850bd,openstack/cinder,master,discrepancy_group_types,I34e53ac72cbda9d8264e48e50f5a84ca09b850bd,Discrepancy in api-ref and code for create group type API,MERGED,2017-12-01 06:47:17.000000000,2018-02-25 14:10:59.000000000,2018-01-03 06:36:01.000000000,9,1,6,524492,6e770fef421ada846b040fc8e3aaf85f8954e893,36,33,1,2,24645,Pooja Jadhav,poojajadhav,"Discrepancy in api-ref and code for create group type API

'name' is mentioned as an optional parameter in api-ref doc for
POST /v3/{project_id}/group_types API but in the code if we don't
pass 'name' it returns BadRequest. Also in create and update API,
'is_public' parameter is not added in api-ref document.

This patch fixes this discrepancy by updating the api-ref according
to the code.

Change-Id: I34e53ac72cbda9d8264e48e50f5a84ca09b850bd
"
openstack%2Fcinder~master~I8603a2d63e57354aa0d153ddfb4e9b4172ff803d,openstack/cinder,master,,I8603a2d63e57354aa0d153ddfb4e9b4172ff803d,Remove extra test variable assignment,MERGED,2017-11-30 21:39:28.000000000,2018-02-25 14:10:57.000000000,2017-12-01 03:24:07.000000000,0,1,0,524398,ea1d19f278c099b7f89d8f2cc466188be1a8bd51,29,25,1,1,11904,Sean McGinnis,SeanM,"Remove extra test variable assignment

Expected assertion value is assigned and then immediately
overwritten. Removes unused variable assignment.

TrivialFix

Change-Id: I8603a2d63e57354aa0d153ddfb4e9b4172ff803d
"
openstack%2Fcinder~master~I6cf27bae91ac0faac7d6bdc2d7e447fc5b598482,openstack/cinder,master,,I6cf27bae91ac0faac7d6bdc2d7e447fc5b598482,Tests: Cleanup utils.create_volume fields,MERGED,2017-11-28 23:09:53.000000000,2018-02-25 14:10:53.000000000,2017-12-06 12:43:17.000000000,11,36,0,523563,071e3c55d62fab2564b22f41675a26a87c0f46e6,42,27,2,1,4523,Eric Harney,eharney,"Tests: Cleanup utils.create_volume fields

Fields that default to None don't need to be added
here, they are handled by **kwargs + volume.create().

Remove ""group_snapshot"" since it's not actually a
volume field.

Also make the function more readable.

Change-Id: I6cf27bae91ac0faac7d6bdc2d7e447fc5b598482
"
openstack%2Fcinder~master~Ib66253d3f809c65a2da39c4994e914c1bea53506,openstack/cinder,master,zanata/translations,Ib66253d3f809c65a2da39c4994e914c1bea53506,Imported Translations from Zanata,MERGED,2017-11-30 06:36:49.000000000,2018-02-25 14:10:41.000000000,2017-11-30 13:43:04.000000000,44,88,0,524074,28da2cdd61b754ac9c4f6d1424f1e0518aa260a1,31,26,1,11,11131,OpenStack Proposal Bot,proposal-bot,"Imported Translations from Zanata

For more information about this automatic import see:
https://docs.openstack.org/i18n/latest/reviewing-translation-import.html

Change-Id: Ib66253d3f809c65a2da39c4994e914c1bea53506
"
openstack%2Fmistral~master~I3432f3ab4bcba2d67e00e6f8a7c3916959d59c27,openstack/mistral,master,add_tox_install,I3432f3ab4bcba2d67e00e6f8a7c3916959d59c27,Add a step to install tox,MERGED,2018-02-06 02:49:58.000000000,2018-02-25 14:09:33.000000000,2018-02-25 14:09:33.000000000,4,0,1,541109,8e6436701245410c86f22196deae721f972c670a,13,6,2,1,25167,Qi Peng,pengdake,"Add a step to install tox

Before use tox, we need install it.

Change-Id: I3432f3ab4bcba2d67e00e6f8a7c3916959d59c27
"
openstack%2Fcinder~stable%2Fpike~I623d6114db866a465955f8a5ae7f40b69c781622,openstack/cinder,stable/pike,bug/1734505,I623d6114db866a465955f8a5ae7f40b69c781622,HPE3PAR: Create FC vlun as host sees,MERGED,2017-11-29 17:27:36.000000000,2018-02-25 14:09:24.000000000,2017-11-30 23:25:54.000000000,18,92,0,523940,a337c018971d4f0c085982cd1542b8dcfe1f64f5,18,17,1,2,24952,Vivek Soni,sonivi,"HPE3PAR: Create FC vlun as host sees

Host sees VLUN template allows host connected
to any port to see a vv. so, only one vlun
template will be created per host irrespective
of number of FC ports available.

Change-Id: I623d6114db866a465955f8a5ae7f40b69c781622
Closes-Bug: #1734505
(cherry picked from commit cd18537fd631ba08a342bcfd328d765ea4d8c129)
"
openstack%2Fcinder~master~I7506fa36962404c80f1cc9c6370693728e5393a7,openstack/cinder,master,bug/1731518,I7506fa36962404c80f1cc9c6370693728e5393a7,Disallow unmanaging encrypted volumes,MERGED,2017-11-28 20:15:01.000000000,2018-02-25 14:09:23.000000000,2017-12-07 11:00:32.000000000,56,3,1,523522,de584713d993e3fb3f68cf2ee8ce37186a9276d5,59,35,3,6,4523,Eric Harney,eharney,"Disallow unmanaging encrypted volumes

Unmanaging encrypted volumes is problematic because
unmanage assumes that you will be able to manage the
volume again for later use, but, we have no mechanism
currently to keep track of the encryption key which
would be required for using an encrypted volume again.

While this may work out ok when using the conf_key
manager, this patch does not distinguish between conf_key
and barbican deployments.

Closes-Bug: #1731518
Change-Id: I7506fa36962404c80f1cc9c6370693728e5393a7
"
openstack%2Fcinder~master~I82dd98d9fd9a7bf4ff73a808f59651813ac5ec37,openstack/cinder,master,fix-indent,I82dd98d9fd9a7bf4ff73a808f59651813ac5ec37,Fix indentation in docs,MERGED,2017-11-27 06:26:24.000000000,2018-02-25 14:09:21.000000000,2017-12-18 06:06:21.000000000,239,238,0,523027,c3daf028489e9dc7c8a527dcdb0e2a1cf668c489,101,36,4,5,5689,Masayuki Igawa,igawa,"Fix indentation in docs

This commit removes weird indentations in docs.

Change-Id: I82dd98d9fd9a7bf4ff73a808f59651813ac5ec37
"
openstack%2Fcinder~master~I192708586d89d1bf07a5e52ed1c45de6eab689a5,openstack/cinder,master,bug/1735051,I192708586d89d1bf07a5e52ed1c45de6eab689a5,Fix project_domain_name and user_domain_name in doc,MERGED,2017-11-29 03:36:06.000000000,2018-02-25 14:09:20.000000000,2017-11-29 20:05:30.000000000,12,12,0,523673,8f7356dca6bda1349be1ce265b58ab8a67ce6d3b,26,22,1,6,9414,zhongshengping,ZhongShengping,"Fix project_domain_name and user_domain_name in doc

Change-Id: I192708586d89d1bf07a5e52ed1c45de6eab689a5
Closes-Bug: #1735051
"
openstack%2Fcinder~master~I60898272e0da165fe3168e51d8595250682179c0,openstack/cinder,master,bug/1732992,I60898272e0da165fe3168e51d8595250682179c0,Mock out CLI execution in NEC driver tests,MERGED,2017-11-28 22:10:31.000000000,2018-02-25 14:09:19.000000000,2017-11-29 19:57:07.000000000,3,2,0,523546,4e0b199d177053d1ef547b9f8b57a4e69d189945,29,25,1,1,11904,Sean McGinnis,SeanM,"Mock out CLI execution in NEC driver tests

The VolumeStats_test was not mocking the CLI code that retieves
backend stats, resulting in an ssh_known_hosts file being created
in the local directory. This mocks out the calls to avoid this.

Change-Id: I60898272e0da165fe3168e51d8595250682179c0
Closes-bug: #1732992
"
openstack%2Fcinder~master~If600c28c86511cfb83f38d92cf6418954fb4975e,openstack/cinder,master,add_fk_service_uuid_to_volumes,If600c28c86511cfb83f38d92cf6418954fb4975e,Add shared_targets flag to Volumes,MERGED,2017-11-16 18:49:33.000000000,2018-02-25 14:09:16.000000000,2017-12-01 03:43:41.000000000,188,3,5,520676,2fa6fdd7846df05c3d81e78c137ec2976499a7f9,145,46,5,11,2243,John Griffith,john-griffith,"Add shared_targets flag to Volumes

This adds a bool column to volumes to notify consumers if
the backend hosting the volume utilizes shared_targets
or not.

We use the volume-drivers capabilities report to determine
this and default to True if a driver doesn't report anything.

The purpose of the column is to notify Nova that it needs to
do some sort of locking around connect/disconnect to be sure
other volumes on the same node aren't sharing the iscsi connection.

Using a default of ""True"" is safe because although locking and doing
the extra checks might be somewhat inefficient it works fine because
it will just appear that there's never any other volumes in use.

So this change adds the column to the DB as well as an online migration
to go through and update any existing volumes.  With this and the
service_uuid column consumers will have everything the need to:
1. determine if they need to lock
2. use the service_uuid as a unique lock name

That last remaining change in this set will be to add the fields to
the view-builder and bump the API version.

Change-Id: If600c28c86511cfb83f38d92cf6418954fb4975e
"
openstack%2Fcinder~master~I1e1f58e19ae02896633bc1ab0a8aa8ca3cc26ccf,openstack/cinder,master,bug/1723226,I1e1f58e19ae02896633bc1ab0a8aa8ca3cc26ccf,Allow purging of records less than 1 day old,MERGED,2017-10-12 20:24:11.000000000,2018-02-25 14:09:13.000000000,2017-11-29 06:46:44.000000000,91,7,5,511567,2a44b3cdba722682a326155060c12c51b5fca1fb,246,58,8,4,26991,Louie Kwan,lkwan,"Allow purging of records less than 1 day old

Adding ability to purge records less than 1 day old, using the
cinder-manage db_purge utility.

Added an unit test case at test_purge.py

Change-Id: I1e1f58e19ae02896633bc1ab0a8aa8ca3cc26ccf
Closes-Bug: #1723226
Co-Authored-By: Tee.Ngo@windriver.com
"
openstack%2Fcinder~stable%2Fpike~I8218768216e87f6fdda1dd77dd09ca2ca46111c7,openstack/cinder,stable/pike,bug/1717933,I8218768216e87f6fdda1dd77dd09ca2ca46111c7,VMAX driver - Volume identifier issues,MERGED,2017-11-28 16:52:20.000000000,2018-02-25 14:08:45.000000000,2017-12-18 17:44:00.000000000,74,39,0,523464,ab7ead678e92471dd3ab2f91f189ca8e3520df08,31,18,1,3,12670,Helen Walsh,walshh2,"VMAX driver - Volume identifier issues

When creating a VMAX volume through cinder, a 'volume_identifier' is
set on the device on the backend. This takes the form 'OS-<cinderUUID>'.
There are a couple of issues with how this is currently being done:
1. When the VMAX driver retrieves the volume using the 'device_id' value
saved in the provider location, it checks that the volume identifier
matches OS-<cinderUUID>. However, the way this is currently being
checked can cause an issue if the create volume operation ends up being
retried in cinder - sometimes there can be two devices on the backend
with the same volume identifier, and the code may not pick up the
correct device.
2. On a deallocate operation, the volume identifier is not being unset
on the device. This patch rectifies these issues.

Change-Id: I8218768216e87f6fdda1dd77dd09ca2ca46111c7
Closes-Bug: 1717933
(cherry picked from commit cbce7226bb4fa922c7bea201e942bb88487154d4)
"
openstack%2Fcinder~stable%2Fpike~I2099b804a2043078e50a5a9e14c1497861576f61,openstack/cinder,stable/pike,kaminario-duplicated-fqdn,I2099b804a2043078e50a5a9e14c1497861576f61,Kaminario K2: Support duplicated FQDN in network,MERGED,2017-11-24 06:52:11.000000000,2018-02-25 14:08:44.000000000,2017-12-01 17:27:28.000000000,44,2,0,522721,c11b6a9da277f91d86a963db48045d9dcc44deca,37,21,2,3,16258,nikesh,nikem,"Kaminario K2: Support duplicated FQDN in network

The Kaminario K2 driver uses the FQDN of the node that is doing the
attach as an unique identifier to map the volume.

The problem is that the FQDN is not always unique, there are
environments where the same FQDN can be found in different systems, and
in those cases if both try to attach volumes the second system will
fail.

One example of this happening would be on a QA environment where you are
creating VMs and they all have names like controller-0.localdomain and
compute-0.localdomain.

This patch adds a configuration option to the K2 driver called
`unique_fqdn_network` to support these kind of environments.

Closes-Bug: #1720147
Change-Id: I2099b804a2043078e50a5a9e14c1497861576f61
(cherry picked from commit baa8626eac9c975b719c03274d42b54ce3de74fe)
"
openstack%2Fcinder~master~Icdc6c7606c43243a9e12d7a42df293b729f589e5,openstack/cinder,master,bp/support-create-volume-from-backup,Icdc6c7606c43243a9e12d7a42df293b729f589e5,Support create volume from backup,MERGED,2017-10-18 06:46:43.000000000,2018-02-25 14:08:42.000000000,2017-11-28 18:57:45.000000000,397,50,73,512949,39694623e421e1f0149bff2ea62345d93eed425e,293,51,11,25,24564,qtlu,qtlu,"Support create volume from backup

This patch implements the spec of creating volume from backup.

Change-Id: Icdc6c7606c43243a9e12d7a42df293b729f589e5
Partial-Implements: blueprint support-create-volume-from-backup
"
openstack%2Fcinder~master~I2108e77a8d07dddfb9ec284b3930a197854bd884,openstack/cinder,master,bp/migrate-fixed-key-to-barbican,I2108e77a8d07dddfb9ec284b3930a197854bd884,Consolidate code that manages encryption keys,MERGED,2017-11-27 20:47:39.000000000,2018-02-25 14:08:40.000000000,2017-11-29 20:18:49.000000000,80,34,0,523225,96c6d7b222f507f5c26643d1571b2f991a1f6c98,40,31,1,6,21129,Alan Bishop,ASBishop,"Consolidate code that manages encryption keys

This patch is a minor reorg of existing code to facilitate subsequent
changes for migrating legacy keys to a modern key manager such as
Barbican.

volume/utils.py now supports these functions that manage the lifecycle
of an encryption key:
- create_encryption_key()
- delete_encryption_key()
- clone_encryption_key()

create_encryption_key() is an existing function, but it was not used
everywhere a key was created. All code that needs to create a key now
does so by calling this function.

delete_encryption_key() is primarily a small wrapper, but it will play
a larger role in a subsequent patches related to key migration. One
functional improvement in this patch is it no longer propagates an
exception when deleting an unknown key ID. This avoids needlessly
blocking attempts to delete an encrypted volume for fear that the key
could not be deleted.

clone_encryption_key() is a small wrapper that improves the transparency
of code that needs to create a new encryption key ID from an existing
key ID.

Implements: blueprint migrate-fixed-key-to-barbican
Change-Id: I2108e77a8d07dddfb9ec284b3930a197854bd884
"
openstack%2Fcinder~master~Idb9a1f39481f3ebb704b28abc062ae24414d7224,openstack/cinder,master,cinder_tox,Idb9a1f39481f3ebb704b28abc062ae24414d7224,Move legacy-cinder-tox-* jobs in-tree,MERGED,2017-11-20 20:49:53.000000000,2018-02-25 14:08:32.000000000,2017-11-28 19:09:11.000000000,55,13,6,521654,20864a5f35046a04dafc1655bf95930ee5108a3c,107,41,8,1,11904,Sean McGinnis,SeanM,"Move legacy-cinder-tox-* jobs in-tree

The compliance and bandit-baseline jobs just call tox to run tests.
These are an easy step to move in-tree.

Since it is also easier to have conditions on when things run, this
also adds filtering so the compliance job will now only run when there
are changes in code that impact the drivers.

Change-Id: Idb9a1f39481f3ebb704b28abc062ae24414d7224
Needed-by: I3af7771ab3e8d5a192f466dcec36a2b41db08ac3
Needed-by: I4af1813c69a5ddccbde8b99ed15023aa407995b5
"
openstack%2Fcinder~master~I623d6114db866a465955f8a5ae7f40b69c781622,openstack/cinder,master,bug/1734505,I623d6114db866a465955f8a5ae7f40b69c781622,HPE3PAR: Create FC vlun as host sees,MERGED,2017-11-26 09:23:25.000000000,2018-02-25 14:07:40.000000000,2017-11-28 19:11:19.000000000,18,96,0,522947,cd18537fd631ba08a342bcfd328d765ea4d8c129,36,32,1,2,24952,Vivek Soni,sonivi,"HPE3PAR: Create FC vlun as host sees

Host sees VLUN template allows host connected
to any port to see a vv. so, only one vlun
template will be created per host irrespective
of number of FC ports available.

Change-Id: I623d6114db866a465955f8a5ae7f40b69c781622
Closes-Bug: #1734505
"
openstack%2Fcinder~stable%2Fpike~I7932b1d952844b49cfdb504ed0ba188b489d7f44,openstack/cinder,stable/pike,kaminario-iscsi-non-discovery,I7932b1d952844b49cfdb504ed0ba188b489d7f44,Kaminario K2: Add non discovery iSCSI multipath,MERGED,2017-11-24 08:38:19.000000000,2018-02-25 14:07:36.000000000,2017-11-27 20:36:58.000000000,103,43,0,522741,7bcb2ff94cf38eaa9def1115569981760e36510c,35,19,2,4,16258,nikesh,nikem,"Kaminario K2: Add non discovery iSCSI multipath

Current Kaminario K2 driver only supports iSCSI multipathing using
discovery (sendtargets), which in some cases may be undesirable, since a
broken primary path could prevent an attachment.

This code adds the possibility of not using discovery mode and return
all connection information when `initialize_connection` is called, which
should provide increased reliability.

Change-Id: I7932b1d952844b49cfdb504ed0ba188b489d7f44
(cherry picked from commit c9ec9b9bd755f042dbe1ccbdc5e3ff87fa60269c)
"
openstack%2Fcinder~master~I629cd5a643d22584cb151bcd49ce8ee9c821cadc,openstack/cinder,master,bug/1733774,I629cd5a643d22584cb151bcd49ce8ee9c821cadc,Remove invalid parameters in the file testing.rst,MERGED,2017-11-22 04:26:48.000000000,2018-02-25 14:07:34.000000000,2017-12-12 21:39:44.000000000,2,5,2,522111,ea10d85ecdad10e851ddae801bf1fb30caf5ba85,63,29,4,1,24883,wangzhenyu,wangzhenyu,"Remove invalid parameters in the file testing.rst

Remove invalid parameters in the file testing.rst and modify UT path of
 cinder volume

Change-Id: I629cd5a643d22584cb151bcd49ce8ee9c821cadc
Closes-Bug: #1733774
"
openstack%2Fcinder~master~I86179c47343de32527d17d7e2177046e89cbd007,openstack/cinder,master,bug/1734011,I86179c47343de32527d17d7e2177046e89cbd007,Fix retype migrating volume with rep_status 'not-capable',MERGED,2017-11-23 08:05:54.000000000,2018-02-25 14:07:33.000000000,2017-12-06 12:43:10.000000000,22,1,0,522473,3ac29f6d93df55b0297d034022daf392ae2561e8,28,24,1,2,11186,yixuan zhang,yixuanzhang,"Fix retype migrating volume with rep_status 'not-capable'

When retype migrating a volume with rep_status 'not-capable',
 cinder driver will reject it because the volumes with rep_status
'not-capable' are considered as a replicated volume.
This patch fixes the issue by adding 'not-capable' to the
rep_status checklist.

Change-Id: I86179c47343de32527d17d7e2177046e89cbd007
Closed-Bug: #1734011
"
openstack%2Fcinder~master~I79940e534ec03f2d327e8a7e14e45bc93ae41b0c,openstack/cinder,master,bug/1587376,I79940e534ec03f2d327e8a7e14e45bc93ae41b0c,Handle quota in 2 phases when managing resource,MERGED,2017-11-17 09:53:26.000000000,2018-02-25 14:07:31.000000000,2017-11-23 14:27:23.000000000,83,10,2,521044,e72f0fdf2678482723e95bcc89a8c2117865c8a7,104,41,7,9,23083,TommyLike,TommyLike,"Handle quota in 2 phases when managing resource

Cinder would commit quota twice when managing resource
in a clean environment that the corresponding
'quota_usage' record is empty. This is all because of
we create db entity before reservation, hence the SYNC
mechanism would refresh new record into quota_usage
before actually reserved.

This patch fix this issue by introducing 2 phases
reserve&commit, the latter only intends to update
the actual size.

Closes-Bug: #1587376
Change-Id: I79940e534ec03f2d327e8a7e14e45bc93ae41b0c
"
openstack%2Fcinder~master~I2a6643ab4827dae244212c90c73402ff6d61cf76,openstack/cinder,master,unity_depr,I2a6643ab4827dae244212c90c73402ff6d61cf76,Update unity tests to use our test base,MERGED,2017-11-22 14:56:48.000000000,2018-02-25 14:07:30.000000000,2017-12-11 21:13:08.000000000,14,5,0,522271,406959ad1c0e69e03df521ac3712c66fdbf61873,37,31,1,2,11904,Sean McGinnis,SeanM,"Update unity tests to use our test base

Deprecation warnings were being emitted due to use of assertRaisesRegex,
even though a py2/3 wrapper was created in
I3cf8e29184a68a07d35fb121c816e40b89df393e. This was due to the Unity
tests inheriting from unittest.TestCase instead of our own base TestCase.

Switched test cases over to use cinder.test.TestCase gets rid of the
deprecation warning for assertRaisesRegex.

Our base test installs a logging fixture to make sure log messages are
OK. This uncovered that the driver code was trying to pass an object in
as if it were a dict of formatting values, resulting in an error. This
patch fixes this my creating a dict of the needed values to pass in so
the tests will pass under the new inheritance.

Change-Id: I2a6643ab4827dae244212c90c73402ff6d61cf76
"
openstack%2Fcinder~master~Ibebd5a6e3752a441fc0f05f4bfd1be2b7f360480,openstack/cinder,master,,Ibebd5a6e3752a441fc0f05f4bfd1be2b7f360480,Modify the wrong link in document,MERGED,2017-11-22 07:23:55.000000000,2018-02-25 14:07:28.000000000,2017-11-22 16:23:58.000000000,5,5,0,522150,b1e1f4bfa3f780d9e93e4026339b24f42769117a,27,23,1,5,24883,wangzhenyu,wangzhenyu,"Modify the wrong link in document

Change-Id: Ibebd5a6e3752a441fc0f05f4bfd1be2b7f360480
"
openstack%2Fcinder~master~I2250d4bad1b1f7d1f83c175a5e2b124f02ec9212,openstack/cinder,master,warning_fixture,I2250d4bad1b1f7d1f83c175a5e2b124f02ec9212,Add fixture to only emit DeprecationWarning once,MERGED,2017-11-21 22:54:58.000000000,2018-02-25 14:07:27.000000000,2017-11-22 02:46:07.000000000,25,0,0,522036,bdae03acb0fbb1803174ba985f9e7c8b608dabb6,30,25,1,2,11904,Sean McGinnis,SeanM,"Add fixture to only emit DeprecationWarning once

We have a ton of DeprecationWarning messages in our unit test runs.
Most of these are out of our control from third party libs. This
adds a WarningsFixture to limit warning output to once per test
run, getting rid of >700 warnings in our logs.

Borrowed heavily from Id8d8866baaf64721fda2b6b2e8358db18920c8ba and
I5eaf953b6a2b0a3efe215f776aa048433b192e90 in Nova.

Change-Id: I2250d4bad1b1f7d1f83c175a5e2b124f02ec9212
"
openstack%2Fcinder~master~Ic7e8e6bc5c68e73a2c26c3105885e5c6ea06a4a8,openstack/cinder,master,,Ic7e8e6bc5c68e73a2c26c3105885e5c6ea06a4a8,Update oslo.context RequestContext args,MERGED,2017-11-21 20:59:08.000000000,2018-02-25 14:06:59.000000000,2017-11-22 02:40:37.000000000,10,10,0,522014,82447a26b5a17cebf6274d6c53f4a84f455856bd,32,27,1,4,11904,Sean McGinnis,SeanM,"Update oslo.context RequestContext args

Commit I9272f71e0e68268ad9f558ddd1e1183e3ea69806 fixed a few
deprecation warnings due to properties being renamed in oslo
context, but there were a few other name changes as well.

This updates domain_id, project_domain_id, and user_domain_id
and gets rid of ~130 DeprecationWarning messages from our unit
test runs.

Change-Id: Ic7e8e6bc5c68e73a2c26c3105885e5c6ea06a4a8
"
openstack%2Fcinder~master~I18fbbdf3e4d63c7b3e11806e9347b8df2dba5c8e,openstack/cinder,master,bug/1733676,I18fbbdf3e4d63c7b3e11806e9347b8df2dba5c8e,Handle deprecation of inspect.getargspec,MERGED,2017-11-21 18:57:41.000000000,2018-02-25 14:06:43.000000000,2017-12-23 16:26:52.000000000,19,4,1,521980,4261891d5f06f9cb627c82a1e9bcc07983b6be61,34,30,1,3,11904,Sean McGinnis,SeanM,"Handle deprecation of inspect.getargspec

getargspec has been deprecated in py3 with plans to remove it in py3.6.
The recommendation is to move to inspect.signature, but the results
of that call are different than the existing one.

There is also getfullargspec available under py3 that was originally
deprecated, but for the sake of handling 2/3 code, it has been
un-deprecated. This call uses inspect internally, but returns a mostly
compatible result with what getargspec did. This handles getargspec
deprecation by just using getfullargspec instead if it is available.

Change-Id: I18fbbdf3e4d63c7b3e11806e9347b8df2dba5c8e
Closes-bug: #1733676
"
openstack%2Fcinder~master~I3384ad2f01917d71b3dfab46ef21d7e5c44cc904,openstack/cinder,master,bug/1659443,I3384ad2f01917d71b3dfab46ef21d7e5c44cc904,Fix description for volume_type object in API Ref,MERGED,2017-01-25 23:45:43.000000000,2018-02-25 14:06:11.000000000,2017-11-22 02:30:49.000000000,7,7,0,425461,cd6431b107af146d084c48637bd90ea79d217214,86,46,3,1,8556,Ghanshyam,ghanshyam,"Fix description for volume_type object in API Ref

Volume_type is a object containing all information
about volume_type but its definition is wrong on
API-ref side
- http://developer.openstack.org/api-ref/block-storage/v2/#volume-types-types

This commit correct that to understand the API clearly.

Change-Id: I3384ad2f01917d71b3dfab46ef21d7e5c44cc904
Closes-bug: 1659443
"
openstack%2Fcinder~master~I983e0b7c650a2358e4af9862365d29dfa107210a,openstack/cinder,master,bp/vmware-fcd-driver,I983e0b7c650a2358e4af9862365d29dfa107210a,VMware: Backend driver for VStorageObject,MERGED,2017-11-18 00:56:17.000000000,2018-02-25 14:06:10.000000000,2017-12-01 01:43:44.000000000,1231,2,0,521213,377549c67c4290532df602e89e6f9e6193ab188d,76,33,2,5,9171,Vipin Balachandran,vbala,"VMware: Backend driver for VStorageObject

Volume driver based on VMware VStorageObject aka First Class
Disk (FCD). This driver requires a minimum vCenter version
of 6.5.

Implements: blueprint vmware-fcd-driver
Change-Id: I983e0b7c650a2358e4af9862365d29dfa107210a
"
openstack%2Fcinder~stable%2Fpike~If0462c18345a4bfbfbcecb6b8caa33d38b86d7f0,openstack/cinder,stable/pike,bug/1731528,If0462c18345a4bfbfbcecb6b8caa33d38b86d7f0,Prevent leaking encryption key when deleting volume,MERGED,2017-11-20 15:33:32.000000000,2018-02-25 14:06:08.000000000,2017-11-20 22:13:11.000000000,46,6,0,521560,54c076d1109d0894d14212cfaba356d4a0237f8f,19,15,1,2,21129,Alan Bishop,ASBishop,"Prevent leaking encryption key when deleting volume

Fail requests to delete an encrypted volume when the associated
encryption key cannot be deleted. This avoids leaking an encryption
key when the volume is deleted but the key cannot be deleted.

This patch addresses situations where Barbican is the key manager,
and Barbican's security policy does not allow the user to delete
the key. Barbican has stricter rules on deleting secrets than Cinder
does on deleting volumes. For example, given two non-admin users X
and Y, Cinder allows user X to delete user Y's volume, but Barbican
does not allow user X to delete user Y's secrets.

If the encryption key cannot be deleted then the volume's status is
set to ""error_deleting"". To delete the volume, the volume's status
can be reset, and a user with suitable privileges (i.e. an admin or
the volume's owner) can reissue the delete request.

Closes-Bug: #1731528
Change-Id: If0462c18345a4bfbfbcecb6b8caa33d38b86d7f0
(cherry picked from commit 9044986746cebcb9940e8ab9950dd04f9c9ae28d)
"
openstack%2Fcinder~master~I2921113d89662c346ff75081dc7c5ce24ca6c5e2,openstack/cinder,master,bug/1732455,I2921113d89662c346ff75081dc7c5ce24ca6c5e2,Try Fetching value from 'cluster' when raise exception,MERGED,2017-11-20 08:48:12.000000000,2018-02-25 14:06:06.000000000,2017-11-22 06:27:57.000000000,3,1,1,521459,da74d1d672663cfc6a77ca6cf6cf7df10f178922,66,36,2,1,23083,TommyLike,TommyLike,"Try Fetching value from 'cluster' when raise exception

Cluster is supported in cinder manage API. We should try
to fetch the user input from 'cluster' as well when raising
exception.

TrivialFix
Closes-Bug: #1732455

Change-Id: I2921113d89662c346ff75081dc7c5ce24ca6c5e2
"
openstack%2Fcinder~master~Ia6a9b99df0c7b83999a2e5ac9c945c91b284f807,openstack/cinder,master,bug/1732664,Ia6a9b99df0c7b83999a2e5ac9c945c91b284f807,Fix v3 api-ref for restoring backup are wrongly described,MERGED,2017-11-16 10:53:36.000000000,2018-02-25 14:06:04.000000000,2017-11-21 02:03:59.000000000,8,2,2,520375,47b48b99c131e3d6738625edb0a81d52ec40cf76,123,32,8,1,25169,Xiaojun Liao,wwba,"Fix v3 api-ref for restoring backup are wrongly described

In v3 api-ref for restoring backup, the request contents are wrongly
described, it is mandatory to specify either the UUID or name of the
volume, Actually it's OK if you specify nothing.

The name parameter will work only if a new volume is created for restore.

Closes-Bug:#1732664

Change-Id: Ia6a9b99df0c7b83999a2e5ac9c945c91b284f807
Signed-off-by: Xiaojun Liao <xiaojunliao85@gmail.com>
"
openstack%2Fcinder~master~I3726159a23625a33415f23b971d6e6f47bd77846,openstack/cinder,master,bug/1733148,I3726159a23625a33415f23b971d6e6f47bd77846,Fix qos-spec-v2-qos-specs error,MERGED,2017-11-19 06:42:15.000000000,2018-02-25 14:06:03.000000000,2017-11-20 22:13:13.000000000,9,9,0,521348,a3814c0a6e344b610c089572ce7cc34158bd7f97,34,30,1,1,26233,zengjia,zengjia87,"Fix qos-spec-v2-qos-specs error

There are some small mistakes in the api-v2 doc,
please see this bug description:1733148
Closes-Bug:#1733148

Change-Id: I3726159a23625a33415f23b971d6e6f47bd77846
"
openstack%2Fcinder~master~I789175e70994be52181fed6339af96b6b85c1236,openstack/cinder,master,ut_log_level,I789175e70994be52181fed6339af96b6b85c1236,Explicitly set expected log level for tests,MERGED,2017-11-17 19:14:24.000000000,2018-02-25 14:06:01.000000000,2017-11-18 17:18:45.000000000,4,0,0,521165,b6f7e487551c962da1cc33863a7e65d731618f68,33,25,2,1,11904,Sean McGinnis,SeanM,"Explicitly set expected log level for tests

Some of the tests related to log level adjustment make assumptions
about the default log level. While that should not change often, it
would be best if the tests explicitly set the default it expects.

Change-Id: I789175e70994be52181fed6339af96b6b85c1236
"
openstack%2Fcinder~master~I56c37bb2f5fa20356341e5736745117806463644,openstack/cinder,master,bug/1728640,I56c37bb2f5fa20356341e5736745117806463644,Remove ExceptionTestCase,MERGED,2017-11-17 21:17:09.000000000,2018-02-25 14:04:41.000000000,2017-11-18 01:46:33.000000000,2,16,0,521192,402ded572da14b8f810fed32e35fa715a664cefb,30,26,1,1,11904,Sean McGinnis,SeanM,"Remove ExceptionTestCase

Since the switch to stestr, it appears any tests that output a large
amount of logging can cause subparser errors. One of the tests that
seems to occasionally trigger this is in test_exceptions where it
loads all classes from cinder/exception.py and asserts that attempting
to raise the class results in it being raised.

Many of the exceptions require message formatting values passed in.
The base CinderException handles this, but it also logs when this is
the case. So looping through all the exceptions results in a lot of
log messages for these missing format values.

Since all this does is assert that raising the exception raises the
exception, there is little value to this test. Arguably the only thing
it does is enforce that non-exception classes can't be added to
exception.py as those would raise a TypeError rather than the expected
exception, but that does not seem like something we should care about
enforcing. At least not in a unit test.

Change-Id: I56c37bb2f5fa20356341e5736745117806463644
Partial-bug: #1728640
"
openstack%2Fcinder~master~If40029a6ab9b15c292f9297f5bf56aec9621a7d9,openstack/cinder,master,bp/json-schema-validation,If40029a6ab9b15c292f9297f5bf56aec9621a7d9,V3 jsonschema validation: base schema framework,MERGED,2017-10-27 08:56:29.000000000,2018-02-25 14:04:16.000000000,2017-11-21 16:48:54.000000000,922,0,5,515649,5420c0bf5fce14ff1b004841c7b6f152bc2009ea,278,47,12,7,20191,Dinesh Bhor,dineshbhor,"V3 jsonschema validation: base schema framework

This patch adds a base jsonschema framework which will be used
by other subsequent patches for adding jsonschema validation
support for v3 APIs.

This patch follows the Nova-Schema-framework:
https://github.com/openstack/nova/tree/master/nova/api/validation

Depends-On: I4b1140c20c68821eaf0849c9ee551ff9b1c27deb
Partial-Implements: bp json-schema-validation
Co-author: Pooja Jadhav <pooja.jadhav@nttdata.com>
Change-Id: If40029a6ab9b15c292f9297f5bf56aec9621a7d9
"
openstack%2Fcinder~master~I3454255c8dae481c85f79896ce53fabdc2a50b4d,openstack/cinder,master,bug/1537166,I3454255c8dae481c85f79896ce53fabdc2a50b4d,Check available capacity before creating resources,MERGED,2017-10-02 21:53:49.000000000,2018-02-25 14:04:14.000000000,2017-11-21 03:54:11.000000000,103,4,23,509011,08c2442a87f74a1159f9e82266aa202c793977e1,373,50,14,9,2759,Huang Zhiteng,zhiteng-huang,"Check available capacity before creating resources

For some resources, due to their inheritance of the 'host' attribute
from the source where they are asked to create from, the 'CREATE'
request doesn't go through Cinder scheduler, thus missing the chance
to check if the storage backend still have capacity. Such resources
are snapshots, volume clones and potentially volume replication
clones. In some cases, current implementation is fine because those
new resource would end up being in 'error' state if backend is out
of capacity, but in the case where thin-provisioning is desired and
the backend has max over-subscription ratio set, this might cause
backend to serve more than it should if the backend doesn't enforce
simliar checks.

The solution in this change is simply passing all create requests to
scheduler even for those resource has known 'host'.

Alternative solution, which tries to add some scheduling logic into
volume manager is here: https://review.openstack.org/#/c/437677
The fact that this change almost duplicates scheduler code in a very
unclean way makes it ugly, hard to maintain hence less preferrable.

Change-Id: I3454255c8dae481c85f79896ce53fabdc2a50b4d
Closes-bug: #1537166
"
openstack%2Fcinder~master~Ib9ebfa67020d99d83ebb33552677e9e2e334f9a7,openstack/cinder,master,519699,Ib9ebfa67020d99d83ebb33552677e9e2e334f9a7,Test os-brick master in LIO gate job,MERGED,2017-11-14 16:52:22.000000000,2018-02-25 14:04:13.000000000,2017-11-21 14:16:03.000000000,5,0,0,519699,e298e4367467d8397611933a883f41aba83a5c98,118,37,2,1,4523,Eric Harney,eharney,"Test os-brick master in LIO gate job

Pull os-brick from git instead of pip
when testing on master.  For stable branches,
still pull os-brick from pip.

Change-Id: Ib9ebfa67020d99d83ebb33552677e9e2e334f9a7
"
openstack%2Fcinder~master~I0e83162641279ffe242d18dfd3062ce37b3a959b,openstack/cinder,master,bp/storwize-revert-snapshot,I0e83162641279ffe242d18dfd3062ce37b3a959b,Storwize: revert to snapshot support,MERGED,2017-11-09 10:56:28.000000000,2018-02-25 14:04:11.000000000,2017-11-23 09:43:16.000000000,86,13,2,518707,f701d091bea170e595ed47469a60c4e148a2edcd,220,48,4,3,17045,xiaoqin,xiaoqin,"Storwize: revert to snapshot support

Adding support for reverting volume to a snapshot
in Storwize/SVC driver.

Change-Id: I0e83162641279ffe242d18dfd3062ce37b3a959b
Implements: blueprint storwize-revert-snapshot
"
openstack%2Fcinder~master~Ia7ef04c777ccf6214fec53f500bfba4dde341c73,openstack/cinder,master,bug/1732223,Ia7ef04c777ccf6214fec53f500bfba4dde341c73,Fix cinder-manage volume delete,MERGED,2017-11-15 18:00:15.000000000,2018-02-25 14:04:10.000000000,2017-11-16 21:10:17.000000000,17,44,0,520162,1e97442d61625218c26fcf7f924e09d5677fbd86,73,36,2,2,2243,John Griffith,john-griffith,"Fix cinder-manage volume delete

The cinder-manage volume delete cmd has been broken
for a while.  It looks like the code in manage was
written against an original rpc version that is no
longer valid and never
updated.

This updates it to use the current rpc method.

Change-Id: Ia7ef04c777ccf6214fec53f500bfba4dde341c73
Close-Bug: #1732223
"
openstack%2Fcinder~master~I377b4c11d04c84b00165aae00990c93c5d52e668,openstack/cinder,master,limits-api-ref-error-code,I377b4c11d04c84b00165aae00990c93c5d52e668,api-ref: fix 203 error response codes to be 403,MERGED,2017-11-15 15:26:46.000000000,2018-02-25 14:04:08.000000000,2017-11-21 03:26:54.000000000,3,3,0,520106,0b1db32ec492a65ea710d7dd14c017c8ea111e74,62,35,1,3,6873,Matt Riedemann,mriedem,"api-ref: fix 203 error response codes to be 403

I assume these were just typos, because 203 isn't an error response,
and for these APIs about the only error response you can get, besides
401 I guess, is a 403 for policy forbidding the user from making that
request. So this changes the various 203 to 403 error codes in the
API reference.

Change-Id: I377b4c11d04c84b00165aae00990c93c5d52e668
"
openstack%2Fcinder~master~I035961590a4e5301670cc2707ffedafa81d2a9a2,openstack/cinder,master,,I035961590a4e5301670cc2707ffedafa81d2a9a2,[Trivial] set min max_over_subscription_ratio to 1,MERGED,2017-11-15 11:27:04.000000000,2018-02-25 14:04:05.000000000,2017-11-20 22:13:10.000000000,1,0,0,520049,b6c9afc6dca78a47154ccfbafa5ee58f3d1a1ef7,96,36,1,1,8543,Lucian Petrut,plucian,"[Trivial] set min max_over_subscription_ratio to 1

This change sets the 'max_over_subscription_ratio' config option
minimum value to '1'.

The minimum value is already documented in the config option help
field but is not enforced.

This change allows simplifying code that performs config validation.

Change-Id: I035961590a4e5301670cc2707ffedafa81d2a9a2
"
openstack%2Fcinder~master~I9051b30da01d81dfb966613decf225804b3b9c0e,openstack/cinder,master,fix-d005,I9051b30da01d81dfb966613decf225804b3b9c0e,Fix 'D005 No newline at end of file' Error,MERGED,2017-11-15 07:45:33.000000000,2018-02-25 14:03:30.000000000,2017-11-15 18:48:42.000000000,2,1,0,520000,ace85a005d308aea10c0732870330bcee51793ee,29,25,1,1,5689,Masayuki Igawa,igawa,"Fix 'D005 No newline at end of file' Error

This commit fixes an error - 'D005 No newline at end of file' below.

  cinder/doc/source/sample_policy.rst:17:
               D005 No newline at end of file

Change-Id: I9051b30da01d81dfb966613decf225804b3b9c0e
"
openstack%2Fcinder~stable%2Fpike~I093da81fb9a0021e4fedff7eb48d3245957e787a,openstack/cinder,stable/pike,bug/1727176,I093da81fb9a0021e4fedff7eb48d3245957e787a,HPE 3PAR: Handle single path in FC configuration,MERGED,2017-11-15 06:33:16.000000000,2018-02-25 14:03:28.000000000,2017-11-17 22:08:07.000000000,95,10,0,519979,907fc3d7869a8dd049368b55b8c40f7c3da221ed,29,19,1,2,24952,Vivek Soni,sonivi,"HPE 3PAR: Handle single path in FC configuration

Issue :- With single path configuration, post
volume attach multiple vluns are created,
instead of one vlun.

Added check to create host with single initiator,
which will use single target wwn to create a vlun

Change-Id: I093da81fb9a0021e4fedff7eb48d3245957e787a
Closes-Bug: #1727176
(cherry picked from commit d265cc5a2d4edf5bdaecb34feb6d7c35a76ec526)
"
openstack%2Fcinder~master~I0374ab9f2d37ecf8d8bce191c7535601266d432e,openstack/cinder,master,bug/1727912,I0374ab9f2d37ecf8d8bce191c7535601266d432e,Fix earlier backup records can't be restored,MERGED,2017-10-27 03:28:56.000000000,2018-02-25 14:03:26.000000000,2017-11-17 06:06:23.000000000,99,12,2,515577,7bae5759c872d4536ee29887eb6567f668e75eec,339,49,9,8,23083,TommyLike,TommyLike,"Fix earlier backup records can't be restored

We upgraded the backup service attribute from
module name to class name. This results in
the failure of restoring earlier backups
with new code. This patch upgrades the older
backup records as well as adds compatibility
in code.

Change-Id: I0374ab9f2d37ecf8d8bce191c7535601266d432e
Closes-Bug: #1727912
"
openstack%2Fcinder~master~I41484ced6269d0d4b7553e84c734ef22ab46fcd9,openstack/cinder,master,bug/1691771,I41484ced6269d0d4b7553e84c734ef22ab46fcd9,NetApp cDot: Fix manage volumes,MERGED,2017-11-14 18:19:20.000000000,2018-02-25 14:03:25.000000000,2017-11-17 08:09:17.000000000,13,10,0,519716,4b874c5ddc154629a82814d26b64b7eb0c0fb5d6,60,35,1,4,10058,Erlon R. Cruz,sombrafam,"NetApp cDot: Fix manage volumes

When running NetApp cDot driver using nas_secure_files_operation=false,
managing a volume will always fail if the files permissions are not set
to 0777.

This patch changes the python call from shutil.move to _execute() which
is run using elevated permissions.

Change-Id: I41484ced6269d0d4b7553e84c734ef22ab46fcd9
Closes-bug: #1691771
"
openstack%2Fcinder~master~I9ef79a21c7438e69221a5ed2a1c1bfb59f3f9a32,openstack/cinder,master,bug/1728834,I9ef79a21c7438e69221a5ed2a1c1bfb59f3f9a32,"Correct gb,snapshot quota update in group snapshot",MERGED,2017-11-03 20:51:43.000000000,2018-02-25 14:03:23.000000000,2017-11-15 21:18:51.000000000,58,20,1,517725,b3669fa67cf08f1075be1dd7641ab3af951c138c,135,45,4,7,24131,Abhishek Sharma M,abhi.sharma,"Correct gb,snapshot quota update in group snapshot

Currently we are incrementing gigabytes quota twice, once while
creating snapshot & then while creating individual volumes & this
is fixed in this change. Also, snapshot quota updation was put in
a loop of volumes because of which it gets incremented to number
of volume times.

Change-Id: I9ef79a21c7438e69221a5ed2a1c1bfb59f3f9a32
Closes-Bug: 1728834
"
openstack%2Fcinder~master~Ie4b25627d962aa7daa684de0d22c6bd212b83e46,openstack/cinder,master,remove_v1,Ie4b25627d962aa7daa684de0d22c6bd212b83e46,Remove v1 API reference,MERGED,2017-11-13 21:27:16.000000000,2018-02-25 14:03:20.000000000,2017-12-07 11:00:30.000000000,0,2122,0,519474,f4c44658685656a4eb38f322760876c267ab62d7,28,24,1,31,6873,Matt Riedemann,mriedem,"Remove v1 API reference

Commit 3e91de956e1947a7014709010b99df380242ac74 removed the
v1 API code that these documents were built from, so they
no longer work. The references to the docs from the main
index just redirect back to the main index, so they can't be
used since the code is gone. Anyone that wants to build the
v1 API reference has to build it locally from before commit
3e91de956e1947a7014709010b99df380242ac74, but even then the
v1 API reference was sorely lacking details on the majority
of the API extensions anyway.

Change-Id: Ie4b25627d962aa7daa684de0d22c6bd212b83e46
"
openstack%2Fcinder~master~If0462c18345a4bfbfbcecb6b8caa33d38b86d7f0,openstack/cinder,master,bug/1731528,If0462c18345a4bfbfbcecb6b8caa33d38b86d7f0,Prevent leaking encryption key when deleting volume,MERGED,2017-11-13 17:05:42.000000000,2018-02-25 14:03:09.000000000,2017-11-18 01:59:27.000000000,46,6,0,519432,9044986746cebcb9940e8ab9950dd04f9c9ae28d,42,32,1,2,21129,Alan Bishop,ASBishop,"Prevent leaking encryption key when deleting volume

Fail requests to delete an encrypted volume when the associated
encryption key cannot be deleted. This avoids leaking an encryption
key when the volume is deleted but the key cannot be deleted.

This patch addresses situations where Barbican is the key manager,
and Barbican's security policy does not allow the user to delete
the key. Barbican has stricter rules on deleting secrets than Cinder
does on deleting volumes. For example, given two non-admin users X
and Y, Cinder allows user X to delete user Y's volume, but Barbican
does not allow user X to delete user Y's secrets.

If the encryption key cannot be deleted then the volume's status is
set to ""error_deleting"". To delete the volume, the volume's status
can be reset, and a user with suitable privileges (i.e. an admin or
the volume's owner) can reissue the delete request.

Closes-Bug: #1731528
Change-Id: If0462c18345a4bfbfbcecb6b8caa33d38b86d7f0
"
openstack%2Fcinder~master~Ieb2c08b27d073607c6c3c9bc4d4174f760121509,openstack/cinder,master,bp/readd-qnap-driver,Ieb2c08b27d073607c6c3c9bc4d4174f760121509,Re-add QNAP Cinder volume driver,MERGED,2017-11-13 03:28:58.000000000,2018-02-25 14:02:11.000000000,2017-11-25 16:26:15.000000000,8096,0,3,519218,14dea86f5dbdfded0b23afa6ac454f9914ac0a77,88,39,2,4,26134,Chris Yang,chrisyang,"Re-add QNAP Cinder volume driver

The QNAP driver was marked deprecated and was removed due to not
meet CI requiements. Now QNAP driver can meet the CI requirements.
To support enhanced features of QNAP driver, the driver should
be add back first.

Change-Id: Ieb2c08b27d073607c6c3c9bc4d4174f760121509
Implements: blueprint readd-qnap-driver
"
openstack%2Fcinder~master~I2127550ce5ba8c90436ee50b227d10d8a8b4103f,openstack/cinder,master,,I2127550ce5ba8c90436ee50b227d10d8a8b4103f,Tests: Rework volume deletion w/ invalid status test,MERGED,2017-11-10 21:25:50.000000000,2018-02-25 14:02:09.000000000,2017-11-18 01:43:44.000000000,6,9,0,518981,fb6600065aceb5a9f6abd172954a983a0452bedd,41,28,1,1,4523,Eric Harney,eharney,"Tests: Rework volume deletion w/ invalid status test

This test is testing a different error path than the
name of the test implies.

Rename it and remove a mock that was not triggered.

Change-Id: I2127550ce5ba8c90436ee50b227d10d8a8b4103f
"
openstack%2Fcinder~master~Idae54a17567b558352031ecc573d83ab8b8f04b9,openstack/cinder,master,bp/use-oslodb-enginefacade,Idae54a17567b558352031ecc573d83ab8b8f04b9,Use oslo_db.sqlalchemy.enginefacade,MERGED,2017-10-10 10:25:01.000000000,2018-02-25 14:02:06.000000000,2017-11-14 06:15:34.000000000,81,44,7,510829,9d61c33bdcaaceaa9403d0b9a0342c375be9f923,169,43,6,5,22752,Hanxi Liu,Hanxi_Liu,"Use oslo_db.sqlalchemy.enginefacade

EngineFacade is deprecated, so use oslo_db.sqlalchemy.enginefacade
and update 'get_session' method to keep backward compatibility.

Blueprint: use-oslodb-enginefacade
Change-Id: Idae54a17567b558352031ecc573d83ab8b8f04b9
"
openstack%2Fcinder~master~I4a88d07b41f0a16c638de47945e074adbcf8dd5d,openstack/cinder,master,openstack/requirements,I4a88d07b41f0a16c638de47945e074adbcf8dd5d,Updated from global requirements,MERGED,2017-11-03 00:42:50.000000000,2018-02-25 14:02:02.000000000,2017-11-08 17:06:06.000000000,1,1,0,517465,0088d39e6ec0af9cfa714d10d06698b1b76deed3,203,41,9,1,11131,OpenStack Proposal Bot,proposal-bot,"Updated from global requirements

Change-Id: I4a88d07b41f0a16c638de47945e074adbcf8dd5d
"
openstack%2Fcinder~master~Ib7e45915898347549c12bc8276df556b272bb259,openstack/cinder,master,bug/1728640,Ib7e45915898347549c12bc8276df556b272bb259,Change default test log level,MERGED,2017-11-08 05:44:45.000000000,2018-02-25 14:02:00.000000000,2017-11-15 18:52:08.000000000,8,8,0,518452,ab78a407f28837da2c674f750e91b2ae3def82c9,74,38,1,3,11904,Sean McGinnis,SeanM,"Change default test log level

Despite comments stating otherwise, we set our root logging level
to DEBUG. This causes some unwanted things to be logged to the
console and large test artifacts.

There is also some suspicion that this is causing test failures
with some kind of timing change with stestr causing subunit
parsing failures.

This changes the default level to be higher and fixes a few test
cases that had expected the previous default.

Change-Id: Ib7e45915898347549c12bc8276df556b272bb259
Closes-bug: #1728640
"
openstack%2Fcinder~master~Ic118cfc943008e869893a229c5267d045a21b570,openstack/cinder,master,kaminario_trace,Ic118cfc943008e869893a229c5267d045a21b570,Switch kaminario to use standard trace decorator,MERGED,2017-11-07 22:45:27.000000000,2018-02-25 14:01:52.000000000,2017-11-13 05:45:40.000000000,36,57,0,518410,2127e5509390afcf48d54d1bf93171b62f1437b9,29,22,1,3,11904,Sean McGinnis,SeanM,"Switch kaminario to use standard trace decorator

We have a standard debug tracing decorator in utils. We missed that
Kaminario added their own version of the same thing. This removes that
custom trace decorator in favor of our more standardized decorator.

Change-Id: Ic118cfc943008e869893a229c5267d045a21b570
"
openstack%2Fcinder~driverfixes%2Focata~Ib78293efa626c098a572f4c64119ee2ff296bd40,openstack/cinder,driverfixes/ocata,bug/1726591,Ib78293efa626c098a572f4c64119ee2ff296bd40,Dell EMC PS: Fix Duplicate ACL records Issue,MERGED,2017-11-07 15:35:32.000000000,2018-02-25 14:01:39.000000000,2017-11-21 12:26:57.000000000,45,10,1,518358,2aab3d51d4a64fe3604486eb32abea6af2f05ce7,26,14,2,3,10379,Rajini Karthik,rajinir,"Dell EMC PS: Fix Duplicate ACL records Issue

Live migration was creating duplicate ACL records for the compute
nodes. Fixed it by not creating one when an ACL exists during
initialization of the volume.

Closes Bug: #1726591

Change-Id: Ib78293efa626c098a572f4c64119ee2ff296bd40
(cherry picked from commit 22c09d57687b98faf4193cb1be3d738ddf3bbd28)
"
openstack%2Fcinder~stable%2Fpike~Ib78293efa626c098a572f4c64119ee2ff296bd40,openstack/cinder,stable/pike,bug/1726591,Ib78293efa626c098a572f4c64119ee2ff296bd40,Dell EMC PS: Fix Duplicate ACL records Issue,MERGED,2017-11-07 15:34:21.000000000,2018-02-25 14:01:38.000000000,2017-11-20 09:17:15.000000000,45,10,0,518357,1efed3a4345a3a6d51172fad726aa48a972008e8,31,20,1,3,10379,Rajini Karthik,rajinir,"Dell EMC PS: Fix Duplicate ACL records Issue

Live migration was creating duplicate ACL records for the compute
nodes. Fixed it by not creating one when an ACL exists during
initialization of the volume.

Closes Bug: #1726591

Change-Id: Ib78293efa626c098a572f4c64119ee2ff296bd40
(cherry picked from commit 22c09d57687b98faf4193cb1be3d738ddf3bbd28)
"
openstack%2Fcinder~driverfixes%2Fnewton~I02f79a1ccc1af29e1f843e94c0618c8e4962bdae,openstack/cinder,driverfixes/newton,bug/1692775,I02f79a1ccc1af29e1f843e94c0618c8e4962bdae,Fix backup compression unit tests,MERGED,2017-11-07 11:54:42.000000000,2018-02-25 14:01:36.000000000,2017-11-13 10:10:47.000000000,3,3,0,518310,ec7005ff9162bd64504cb5b50541a26893e60312,16,10,1,3,9535,Gorka Eguileor,Gorka,"Fix backup compression unit tests

Cinder backup tests for compression were incorrectly testing the size of
the compression data, instead of testing against the compressed data
they were checking the tuple (algorithm, compressed_data).

This patches fixes those tests.

Change-Id: I02f79a1ccc1af29e1f843e94c0618c8e4962bdae
(cherry picked from commit fd671c77cd93e8a5a5bafbee7f24564fb780a044)
(cherry picked from commit 9d0658febea9a81e54afd62f37a6a9dfe3135797)
(cherry picked from commit 0f20809828e5d56b4b22861d49dde485abf2c1dc)
"
openstack%2Fcinder~master~Ibe02ca83a674c038ccec28cb104cc2af896426f9,openstack/cinder,master,fix/attach-ovo-getbyid,Ibe02ca83a674c038ccec28cb104cc2af896426f9,Fix VolumeAttachment OVO Volume lazy loading,MERGED,2017-11-07 10:33:16.000000000,2018-02-25 14:01:29.000000000,2017-11-21 14:15:54.000000000,12,1,0,518291,7993e49fdaf089a8c0f613f02105f84cf5ff582f,121,43,1,2,9535,Gorka Eguileor,Gorka,"Fix VolumeAttachment OVO Volume lazy loading

Current code for VolumeAttachment OVO cannot lazy load the volume OVO
correctly and will always return a VolumeNotFound exception.

The reason for not being able to find the volume is that we are using
the VolumeAttachment id to search for the volume instead of the volume's
id.

This patch fixes this by using field ""volume_id"" instead of field ""id""
when calling Volume's get_by_id method.

TrivialFix

Change-Id: Ibe02ca83a674c038ccec28cb104cc2af896426f9
"
openstack%2Fcinder~master~I87926d6c95ac82b6f74c263c7441614f80348c1e,openstack/cinder,master,remove-deprecated-keymgr,I87926d6c95ac82b6f74c263c7441614f80348c1e,Remove deprecated keymgr code,MERGED,2017-05-26 01:59:35.000000000,2018-02-25 14:00:32.000000000,2017-11-10 04:14:20.000000000,44,79,19,468252,ef2202b6adc5d817b26559a9e20b536a547bca65,619,81,19,12,8623,Kaitlin Farr,kaitlin.farr,"Remove deprecated keymgr code

The keymgr code was deprecated for removal in Newton [1]
and should now be removed.

1. Ief8885bb4ca8d62b03cf1a52c25dd0e62c835bfe

Change-Id: I87926d6c95ac82b6f74c263c7441614f80348c1e
"
openstack%2Fcinder~master~I29eb8ccd1f6853b30f236fec46f06b446e6b87ae,openstack/cinder,master,,I29eb8ccd1f6853b30f236fec46f06b446e6b87ae,HPE 3PAR: Adding driver capability,MERGED,2017-11-06 09:47:04.000000000,2018-02-25 14:00:31.000000000,2017-11-08 17:43:45.000000000,240,1,0,517900,9e46d6e1a62a60ff95c503d14b1f0f5ecb8b9ccf,76,38,1,3,21407,Kushal Wathore,kwathore,"HPE 3PAR: Adding driver capability

Added 3par capability which can be used
for setting properties of volume type.

DocImpact

Change-Id: I29eb8ccd1f6853b30f236fec46f06b446e6b87ae
"
openstack%2Fcinder~master~Ibbb077f66b41c359b50fff053aa183382c2cde14,openstack/cinder,master,bug/1729215,Ibbb077f66b41c359b50fff053aa183382c2cde14,create_volume: cleanup consistencygroup when driver exception,MERGED,2017-11-01 07:55:31.000000000,2018-02-25 14:00:29.000000000,2017-11-07 13:13:13.000000000,79,7,2,516882,90184b7a1df436dcb4517cc677b22fa9bb0d40a9,134,45,5,2,11186,yixuan zhang,yixuanzhang,"create_volume: cleanup consistencygroup when driver exception

Creating a volume with group_id, if driver raises an exception,
the volume status will always be “creating”.The status doesn’t
update to “error” because “ObjectActionError: consistency group
changed”
This patch fixes the issue by invoking _cleanup_cg_in_volume
when driver raises an exception.

Change-Id: Ibbb077f66b41c359b50fff053aa183382c2cde14
Closes-Bug: #1729215
"
openstack%2Fcinder~driverfixes%2Fnewton~I48398331fe086760a88bd5ca4c0f28f90e22bd0b,openstack/cinder,driverfixes/newton,bug/1720454,I48398331fe086760a88bd5ca4c0f28f90e22bd0b,Dell EMC PS: Fix extend volume creating unmanaged snapsots,MERGED,2017-10-23 15:43:02.000000000,2018-02-25 14:00:28.000000000,2017-11-13 06:45:14.000000000,8,2,1,514361,3bad55064cab1e860e3e16ad79931fa836e314a2,44,17,4,2,10379,Rajini Karthik,rajinir,"Dell EMC PS: Fix extend volume creating unmanaged snapsots

The Dell EMC PS driver's extend volume code is missing the
no-snap option and creates unmanaged snapshots in the background.
Added that option to fix it.

Closes Bug: #1720454

Change-Id: I48398331fe086760a88bd5ca4c0f28f90e22bd0b
(cherry picked from commit 0910706e762cec88a2b53e82bd7e6a1c372163b9)
"
openstack%2Fcinder~stable%2Fpike~Ibc8b1c5a967d05b3e52f992a1e76e74c9120e3f1,openstack/cinder,stable/pike,bug/1728457,Ibc8b1c5a967d05b3e52f992a1e76e74c9120e3f1,Use total reserved quota value instead of partial,MERGED,2017-11-01 09:55:41.000000000,2018-02-25 14:00:24.000000000,2017-11-04 02:00:23.000000000,5,3,0,516915,d117d76d24166d95a251fb3094b642a4496ebcb2,38,18,2,1,24131,Abhishek Sharma M,abhi.sharma,"Use total reserved quota value instead of partial

While reserving snapshot we reserve gigabytes too. In case of
group snapshot we reserve the total gigabytes but in case of an
exception we print just the last volume gb info which needs to be
changed.

Change-Id: Ibc8b1c5a967d05b3e52f992a1e76e74c9120e3f1
Closes-Bug: 1728457
(cherry picked from commit ead1cee88b14de487537f528b0c5631407d320a0)
"
openstack%2Fcinder~driverfixes%2Fnewton~I1f0adaa8e25cd3ec74084b22bbe1573b92713959,openstack/cinder,driverfixes/newton,bug/1661154,I1f0adaa8e25cd3ec74084b22bbe1573b92713959,Dell EMC PS: Optimize parsing of capacity info from backend,MERGED,2017-10-23 14:55:47.000000000,2018-02-25 14:00:23.000000000,2017-11-03 02:36:49.000000000,15,6,0,514346,02e858b5da4066988fec8ed2574522c9ad90c4fb,42,16,4,2,10379,Rajini Karthik,rajinir,"Dell EMC PS: Optimize parsing of capacity info from backend

The backend api returns large amounts of information and
times out when there are lots of volumes. Accelerated the
process by terminating the parsing after the capacity info
is retrieved.

Closes Bug: #1661154

Change-Id: I1f0adaa8e25cd3ec74084b22bbe1573b92713959
(cherry picked from commit a9a0c2ee2e973d0594f2707d64846e882e179c94)
"
openstack%2Fcinder~master~I970c10f9b50092b659fa2d88bd6a02f6c69899f2,openstack/cinder,master,bp/inspection-mechanism-for-capacity-limited-host,I970c10f9b50092b659fa2d88bd6a02f6c69899f2,Schedule the request to scheduler when creating from snapshot/volume,MERGED,2017-10-16 12:22:19.000000000,2018-02-25 14:00:13.000000000,2017-11-03 09:56:42.000000000,94,48,0,512276,935eee712b0907e86426295d31766eee3831a075,62,39,2,8,23083,TommyLike,TommyLike,"Schedule the request to scheduler when creating from snapshot/volume

Pass the request to scheduler rather than volume service in
order to check the backend's capacity.

Change-Id: I970c10f9b50092b659fa2d88bd6a02f6c69899f2
Partial-Implements: blueprint inspection-mechanism-for-capacity-limited-host
"
openstack%2Fcinder~master~I54f9da98f6c21655081ac838e1fba1f5bc1bedfb,openstack/cinder,master,,I54f9da98f6c21655081ac838e1fba1f5bc1bedfb,ScaleIO: adapt to moved connector constants,MERGED,2017-11-01 12:31:16.000000000,2018-02-25 13:59:33.000000000,2017-11-03 21:03:25.000000000,5,4,0,516976,0b34269f2f693faafc6b31fbd21956ea99c4bf5c,33,29,1,1,25033,Eric Young,tssgery,"ScaleIO: adapt to moved connector constants

os-brick moved the connector constants some time ago and
as has now removed them from the legacy location. This change
adapts the ScaleIO driver to the new location.

Change-Id: I54f9da98f6c21655081ac838e1fba1f5bc1bedfb
"
openstack%2Fcinder~master~I8706584e3abfb936072896d8c4902d82db32ab5f,openstack/cinder,master,bp/smbfs-fixed-images,I8706584e3abfb936072896d8c4902d82db32ab5f,imageutils: allow passing subformat when converting,MERGED,2017-10-24 13:13:46.000000000,2018-02-25 13:59:31.000000000,2017-11-04 04:36:24.000000000,76,26,1,514658,4cfc201b725f4e376a84d017f9ddc5e72f907fa3,130,42,4,2,26415,Alexandru Muresan,amuresan,"imageutils: allow passing subformat when converting

For some image formats (e.g. vhd, vhdx), qemu-img allows
specifying image subformat options. This can be useful when
requesting fixed size images.

This change allows the imageutils convert function to accept
an image subformat.

This will be used by the SMBFS volume driver.

Change-Id: I8706584e3abfb936072896d8c4902d82db32ab5f
"
openstack%2Fcinder~master~I3b775da8c5e862def54e9d44d7b157cf17a07a24,openstack/cinder,master,bug/1726284,I3b775da8c5e862def54e9d44d7b157cf17a07a24,Unity: Fix duplicate hosts created with same name,MERGED,2017-10-13 02:00:55.000000000,2018-02-25 13:59:30.000000000,2017-11-30 13:02:24.000000000,68,39,10,511668,d8dd30f16b8712385b2f0d43c4d0a45f5fe4be41,154,45,6,4,10628,Peter Wang,peter_wang,"Unity: Fix duplicate hosts created with same name

In some circumstance, there is a race condition in querying/creating
Unity host thus multiple hosts with same name were created.

This issue stops any further attach/detach operation.

This patch leverage the DSL in cinder to avoid above race condition.

Change-Id: I3b775da8c5e862def54e9d44d7b157cf17a07a24
Closes-bug: #1726284
"
openstack%2Fcinder~master~I1a1c3a8ff3fb0196e8bffb9a4978e7368eeeacec,openstack/cinder,master,bug/1560650,I1a1c3a8ff3fb0196e8bffb9a4978e7368eeeacec,XtremIO: extending volume in create_volume_from_snapshot,MERGED,2017-10-01 16:42:42.000000000,2018-02-25 13:59:29.000000000,2017-12-09 19:25:43.000000000,68,3,7,508771,50a4c376811c18684c8cada7a0c0c0cc39696942,152,40,4,2,24355,Elad Zucker,elad-zucker,"XtremIO: extending volume in create_volume_from_snapshot

In create_volume_from_snapshot, If the original volume is larger
then the requested snapshot we extend the volume to the original
size.

Closes-Bug: #1560650
Change-Id: I1a1c3a8ff3fb0196e8bffb9a4978e7368eeeacec
"
openstack%2Fcinder~master~I07f027be20e02359df6726e401981f430614346b,openstack/cinder,master,driver_doc,I07f027be20e02359df6726e401981f430614346b,Tintri - Updated driver docs with new nfs option,MERGED,2017-10-30 17:44:21.000000000,2018-02-25 13:59:27.000000000,2017-11-03 03:17:03.000000000,2,2,0,516408,868de35a862c9cf0a4b71b168921d3a6fefacbb9,51,27,3,1,14377,Apoorva,apoorvad,"Tintri - Updated driver docs with new nfs option

Tintri does not support NLM sideband protocol

Change-Id: I07f027be20e02359df6726e401981f430614346b
"
openstack%2Fcinder~master~Ieda734e49bdb45566f39f201004b2a3e0b1ba1eb,openstack/cinder,master,bp/smbfs-fixed-images,Ieda734e49bdb45566f39f201004b2a3e0b1ba1eb,Fix imageutils tests on windows,MERGED,2017-10-24 13:13:46.000000000,2018-02-25 13:59:26.000000000,2017-11-03 20:45:09.000000000,5,0,0,514657,3407100f94f12c06e7c6ef71fdf36c5c8103631b,72,33,2,1,26415,Alexandru Muresan,amuresan,"Fix imageutils tests on windows

Some of the imageutils unit tests are currently failing on Windows.

Two of them make assertions on arguments that are platform dependent
while another one fails due to the fact that os.path.join cannot
be used with mock objects on Windows.

This change fixes those issues.

Change-Id: Ieda734e49bdb45566f39f201004b2a3e0b1ba1eb
"
openstack%2Fcinder~master~If160ffdd7301337eac9353faffb72a9f069882c4,openstack/cinder,master,fix_api_ref,If160ffdd7301337eac9353faffb72a9f069882c4,Fix api-ref for group snapshots API,MERGED,2017-10-31 07:30:03.000000000,2018-02-25 13:59:25.000000000,2017-11-03 03:02:52.000000000,28,18,0,516539,ab9a8a2a6e300d29e9814523541b0e582508c9b4,33,29,1,5,23081,Jeremy Zhang,jeremy.zhang,"Fix api-ref for group snapshots API

This patch mainly fixes the response parameters and examples for
the show/list/create group snapshots APIs.

Change-Id: If160ffdd7301337eac9353faffb72a9f069882c4
"
openstack%2Fcinder~driverfixes%2Fnewton~I945300cac84658bbd25182ba615645af881920f8,openstack/cinder,driverfixes/newton,bug/1724929,I945300cac84658bbd25182ba615645af881920f8,ScaleIO Driver - include snap usage in provisioned capacity,MERGED,2017-10-31 01:26:39.000000000,2018-02-25 13:59:23.000000000,2017-10-31 21:20:25.000000000,6,2,0,516481,ed9e88e2639e66ce1ae998a3c0ca8d3600c97fca,13,9,1,2,25033,Eric Young,tssgery,"ScaleIO Driver - include snap usage in provisioned capacity

Provisioned capacity of storage pools was not correctly accounting
for space used by snapshots.

Change-Id: I945300cac84658bbd25182ba615645af881920f8
Closes-Bug: #1724929
(cherry picked from commit 5b9a5858d72d1be9599407b0e9945fb4cd0cf3ab)
"
openstack%2Fcinder~driverfixes%2Focata~I48398331fe086760a88bd5ca4c0f28f90e22bd0b,openstack/cinder,driverfixes/ocata,bug/1720454,I48398331fe086760a88bd5ca4c0f28f90e22bd0b,Dell EMC PS: Fix extend volume creating unmanaged snapsots,MERGED,2017-10-23 15:48:36.000000000,2018-02-25 13:59:09.000000000,2017-11-03 02:36:54.000000000,8,2,1,514365,43f0219a04c87af3ec022b523e538c2f51d40ed4,53,19,6,2,10379,Rajini Karthik,rajinir,"Dell EMC PS: Fix extend volume creating unmanaged snapsots

The Dell EMC PS driver's extend volume code is missing the
no-snap option and creates unmanaged snapshots in the background.
Added that option to fix it.

Closes Bug: #1720454

Change-Id: I48398331fe086760a88bd5ca4c0f28f90e22bd0b
(cherry picked from commit 0910706e762cec88a2b53e82bd7e6a1c372163b9)
"
openstack%2Fcinder~stable%2Fpike~I48398331fe086760a88bd5ca4c0f28f90e22bd0b,openstack/cinder,stable/pike,bug/1720454,I48398331fe086760a88bd5ca4c0f28f90e22bd0b,Dell EMC PS: Fix extend volume creating unmanaged snapsots,MERGED,2017-10-17 17:50:35.000000000,2018-02-25 13:58:48.000000000,2017-11-03 02:36:52.000000000,10,4,1,512763,1e5cd9ba2a7906a182b0f2b0d7678213d80cd493,41,21,3,2,10379,Rajini Karthik,rajinir,"Dell EMC PS: Fix extend volume creating unmanaged snapsots

The Dell EMC PS driver's extend volume code is missing the
no-snap option and creates unmanaged snapshots in the background.
Added that option to fix it.

Closes Bug: #1720454

Change-Id: I48398331fe086760a88bd5ca4c0f28f90e22bd0b
(cherry picked from commit 0910706e762cec88a2b53e82bd7e6a1c372163b9)
"
openstack%2Fcinder~driverfixes%2Fnewton~I2caa5f2763ec343b0bc875e707924ff9b6424ce5,openstack/cinder,driverfixes/newton,bug/1719659,I2caa5f2763ec343b0bc875e707924ff9b6424ce5,Dell EMC PS: Fix over-subscription ratio stats,MERGED,2017-10-23 14:49:10.000000000,2018-02-25 13:58:46.000000000,2017-10-31 21:20:28.000000000,9,3,0,514342,06f08c6673141847c2aa2c5322ddea098b9ed004,22,13,2,3,10379,Rajini Karthik,rajinir,"Dell EMC PS: Fix over-subscription ratio stats

Fixed the provisioned_capacity_gb to use the VolumeReportedSpace
to calculate the over-subscription ratio stats in the Dell EMC
PS volume driver.

Closes Bug: #1719659

Change-Id: I2caa5f2763ec343b0bc875e707924ff9b6424ce5
(cherry picked from commit 761f0c3e66691e6f5c683a63a81beccbbca1cacf)
"
openstack%2Fcinder~master~Ib4f35bd01613d1bd69127a8ba65fc9e3cff6d3ad,openstack/cinder,master,bp/remotefs-revert-snapshot,Ib4f35bd01613d1bd69127a8ba65fc9e3cff6d3ad,SMBFS: Enable reverting snapshots,MERGED,2017-10-17 08:55:05.000000000,2018-02-25 13:58:45.000000000,2017-11-20 10:14:46.000000000,7,1,0,512545,e8715f690e61557d08c6df9040a2e4d87d3e6bad,167,41,3,2,26415,Alexandru Muresan,amuresan,"SMBFS: Enable reverting snapshots

This is a trivial change that enables the ""revert to snapshot""
feature within the SMBFS volume driver.

All the required logic is implemented in the RevertToSnapshotMixin
class, so all we're doing now is inheriting it.

Related-Blueprint: remotefs-revert-snapshot

Change-Id: Ib4f35bd01613d1bd69127a8ba65fc9e3cff6d3ad
"
openstack%2Fcinder~master~I3b01b5ced6673eb83c1a73c6132fb6d23e0912b4,openstack/cinder,master,bug/1728511,I3b01b5ced6673eb83c1a73c6132fb6d23e0912b4,Disco driver: Fix the location to get the disco connector constant,MERGED,2017-10-30 05:57:32.000000000,2018-02-25 13:58:43.000000000,2017-11-09 11:40:06.000000000,2,1,3,516183,e901221ee4a31e519b40824839b9346f24435831,119,35,2,1,19576,Guy Kim,Guy,"Disco driver: Fix the location to get the disco connector constant

During the runs in our third-party CI, devstack cannot be build
successfully because it cannot get the connector constant.
It was at os_brick.initiator.connector but was moved to os_brick.initiator.

This patch fixes this issue by updating the new location of the connector
constant.

Change-Id: I3b01b5ced6673eb83c1a73c6132fb6d23e0912b4
Closes-Bug:1728511
"
openstack%2Fcinder~driverfixes%2Fmitaka~Id5122dd9be973000831598fddc9e6f084ec2b7db,openstack/cinder,driverfixes/mitaka,backport-compatibility-issue-fix-to-M,Id5122dd9be973000831598fddc9e6f084ec2b7db,Fix a compatibility issue after Huawei driver upgrade,MERGED,2017-09-07 01:07:47.000000000,2018-02-25 13:58:42.000000000,2018-01-19 15:50:48.000000000,3,3,1,501504,3495a550d6473151793e1fcdbb4f481139b2080b,43,20,3,1,16203,zengyingzhe,zengyingzhe,"Fix a compatibility issue after Huawei driver upgrade

Previously Huawei driver changed the storing place for it's private
data, if upgrade to this new version driver, and there's already an
existing volume created by old driver, there's a compatibility issue
of getting hypermetro_id property, which will result deleting volume
failed while there's no hypermetro configuration exist.

This patch fixes this issue.

Change-Id: Id5122dd9be973000831598fddc9e6f084ec2b7db
(cherry picked from commit 083dfbbc8109924786ecc9f0c96559aa22041d4f)
(cherry picked from commit 96d6dae34f7f4696553928ac30b50f9d44e944f3)
(cherry picked from commit 18814a478d348acc65503ca1a6d31a07a63dbbb0)
(cherry picked from commit 6c5bb4ddda01d0f563609ad878dfe1499635770c)
"
openstack%2Fcinder~stable%2Fpike~I8713f846b1e2e30b4bbc4af57645fdc04bcd8386,openstack/cinder,stable/pike,bug/1726715-stable/pike,I8713f846b1e2e30b4bbc4af57645fdc04bcd8386,Don't fail when deleting missing backup,MERGED,2017-10-27 04:24:56.000000000,2018-02-25 13:58:41.000000000,2017-10-30 04:47:14.000000000,4,8,2,515584,223ee7478e138e8f4bc0d5a62a3d5fc26883ad23,25,17,1,2,24131,Abhishek Sharma M,abhi.sharma,"Don't fail when deleting missing backup

The problem here is sometimes when the path doesn't exist and we
try to delete it then exception occurs & breaks the flow. In this
case it happens with the volume delete flow, wherein the exception
occurs just before the quota commit & commit doesn't happen even
though the backup volume got deleted, hence catching the exception
just where it occurs.

Change-Id: I8713f846b1e2e30b4bbc4af57645fdc04bcd8386
Closes-Bug: 1726715
(cherry picked from commit 6ff364f385b2bfe52a9c55ffbe357979b0dee9b4)
"
openstack%2Fcinder~driverfixes%2Focata~Id5122dd9be973000831598fddc9e6f084ec2b7db,openstack/cinder,driverfixes/ocata,backport-compatibility-issue-fix-to-O,Id5122dd9be973000831598fddc9e6f084ec2b7db,Fix a compatibility issue after Huawei driver upgrade,MERGED,2017-09-07 01:02:13.000000000,2018-02-25 13:58:39.000000000,2017-10-27 22:12:33.000000000,3,3,0,501502,18814a478d348acc65503ca1a6d31a07a63dbbb0,75,19,3,1,16203,zengyingzhe,zengyingzhe,"Fix a compatibility issue after Huawei driver upgrade

Previously Huawei driver changed the storing place for it's private
data, if upgrade to this new version driver, and there's already an
existing volume created by old driver, there's a compatibility issue
of getting hypermetro_id property, which will result deleting volume
failed while there's no hypermetro configuration exist.

This patch fixes this issue.

Change-Id: Id5122dd9be973000831598fddc9e6f084ec2b7db
(cherry picked from commit 083dfbbc8109924786ecc9f0c96559aa22041d4f)
(cherry picked from commit 96d6dae34f7f4696553928ac30b50f9d44e944f3)
"
openstack%2Fcinder~master~I17d3a873cfc8f056c2d31f6c8710489785998d3c,openstack/cinder,master,bug/1727091,I17d3a873cfc8f056c2d31f6c8710489785998d3c,Make service object UUID not nullable,MERGED,2017-10-24 22:53:21.000000000,2018-02-25 13:58:38.000000000,2017-10-27 05:11:41.000000000,250,103,12,514853,950e693697e78a1af637ab6f8cc6c30afd5ba011,90,39,6,18,2243,John Griffith,john-griffith,"Make service object UUID not nullable

Fix the UUID entry for the newly added service attribute and
udpate the unit tests appropriately.

This makes the UUID entry in the service object not nullable
and fixes up the unit tests to work properly.  Also introduces
a unit test specifically for the online migration api in the db.

Closes-Bug: #1727091

Change-Id: I17d3a873cfc8f056c2d31f6c8710489785998d3c
"
openstack%2Fcinder~master~Ic7fc1827608190ec47db30b1265bebde616b616b,openstack/cinder,master,bug/1714503,Ic7fc1827608190ec47db30b1265bebde616b616b,VMAX driver - Deprecate backend xml configuration,MERGED,2017-10-02 10:37:15.000000000,2018-02-25 13:57:20.000000000,2017-12-05 04:09:40.000000000,150,30,43,508843,ec7f04ee97d9484845c41b8c775ec248da8cda4b,355,54,18,6,22021,Unana Okpoyo,UnanaOkpoyo,"VMAX driver - Deprecate backend xml configuration

The use of xml files for vmax backend configuration is deprecated.
Configuration parameters should be set in cinder.conf for security and
uniformity. The xml file can still be used but will not be supported after
the queens release.

Change-Id: Ic7fc1827608190ec47db30b1265bebde616b616b
Implements: blueprint backend-xml-deprecation
"
openstack%2Fcinder~master~I8ad7fbdca5a2695734b118d60a29a71064ae9b0b,openstack/cinder,master,bug/1714503,I8ad7fbdca5a2695734b118d60a29a71064ae9b0b,VMAX driver - Remove workload for next gen arrays,MERGED,2017-09-25 11:52:58.000000000,2018-02-25 13:56:53.000000000,2017-12-05 04:09:37.000000000,53,12,0,507070,6480e33b9800a501371aeca554d3289d2965a906,270,52,10,3,23414,Ciara Stacke,cstacke,"VMAX driver - Remove workload for next gen arrays

The next release of VMAX no longer has an option to set 'Workload' on a
storage group. Currently, the VMAX driver expects a workload to be set
when the user creates a VMAX volume type, which will cause an issue for
users using the next gen VMAX arrays. This patch rectifies the issue.

Change-Id: I8ad7fbdca5a2695734b118d60a29a71064ae9b0b
Closes-Bug: 1717289
"
openstack%2Fcinder~master~I9fffa0c6dc3092f3230cfa5da1ea5f3ff1e3151b,openstack/cinder,master,bug/1714503,I9fffa0c6dc3092f3230cfa5da1ea5f3ff1e3151b,VMAX driver - Implement Tiramisu feature on VMAX,MERGED,2017-09-20 10:07:03.000000000,2018-02-25 13:56:42.000000000,2017-12-05 04:09:34.000000000,1198,204,40,505581,c6b0c4bca66153634a0685f370283b16fe8e0345,331,51,14,8,23414,Ciara Stacke,cstacke,"VMAX driver - Implement Tiramisu feature on VMAX

In Tiramisu, a group construct is used to manage the group
of volumes to be replicated together for the ease of management.
This patch adds this support to the VMAX driver.

Change-Id: I9fffa0c6dc3092f3230cfa5da1ea5f3ff1e3151b
Implements: blueprint vmax-replication-group
"
openstack%2Fcinder~master~Iaae24a7de7171d9c1dc6197aa79b7d8ee87c0051,openstack/cinder,master,bug/1724074,Iaae24a7de7171d9c1dc6197aa79b7d8ee87c0051,ibm-storage: Fix create_volume_from_snapshot,MERGED,2017-10-25 11:34:35.000000000,2018-02-25 13:56:40.000000000,2017-10-29 23:36:55.000000000,23,9,0,515031,104d6fc8207d8633cd6fd650a488e86c80057477,88,39,2,2,13047,Isaac Beckman,isaacb,"ibm-storage: Fix create_volume_from_snapshot

If a snapshot was created from a volume that is part of a generic group,
then when calling ""create_volume_from_snapshot"", the exception
SourceVolumeBadNameError is raised.
This is a leftover from the days where there were no generic groups
(Only consistency groups were exist)

Change-Id: Iaae24a7de7171d9c1dc6197aa79b7d8ee87c0051
Closes-Bug: #1724074
"
openstack%2Fcinder~master~I65340b8538104a84b45c0be39d0e0baa4c7c433c,openstack/cinder,master,,I65340b8538104a84b45c0be39d0e0baa4c7c433c,Fix incorrect use of assertFalse causing CI failed,MERGED,2017-10-26 02:16:07.000000000,2018-02-25 13:56:39.000000000,2017-11-04 07:49:32.000000000,18,18,0,515262,5a26e4e5b0f030c984db6cf653d62737dff03cb5,88,33,2,4,18320,Dao Cong Tien,TienDC,"Fix incorrect use of assertFalse causing CI failed

assertFalse should not be used with non-boolean args.

Change-Id: I65340b8538104a84b45c0be39d0e0baa4c7c433c
"
openstack%2Fcinder~master~Ia3d9cdecb2567ae40bc61d5d1f7c33b607d3fbad,openstack/cinder,master,,Ia3d9cdecb2567ae40bc61d5d1f7c33b607d3fbad,Tests: Fix coverage unit test failure,MERGED,2017-10-25 20:01:46.000000000,2018-02-25 13:56:35.000000000,2017-10-26 20:20:17.000000000,4,1,0,515191,9e12a40b5c87258904290a50e99bb72e34268c60,27,22,1,1,4523,Eric Harney,eharney,"Tests: Fix coverage unit test failure

This fixes a failure in ""tox -e cover""
due to a MagicMock being passed to dirname().

Change-Id: Ia3d9cdecb2567ae40bc61d5d1f7c33b607d3fbad
"
openstack%2Fcinder~master~Ibb2f105c58252adb7dfe4f1a7d6643410ac031b3,openstack/cinder,master,oslo-debt-cleanup,Ibb2f105c58252adb7dfe4f1a7d6643410ac031b3,Replace DbMigrationError with DBMigrationError,MERGED,2017-09-05 15:12:47.000000000,2018-02-25 13:56:33.000000000,2017-10-26 02:41:42.000000000,2,2,0,500881,aa52c9cf0276f678163339a8d28559697ea42d81,119,45,4,2,17549,Yaguo Zhou,zhouyaguo,"Replace DbMigrationError with DBMigrationError

DbMigrationError is deprecated and will NOT be thrown in oslo.db
since oslo.db >=4.27.0, DBMigrationError will be thrown instead.
Consumers should catch DBMigrationError instead of DbMigrationError

Depends-On: Iab0566cf9f4552e91fa417e64472fa106e8bc86d
Depends-On: I0ebd69c3d778acb5bec9e136627e345e7fcf2bd3

Change-Id: Ibb2f105c58252adb7dfe4f1a7d6643410ac031b3
"
openstack%2Fcinder~driverfixes%2Focata~I945300cac84658bbd25182ba615645af881920f8,openstack/cinder,driverfixes/ocata,bug/1724929,I945300cac84658bbd25182ba615645af881920f8,ScaleIO Driver - include snap usage in provisioned capacity,MERGED,2017-10-25 16:48:20.000000000,2018-02-25 13:56:32.000000000,2017-10-31 00:26:36.000000000,6,2,0,515130,5b9a5858d72d1be9599407b0e9945fb4cd0cf3ab,37,17,1,2,25033,Eric Young,tssgery,"ScaleIO Driver - include snap usage in provisioned capacity

Provisioned capacity of storage pools was not correctly accounting
for space used by snapshots.

Change-Id: I945300cac84658bbd25182ba615645af881920f8
Closes-Bug: #1724929
(cherry picked from commit 64180530c14e1d0829788eda1ccb0efc938fbd8e)
"
openstack%2Fcinder~driverfixes%2Focata~Ic106dbcae8ceaac265b710756ab1874e445ca826,openstack/cinder,driverfixes/ocata,bug/1714209,Ic106dbcae8ceaac265b710756ab1874e445ca826,NetApp ONTAP: Fix reporting of provisioned_capacity_gb,MERGED,2017-10-05 13:42:18.000000000,2018-02-25 13:56:25.000000000,2017-10-27 22:12:30.000000000,16,17,0,509780,eef24cfce800c601e5e1e7a21e026ad9b03d4ed1,40,18,2,9,9535,Gorka Eguileor,Gorka,"NetApp ONTAP: Fix reporting of provisioned_capacity_gb

The ONTAP drivers in Cinder (""7mode"" and ""cmode"") cannot
reliably and efficiently track provisioned_capacity_gb as expected
by the Cinder scheduler.

The driver authors originally assumed that provisioned_capacity_gb
is consumed space on the backend. This results in miscalculation of
over subscription in the Cinder scheduler.

The fix adopted here is to remove this wrong reporting and rely on
calculation of the provisioned_capacity_gb in the scheduler.

Change-Id: Ic106dbcae8ceaac265b710756ab1874e445ca826
Closes-Bug: #1714209
(cherry picked from commit 42b8b7fe60ffdd7a7772dc0ab228265dc83344bc)
(cherry picked from commit 558571b44d9cd2195993e42539fd2c689b179ee6)
Conflicts:
	cinder/tests/unit/volume/drivers/netapp/dataontap/test_nfs_7mode.py
"
openstack%2Fcinder~driverfixes%2Focata~I2caa5f2763ec343b0bc875e707924ff9b6424ce5,openstack/cinder,driverfixes/ocata,bug/1719659,I2caa5f2763ec343b0bc875e707924ff9b6424ce5,Dell EMC PS: Fix over-subscription ratio stats,MERGED,2017-10-23 14:43:28.000000000,2018-02-25 13:56:01.000000000,2017-10-27 22:12:32.000000000,9,3,0,514338,2e136ad6d2c5a04453ac324df381a30530738ec5,46,19,4,3,10379,Rajini Karthik,rajinir,"Dell EMC PS: Fix over-subscription ratio stats

Fixed the provisioned_capacity_gb to use the VolumeReportedSpace
to calculate the over-subscription ratio stats in the Dell EMC
PS volume driver.

Closes Bug: #1719659

Change-Id: I2caa5f2763ec343b0bc875e707924ff9b6424ce5
(cherry picked from commit 761f0c3e66691e6f5c683a63a81beccbbca1cacf)
"
openstack%2Fcinder~stable%2Fpike~I30a4666a058ebbf108fd42028fb0c39e5cb8bcae,openstack/cinder,stable/pike,bug/1717008,I30a4666a058ebbf108fd42028fb0c39e5cb8bcae,Add another hack from NOVA_GROUP to generate_cinder_opts.py,MERGED,2017-09-19 10:35:41.000000000,2018-02-25 13:55:58.000000000,2017-10-27 02:43:00.000000000,9,6,0,505157,5b65b7fd2572855f00b71557b1cb61d9055c90e5,63,27,4,2,18940,Gyorgy Szombathelyi,gyurco78,"Add another hack from NOVA_GROUP to generate_cinder_opts.py

generate_cinder_opts.py doesn't really handle indirect variables
in group names, so add manual handlig of NOVA_GROUP.

Change-Id: I30a4666a058ebbf108fd42028fb0c39e5cb8bcae
Closes-Bug: #1717008
(cherry picked from commit db6564bb748446785217e5de852ac9a6946ea481)
"
openstack%2Fcinder~driverfixes%2Fnewton~Ie31a0cfe447aee670018914d379d178933437b8c,openstack/cinder,driverfixes/newton,bug/1693956,Ie31a0cfe447aee670018914d379d178933437b8c,VNX: fix issue when backing-up in-use volume,MERGED,2017-09-06 18:19:51.000000000,2018-02-25 13:55:56.000000000,2017-10-27 21:03:01.000000000,4,3,0,501370,c5cbeb76077345738babc13ebe35b5df6852ded0,27,14,2,2,4523,Eric Harney,eharney,"VNX: fix issue when backing-up in-use volume

When backing-up an in-use volume, initialize_connection_snapshot did not
return connection information for attaching the snapshot thus causing
below error:

TypeError: 'NoneType' object has no attribute '__getitem__'

This commit fixes above issue.

Change-Id: Ie31a0cfe447aee670018914d379d178933437b8c
Closes-bug: #1693956
(cherry picked from commit 530259db85c3c8faba333381cb7927c0d9e21469)
(cherry picked from commit e58d89cbff6d212ddfa66607408a02ba3eb14dac)
"
openstack%2Fcinder~driverfixes%2Focata~If246b5fd91c7fc2c381acc56ef499ada7f411741,openstack/cinder,driverfixes/ocata,bug/1681334,If246b5fd91c7fc2c381acc56ef499ada7f411741,Fix config option volume_backend_name's invalid overridden value,MERGED,2017-09-06 16:40:11.000000000,2018-02-25 13:55:55.000000000,2017-10-27 21:28:04.000000000,2,2,0,501348,925876daab92848e580ab2fa728402a8fe5558cc,38,16,2,1,4523,Eric Harney,eharney,"Fix config option volume_backend_name's invalid overridden value

oslo.config made method set_override with enforce_type=True
by default[1], will try to convert override value according to config
option's type. Config option volume_backend_name is StrOpt[2], need
be overridden with string value.

Closes-Bug: #1681334

[1] https://review.openstack.org/#/c/328692/
[2] http://git.openstack.org/cgit/openstack/cinder/tree/cinder/volume/driver.py#n66

Change-Id: If246b5fd91c7fc2c381acc56ef499ada7f411741
(cherry picked from commit 2c938e9d9e2b689184cd30709190cf8c38e8a91e)
(cherry picked from commit cef207a4005ad412fdee83be525b7221fde950df)
"
openstack%2Fcinder~master~Ib78293efa626c098a572f4c64119ee2ff296bd40,openstack/cinder,master,bug/1726591,Ib78293efa626c098a572f4c64119ee2ff296bd40,Dell EMC PS: Fix Duplicate ACL records Issue,MERGED,2017-10-25 15:29:44.000000000,2018-02-25 13:55:54.000000000,2017-10-27 04:19:35.000000000,45,10,1,515107,22c09d57687b98faf4193cb1be3d738ddf3bbd28,33,30,1,3,10379,Rajini Karthik,rajinir,"Dell EMC PS: Fix Duplicate ACL records Issue

Live migration was creating duplicate ACL records for the compute
nodes. Fixed it by not creating one when an ACL exists during
initialization of the volume.

Closes Bug: #1726591

Change-Id: Ib78293efa626c098a572f4c64119ee2ff296bd40
"
openstack%2Fcinder~master~I2e92b27c36357120fcf0ec5917c6484441c946a8,openstack/cinder,master,bp/add-amount-info-in-list-api,I2e92b27c36357120fcf0ec5917c6484441c946a8,Support count info in List&Detail APIs,MERGED,2017-09-19 07:58:18.000000000,2018-02-25 13:55:49.000000000,2017-10-27 00:19:46.000000000,439,23,16,505101,23b74639848df37ee25f0d613062862749c7e42d,295,53,12,26,23083,TommyLike,TommyLike,"Support count info in List&Detail APIs

This patch adds support for display count info
in volume, backup and snapshot's list&detail APIs
since microversion 3.45, for instance:

1. /v3/{project_id}/volumes?with_count=True
2. /v3/{project_id}/volumes/detail?with_count=True

Depends-On: 1c8fe0ade43da925c5b810ef0cd27817f1c11c7b
Change-Id: I2e92b27c36357120fcf0ec5917c6484441c946a8
Implements: bp add-amount-info-in-list-api
"
openstack%2Fcinder~master~I99f2eafbcedf93109c05766b5ceda508e0b16608,openstack/cinder,master,profile_id_connection_info,I99f2eafbcedf93109c05766b5ceda508e0b16608,VMware: Add profile ID to connection info,MERGED,2017-10-25 00:44:03.000000000,2018-02-25 13:55:48.000000000,2017-11-05 06:04:37.000000000,12,2,0,514874,4dbf6df359f95b606f56b97fc4935ce85314e811,36,27,1,2,9171,Vipin Balachandran,vbala,"VMware: Add profile ID to connection info

The VMware Nova driver requires the volume's storage profile
ID to associate the volume vmdk with the storage profile
during volume attach. Passing the profile ID in connection
info.

Change-Id: I99f2eafbcedf93109c05766b5ceda508e0b16608
"
openstack%2Fcinder~stable%2Fpike~I81dc6f1ac5855b21c10572797fd45a6b38641112,openstack/cinder,stable/pike,,I81dc6f1ac5855b21c10572797fd45a6b38641112,"Revert ""Tests: Fail if oslo.versionedobjects issues Invalid UUID warnings""",MERGED,2017-10-24 20:11:13.000000000,2018-02-25 13:55:39.000000000,2017-10-26 01:17:41.000000000,0,12,0,514812,983ed799d74ea39a50e13eb49a8379ad31aeda6b,21,13,1,1,4523,Eric Harney,eharney,"Revert ""Tests: Fail if oslo.versionedobjects issues Invalid UUID warnings""

This is currently causing unit test failures since
pymysql _show_warnings calls
    warnings.warn(err.Warning(*w[1:3]), stacklevel=4)
and this code assumes that the warnings are strings.

This reverts commit ed6d50bed642b01d005563866ab9f211632cff5b.

Change-Id: I81dc6f1ac5855b21c10572797fd45a6b38641112
(cherry picked from commit cc6c5b10867544ec0e2cbc73802ec8ee6213bc7a)
"
openstack%2Fcinder~master~Ia0261e83171a1a13374b447303e3a61863fa22c2,openstack/cinder,master,bug/1724958,Ia0261e83171a1a13374b447303e3a61863fa22c2,Fix manage_existing API behaving wrongly with storage pools,MERGED,2017-10-24 19:12:17.000000000,2018-02-25 13:55:26.000000000,2017-10-30 21:51:50.000000000,6,1,0,514802,3c7f1762959d53c05f6d37c66908a78e3b822535,64,34,1,1,16643,Goutham Pacha Ravi,gouthamr,"Fix manage_existing API behaving wrongly with storage pools

When the requested host specifies a pool, Cinder needs to
validate that specified pool in the scheduler
and assign the 'host' attribute appropriately.

Closes-Bug: 1724958
Change-Id: Ia0261e83171a1a13374b447303e3a61863fa22c2
"
openstack%2Fcinder~master~I3f95cfe439d65d9cf746d4e3844bc70bc705625e,openstack/cinder,master,bug/1724952,I3f95cfe439d65d9cf746d4e3844bc70bc705625e,Fix key_manager API call,MERGED,2017-10-23 21:01:01.000000000,2018-02-25 13:55:23.000000000,2017-10-25 21:17:37.000000000,11,3,0,514456,1a27bcab802431ff408154a6e246a8ff9697338c,60,33,2,2,8623,Kaitlin Farr,kaitlin.farr,"Fix key_manager API call

If you pass importutils.import_class a string that is not actually a
reference to a python class, you get an ""empty module"" error.
Cinder's keymgr.API call used to try to import the castellan backend
directly, but this was not necessary as the castellan key_manager.API
call will return the correct backend based on the api_class or backend
option in the config file. If no api_class or backend option is
specified, castellan key_manager API call will return a barbican backend
by default [1].

Castellan used to require the full class name to specify the backend (i.e.
api_class=castellan.key_manager.barbican_key_manager.BarbicanKeyManager),
so the import_class call in cinder was no issue. Recently castellan
was updated to use stevedore entry points and the config option name was changed
to ""backend"" [2]. The change in castellan is backwards compatible so that if
you use a full module name instead of the stevedore entry point name, it will
still get the correct backend. However, the cinder code was not updated accordingly,
so any time the shorthand stevedore entry point name for the backend is used
instead of the full module name, the import_class call in cinder will fail.

This change removes the unnecessary import_class call and adds an appropriate
unit test that shows the ""empty module"" error does not occur anymore.

1. https://github.com/openstack/castellan/blob/b13187b34ddcc88bee57e4e99b0115cb92540b97/castellan/key_manager/__init__.py#L25
2. https://github.com/openstack/castellan/commit/8980bf7da55dd084ad84c84534fe937f0d43b9c0

Closes-Bug: #1724952
Change-Id: I3f95cfe439d65d9cf746d4e3844bc70bc705625e
"
openstack%2Fcinder~driverfixes%2Fnewton~I39d4230106c891e1b480989daaf72bea5a64e4b3,openstack/cinder,driverfixes/newton,bug/1675469,I39d4230106c891e1b480989daaf72bea5a64e4b3,RemoteFS: prevent creation of encrypted volumes,MERGED,2017-10-23 19:00:30.000000000,2018-02-25 13:55:21.000000000,2017-10-26 02:41:22.000000000,6,0,0,514434,725629a2dc168fe7db7cc1efe6637734108f3d3b,13,10,1,1,4523,Eric Harney,eharney,"RemoteFS: prevent creation of encrypted volumes

Support for volume encryption of FS-based volumes is not
currently implemented in Nova.  Creating encrypted volumes
with these drivers can result in dangerous and undesired
behavior.  Block creation of encrypted volumes for these
drivers until this is supported.

This adds a per-driver switch which can be used to enable
this for individual RemoteFS drivers as they are tested.

Closes-Bug: #1675469

Change-Id: I39d4230106c891e1b480989daaf72bea5a64e4b3
(cherry picked from commit e626f54f8b9793a06be2f2b0a49b2dbbff4ecdd3)
(cherry picked from commit 689d7468513df4b5c7d032314fdf1d4e3e8f6ebc)
Conflicts:
	cinder/volume/drivers/remotefs.py
"
openstack%2Fcinder~stable%2Focata~I81899f63da7df99385049121557dbf6f21d18296,openstack/cinder,stable/ocata,zanata/translations,I81899f63da7df99385049121557dbf6f21d18296,Imported Translations from Zanata,MERGED,2017-10-23 07:24:12.000000000,2018-02-25 13:55:20.000000000,2017-10-23 14:39:33.000000000,241,6513,0,514168,f3f3fb3c492664f4cc3bf052bd6d076ccc51a81a,13,9,1,12,11131,OpenStack Proposal Bot,proposal-bot,"Imported Translations from Zanata

For more information about this automatic import see:
https://docs.openstack.org/i18n/latest/reviewing-translation-import.html

Change-Id: I81899f63da7df99385049121557dbf6f21d18296
"
openstack%2Fcinder~master~Ib9fc4e14333548b84666e3f571e7b42fe20e0319,openstack/cinder,master,docs_cleanup,Ib9fc4e14333548b84666e3f571e7b42fe20e0319,Clean up driver configuration reference,MERGED,2017-10-20 21:07:30.000000000,2018-02-25 13:55:19.000000000,2017-10-26 17:04:00.000000000,68,669,1,513852,de953be3d46cc6cc011ce148d96161fa72f79555,46,26,2,15,11904,Sean McGinnis,SeanM,"Clean up driver configuration reference

Over the last few cycles we have removed drivers, but we did not always
clean up the documentation from the openstack-manuals project. Those docs
were moved over wholesale as part of the docs migration, so we ended up
with them in the repo with no corresponding driver files.

This removes those leftover docs and cleans up the generated documentation.

Change-Id: Ib9fc4e14333548b84666e3f571e7b42fe20e0319
"
openstack%2Fcinder~master~Ia02edfb6f30edfccb2bcdd41e8a3fdd7331cef5b,openstack/cinder,master,bp/enable-extraspec-keys-as-solidfire-attributes,Ia02edfb6f30edfccb2bcdd41e8a3fdd7331cef5b,Enable using extra-specs for SF attributes,MERGED,2017-10-17 18:30:41.000000000,2018-02-25 13:55:17.000000000,2017-10-24 18:17:50.000000000,37,0,0,512786,56a860e835b57c76012d2669eb1eb1fdb1ed8cbc,104,35,6,2,2243,John Griffith,john-griffith,"Enable using extra-specs for SF attributes

There a number of use cases where it's desirable to do things with volumes
out of band (ie not under Cinders control). One example is external backups
without the use of c-backup.

It's pretty simple to signify these sorts of things from Cinder through
the use of extra-specs keys. For example, create a type 'daily-backup'
with extra-specs 'SFAttribute:backup=daily' which may instruct some automation
to query the SolidFire device for any volumes with the attribute
""backup=daily"" to be backed up on a daily schedule.

These attributes are just metadata and can be used for anything.
They don't effect Cinder's operation or change anything in how the volume behaves
from Cinders perspective, but instead add additional information and signals for
admins and automation outside of OpenStack/Cinder.

The only requirement is the use of a key delimiter, in this case `SFAttribute`
which instructs the scheduler to ignore the associated key for scheduling, and also
is used as a sentinal for the SF driver to determine what to store in attributes.

Change-Id: Ia02edfb6f30edfccb2bcdd41e8a3fdd7331cef5b
Implements: blueprint enable-extraspec-keys-as-solidfire-attributes
"
openstack%2Fcinder~stable%2Fpike~I861d61dd11f982a8a54b57b6a6c895e6ebe399c0,openstack/cinder,stable/pike,bug/1720063-stable/pike,I861d61dd11f982a8a54b57b6a6c895e6ebe399c0,VNX: Fix issue when creating without type,MERGED,2017-10-20 02:34:02.000000000,2018-02-25 13:55:16.000000000,2017-10-26 04:52:00.000000000,27,20,0,513588,04a6a0ee12ba8a1da22d545e811dd776571d8586,32,16,1,2,10628,Peter Wang,peter_wang,"VNX: Fix issue when creating without type

When creating a volume without type, a error will be thrown:

AttributeError: 'NoneType' object has no attribute 'qos_specs'

This issue was introduced in qos patch:
https://review.openstack.org/#/c/441786/

Change-Id: I861d61dd11f982a8a54b57b6a6c895e6ebe399c0
Closes-bug: #1720063
(cherry picked from commit 5345f8cb9c8ec416aa5d764ea5ea47e3ff4d8d1d)
"
openstack%2Fcinder~master~I945300cac84658bbd25182ba615645af881920f8,openstack/cinder,master,bug/1724929,I945300cac84658bbd25182ba615645af881920f8,ScaleIO Driver - include snap usage in provisioned capacity,MERGED,2017-10-19 20:02:59.000000000,2018-02-25 13:55:13.000000000,2017-10-24 23:23:01.000000000,4,0,0,513490,64180530c14e1d0829788eda1ccb0efc938fbd8e,54,31,1,2,25033,Eric Young,tssgery,"ScaleIO Driver - include snap usage in provisioned capacity

Provisioned capacity of storage pools was not correctly accounting
for space used by snapshots.

Change-Id: I945300cac84658bbd25182ba615645af881920f8
Closes-Bug: #1724929
"
openstack%2Fcinder~master~Id5d915064aa24a5b0c66364ecd618561ed18df9b,openstack/cinder,master,change_tutorial_to_guide,Id5d915064aa24a5b0c66364ecd618561ed18df9b,Change Install 'Tutorials' to 'Guides',MERGED,2017-10-17 17:55:40.000000000,2018-02-25 13:54:58.000000000,2017-10-18 21:50:33.000000000,11,11,4,512766,1fd02d1e7feb891313a83fd4e6d17620187be490,35,22,2,4,7198,Jay Bryant,jsbryant,"Change Install 'Tutorials' to 'Guides'

It was decided by the documentation team that we should,
for consistency, call our install documentation 'guides'.
Our pages were listed as 'Tutorials'.  This change
corrects the inconsistency.

Change-Id: Id5d915064aa24a5b0c66364ecd618561ed18df9b
"
